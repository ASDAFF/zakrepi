[33mcommit c4d6a537d7e2f49d481dd10415607cc1c0f849ef[m
Author: Che Burashka <pvygolov@mail.ru>
Date:   Thu Nov 5 17:39:10 2015 +0500

    Revert "Catalog, Personal"
    
    This reverts commit 96afae6df4ab556bde0c691b8ed0d81c671557f1.

[1mdiff --git a/.htaccess b/.htaccess[m
[1mindex 7215953..42594b1 100644[m
[1m--- a/.htaccess[m
[1m+++ b/.htaccess[m
[36m@@ -2,31 +2,44 @@[m [mOptions -Indexes[m
 ErrorDocument 404 /404.php[m
 [m
 <IfModule mod_php5.c>[m
[31m-	php_flag allow_call_time_pass_reference 1[m
[31m-	php_flag session.use_trans_sid off[m
[31m-[m
[31m-	#php_value display_errors 1[m
[31m-[m
[31m-	#php_value mbstring.internal_encoding UTF-8[m
[32m+[m[32m  php_flag session.use_trans_sid off[m
[32m+[m[32m  #php_value display_errors 1[m
[32m+[m[32m  #php_value mbstring.internal_encoding UTF-8[m
 </IfModule>[m
 [m
 <IfModule mod_rewrite.c>[m
[31m-	Options +FollowSymLinks[m
[31m-	RewriteEngine On[m
[31m-	RewriteCond %{REQUEST_FILENAME} !-f[m
[31m-	RewriteCond %{REQUEST_FILENAME} !-l[m
[31m-	RewriteCond %{REQUEST_FILENAME} !-d[m
[31m-	RewriteCond %{REQUEST_FILENAME} !/bitrix/urlrewrite.php$[m
[31m-	RewriteRule ^(.*)$ /bitrix/urlrewrite.php [L][m
[31m-	RewriteRule .* - [E=REMOTE_USER:%{HTTP:Authorization}][m
[32m+[m[32m  Options +FollowSymLinks[m
[32m+[m[32m  RewriteEngine On[m
[32m+[m
[32m+[m[32mRewriteCond %{REQUEST_FILENAME} -f [OR][m
[32m+[m[32mRewriteCond %{REQUEST_FILENAME} -l [OR][m
[32m+[m[32mRewriteCond %{REQUEST_FILENAME} -d[m
[32m+[m[32mRewriteCond %{REQUEST_FILENAME} [\xC2-\xDF][\x80-\xBF] [OR][m
[32m+[m[32mRewriteCond %{REQUEST_FILENAME} \xE0[\xA0-\xBF][\x80-\xBF] [OR][m
[32m+[m[32mRewriteCond %{REQUEST_FILENAME} [\xE1-\xEC\xEE\xEF][\x80-\xBF]{2} [OR][m
[32m+[m[32mRewriteCond %{REQUEST_FILENAME} \xED[\x80-\x9F][\x80-\xBF] [OR][m
[32m+[m[32mRewriteCond %{REQUEST_FILENAME} \xF0[\x90-\xBF][\x80-\xBF]{2} [OR][m
[32m+[m[32mRewriteCond %{REQUEST_FILENAME} [\xF1-\xF3][\x80-\xBF]{3} [OR][m
[32m+[m[32mRewriteCond %{REQUEST_FILENAME} \xF4[\x80-\x8F][\x80-\xBF]{2}[m
[32m+[m[32mRewriteCond %{REQUEST_FILENAME} !/bitrix/virtual_file_system.php$[m
[32m+[m[32mRewriteRule ^(.*)$ /bitrix/virtual_file_system.php [L][m
[32m+[m[32m  RewriteCond %{REQUEST_FILENAME} !-f[m
[32m+[m[32m  RewriteCond %{REQUEST_FILENAME} !-l[m
[32m+[m[32m  RewriteCond %{REQUEST_FILENAME} !-d[m
[32m+[m[32m  RewriteCond %{REQUEST_FILENAME} !/bitrix/urlrewrite.php$[m
[32m+[m[32m  RewriteRule ^(.*)$ /bitrix/urlrewrite.php [L][m
[32m+[m[32m  RewriteRule .* - [E=REMOTE_USER:%{HTTP:Authorization}][m
 </IfModule>[m
 [m
 <IfModule mod_dir.c>[m
[31m-	DirectoryIndex index.php index.html[m
[32m+[m[32m  DirectoryIndex index.php index.html[m
 </IfModule>[m
 [m
 <IfModule mod_expires.c>[m
[31m-	ExpiresActive on[m
[31m-	ExpiresByType image/jpeg "access plus 3 day"[m
[31m-	ExpiresByType image/gif "access plus 3 day"[m
[31m-</IfModule>[m
\ No newline at end of file[m
[32m+[m[32m  ExpiresActive on[m
[32m+[m[32m  ExpiresByType image/jpeg "access plus 3 day"[m
[32m+[m[32m  ExpiresByType image/gif "access plus 3 day"[m
[32m+[m[32m  ExpiresByType image/png "access plus 3 day"[m
[32m+[m[32m  ExpiresByType text/css "access plus 3 day"[m
[32m+[m[32m  ExpiresByType application/javascript "access plus 3 day"[m[41m  [m
[32m+[m[32m</IfModule>[m
[1mdiff --git a/.htaccess.restore b/.htaccess.restore[m
[1mdeleted file mode 100644[m
[1mindex 42594b1..0000000[m
[1m--- a/.htaccess.restore[m
[1m+++ /dev/null[m
[36m@@ -1,45 +0,0 @@[m
[31m-Options -Indexes [m
[31m-ErrorDocument 404 /404.php[m
[31m-[m
[31m-<IfModule mod_php5.c>[m
[31m-  php_flag session.use_trans_sid off[m
[31m-  #php_value display_errors 1[m
[31m-  #php_value mbstring.internal_encoding UTF-8[m
[31m-</IfModule>[m
[31m-[m
[31m-<IfModule mod_rewrite.c>[m
[31m-  Options +FollowSymLinks[m
[31m-  RewriteEngine On[m
[31m-[m
[31m-RewriteCond %{REQUEST_FILENAME} -f [OR][m
[31m-RewriteCond %{REQUEST_FILENAME} -l [OR][m
[31m-RewriteCond %{REQUEST_FILENAME} -d[m
[31m-RewriteCond %{REQUEST_FILENAME} [\xC2-\xDF][\x80-\xBF] [OR][m
[31m-RewriteCond %{REQUEST_FILENAME} \xE0[\xA0-\xBF][\x80-\xBF] [OR][m
[31m-RewriteCond %{REQUEST_FILENAME} [\xE1-\xEC\xEE\xEF][\x80-\xBF]{2} [OR][m
[31m-RewriteCond %{REQUEST_FILENAME} \xED[\x80-\x9F][\x80-\xBF] [OR][m
[31m-RewriteCond %{REQUEST_FILENAME} \xF0[\x90-\xBF][\x80-\xBF]{2} [OR][m
[31m-RewriteCond %{REQUEST_FILENAME} [\xF1-\xF3][\x80-\xBF]{3} [OR][m
[31m-RewriteCond %{REQUEST_FILENAME} \xF4[\x80-\x8F][\x80-\xBF]{2}[m
[31m-RewriteCond %{REQUEST_FILENAME} !/bitrix/virtual_file_system.php$[m
[31m-RewriteRule ^(.*)$ /bitrix/virtual_file_system.php [L][m
[31m-  RewriteCond %{REQUEST_FILENAME} !-f[m
[31m-  RewriteCond %{REQUEST_FILENAME} !-l[m
[31m-  RewriteCond %{REQUEST_FILENAME} !-d[m
[31m-  RewriteCond %{REQUEST_FILENAME} !/bitrix/urlrewrite.php$[m
[31m-  RewriteRule ^(.*)$ /bitrix/urlrewrite.php [L][m
[31m-  RewriteRule .* - [E=REMOTE_USER:%{HTTP:Authorization}][m
[31m-</IfModule>[m
[31m-[m
[31m-<IfModule mod_dir.c>[m
[31m-  DirectoryIndex index.php index.html[m
[31m-</IfModule>[m
[31m-[m
[31m-<IfModule mod_expires.c>[m
[31m-  ExpiresActive on[m
[31m-  ExpiresByType image/jpeg "access plus 3 day"[m
[31m-  ExpiresByType image/gif "access plus 3 day"[m
[31m-  ExpiresByType image/png "access plus 3 day"[m
[31m-  ExpiresByType text/css "access plus 3 day"[m
[31m-  ExpiresByType application/javascript "access plus 3 day"  [m
[31m-</IfModule>[m
[1mdiff --git a/.idea/workspace.xml b/.idea/workspace.xml[m
[1mindex b60c7c1..22df1ae 100644[m
[1m--- a/.idea/workspace.xml[m
[1m+++ b/.idea/workspace.xml[m
[36m@@ -2,49 +2,9 @@[m
 <project version="4">[m
   <component name="ChangeListManager">[m
     <list default="true" id="9b94893a-e1d6-4c97-9d95-37d54e5f8c7a" name="Default" comment="">[m
[31m-      <change type="DELETED" beforePath="C:\Bitrix\www\b.zakrepi.dev\zakrepi\personal\account\update_password.php" afterPath="" />[m
[31m-      <change type="DELETED" beforePath="C:\Bitrix\www\b.zakrepi.dev\zakrepi\upload\resize_cache\iblock\0bf\50_50_1\0bfb24f5b5a433502014b0b5b9ac61e8.jpg" afterPath="" />[m
[31m-      <change type="DELETED" beforePath="C:\Bitrix\www\b.zakrepi.dev\zakrepi\upload\resize_cache\iblock\139\50_50_1\1391ec8c7093d4680da368b8d52885a6.jpg" afterPath="" />[m
[31m-      <change type="DELETED" beforePath="C:\Bitrix\www\b.zakrepi.dev\zakrepi\upload\resize_cache\iblock\28f\50_50_1\28fe722ef7e632d0d64b6493730a78fa.jpg" afterPath="" />[m
[31m-      <change type="DELETED" beforePath="C:\Bitrix\www\b.zakrepi.dev\zakrepi\upload\resize_cache\iblock\2b0\50_50_1\2b05c37dd86d271efcf3036fc99af2d6.jpg" afterPath="" />[m
[31m-      <change type="DELETED" beforePath="C:\Bitrix\www\b.zakrepi.dev\zakrepi\upload\resize_cache\iblock\2ef\50_50_1\2ef9436180a16b78b5dd2df33940fbe7.jpg" afterPath="" />[m
[31m-      <change type="DELETED" beforePath="C:\Bitrix\www\b.zakrepi.dev\zakrepi\upload\resize_cache\iblock\498\50_50_1\498fa0a51839396a5821af4e219914c0.jpg" afterPath="" />[m
[31m-      <change type="DELETED" beforePath="C:\Bitrix\www\b.zakrepi.dev\zakrepi\upload\resize_cache\iblock\61f\50_50_1\61febf2f078afc8330918ee38d57a109.jpg" afterPath="" />[m
[31m-      <change type="DELETED" beforePath="C:\Bitrix\www\b.zakrepi.dev\zakrepi\upload\resize_cache\iblock\c25\200_200_1\c257326c8cee1cf81dd1c423feb87901.jpg" afterPath="" />[m
[31m-      <change type="DELETED" beforePath="C:\Bitrix\www\b.zakrepi.dev\zakrepi\upload\resize_cache\iblock\c25\50_50_1\c257326c8cee1cf81dd1c423feb87901.jpg" afterPath="" />[m
[31m-      <change type="DELETED" beforePath="C:\Bitrix\www\b.zakrepi.dev\zakrepi\upload\resize_cache\iblock\db4\200_200_1\db47a6cbab4719c16ae80d57437bc747.jpg" afterPath="" />[m
[31m-      <change type="DELETED" beforePath="C:\Bitrix\www\b.zakrepi.dev\zakrepi\upload\resize_cache\iblock\dd3\200_200_1\dd3e72b175dd3b68debb124f8c29e604.jpg" afterPath="" />[m
[31m-      <change type="DELETED" beforePath="C:\Bitrix\www\b.zakrepi.dev\zakrepi\upload\tmp\BXTEMP-2015-10-27\22\bxu\.access.php" afterPath="" />[m
[31m-      <change type="DELETED" beforePath="C:\Bitrix\www\b.zakrepi.dev\zakrepi\upload\tmp\BXTEMP-2015-10-27\22\bxu\305a18bcee97c3d5290e18664d8cf572\file1445924491833\bosch.png" afterPath="" />[m
[31m-      <change type="DELETED" beforePath="C:\Bitrix\www\b.zakrepi.dev\zakrepi\upload\tmp\BXTEMP-2015-10-27\22\bxu\305a18bcee97c3d5290e18664d8cf572\file1445925118548\12e9daf0-d0fa-4537-8681-738ace56c88d. Bosch.jpg" afterPath="" />[m
[31m-      <change type="DELETED" beforePath="C:\Bitrix\www\b.zakrepi.dev\zakrepi\upload\tmp\BXTEMP-2015-10-27\22\bxu\305a18bcee97c3d5290e18664d8cf572\file1445925342090\bosch.png" afterPath="" />[m
[31m-      <change type="DELETED" beforePath="C:\Bitrix\www\b.zakrepi.dev\zakrepi\upload\tmp\BXTEMP-2015-10-27\22\bxu\305a18bcee97c3d5290e18664d8cf572\file1445925541170\hitachi.png" afterPath="" />[m
[31m-      <change type="DELETED" beforePath="C:\Bitrix\www\b.zakrepi.dev\zakrepi\upload\tmp\BXTEMP-2015-10-27\22\bxu\305a18bcee97c3d5290e18664d8cf572\file1445925851984\bosch.png" afterPath="" />[m
[31m-      <change type="DELETED" beforePath="C:\Bitrix\www\b.zakrepi.dev\zakrepi\upload\tmp\BXTEMP-2015-10-27\22\bxu\305a18bcee97c3d5290e18664d8cf572\file1445926060425\kovea.png" afterPath="" />[m
[31m-      <change type="DELETED" beforePath="C:\Bitrix\www\b.zakrepi.dev\zakrepi\upload\tmp\BXTEMP-2015-10-27\22\bxu\305a18bcee97c3d5290e18664d8cf572\file1445926069923\dewalt.png" afterPath="" />[m
[31m-      <change type="DELETED" beforePath="C:\Bitrix\www\b.zakrepi.dev\zakrepi\upload\tmp\BXTEMP-2015-10-27\22\bxu\305a18bcee97c3d5290e18664d8cf572\file1445926173218\aeg.png" afterPath="" />[m
[31m-      <change type="DELETED" beforePath="C:\Bitrix\www\b.zakrepi.dev\zakrepi\upload\tmp\BXTEMP-2015-10-27\22\bxu\305a18bcee97c3d5290e18664d8cf572\file1445926191595\metabo.png" afterPath="" />[m
[31m-      <change type="DELETED" beforePath="C:\Bitrix\www\b.zakrepi.dev\zakrepi\upload\tmp\BXTEMP-2015-10-27\22\bxu\305a18bcee97c3d5290e18664d8cf572\file1445926285639\makita.png" afterPath="" />[m
[31m-      <change type="MODIFICATION" beforePath="$PROJECT_DIR$/.htaccess" afterPath="$PROJECT_DIR$/.htaccess" />[m
[31m-      <change type="MODIFICATION" beforePath="$PROJECT_DIR$/.top.menu_ext.php" afterPath="$PROJECT_DIR$/.top.menu_ext.php" />[m
[31m-      <change type="MODIFICATION" beforePath="$PROJECT_DIR$/local/templates/zakrepi/js/function.js" afterPath="$PROJECT_DIR$/local/templates/zakrepi/js/function.js" />[m
[31m-      <change type="MODIFICATION" beforePath="$PROJECT_DIR$/local/php_interface/include/function.php" afterPath="$PROJECT_DIR$/local/php_interface/include/function.php" />[m
[31m-      <change type="MODIFICATION" beforePath="$PROJECT_DIR$/local/templates/zakrepi/header.php" afterPath="$PROJECT_DIR$/local/templates/zakrepi/header.php" />[m
[31m-      <change type="MODIFICATION" beforePath="$PROJECT_DIR$/upload/1c_catalog/import.xml" afterPath="$PROJECT_DIR$/upload/1c_catalog/import.xml" />[m
[31m-      <change type="MODIFICATION" beforePath="$PROJECT_DIR$/catalog/index.php" afterPath="$PROJECT_DIR$/catalog/index.php" />[m
       <change type="MODIFICATION" beforePath="$PROJECT_DIR$/personal/index.php" afterPath="$PROJECT_DIR$/personal/index.php" />[m
[31m-      <change type="MODIFICATION" beforePath="$PROJECT_DIR$/personal/account/index.php" afterPath="$PROJECT_DIR$/personal/account/index.php" />[m
[31m-      <change type="MODIFICATION" beforePath="$PROJECT_DIR$/local/modules/zakrepisettigs/options.php" afterPath="$PROJECT_DIR$/local/modules/zakrepisettigs/options.php" />[m
[31m-      <change type="MODIFICATION" beforePath="$PROJECT_DIR$/local/modules/zakrepisettigs/lang/ru/options.php" afterPath="$PROJECT_DIR$/local/modules/zakrepisettigs/lang/ru/options.php" />[m
[31m-      <change type="MODIFICATION" beforePath="$PROJECT_DIR$/personal/registration.php" afterPath="$PROJECT_DIR$/personal/registration.php" />[m
[31m-      <change type="MODIFICATION" beforePath="$PROJECT_DIR$/local/php_interface/include/settings.php" afterPath="$PROJECT_DIR$/local/php_interface/include/settings.php" />[m
[31m-      <change type="MODIFICATION" beforePath="$PROJECT_DIR$/local/templates/zakrepi/components/bitrix/main.register/registration/template.php" afterPath="$PROJECT_DIR$/local/templates/zakrepi/components/bitrix/main.register/registration/template.php" />[m
[31m-      <change type="MODIFICATION" beforePath="$PROJECT_DIR$/local/templates/zakrepi/components/bitrix/system.auth.form/zakrepi-auth/template.php" afterPath="$PROJECT_DIR$/local/templates/zakrepi/components/bitrix/system.auth.form/zakrepi-auth/template.php" />[m
[31m-      <change type="MODIFICATION" beforePath="$PROJECT_DIR$/local/templates/zakrepi/template_styles.css" afterPath="$PROJECT_DIR$/local/templates/zakrepi/template_styles.css" />[m
[31m-      <change type="MODIFICATION" beforePath="$PROJECT_DIR$/personal/address/update_address.php" afterPath="$PROJECT_DIR$/personal/address/update_address.php" />[m
[31m-      <change type="MODIFICATION" beforePath="$PROJECT_DIR$/personal/account/update_personal.php" afterPath="$PROJECT_DIR$/personal/account/update_personal.php" />[m
[32m+[m[32m      <change type="MODIFICATION" beforePath="$PROJECT_DIR$/local/templates/zakrepi/js/svg-lib.js" afterPath="$PROJECT_DIR$/local/templates/zakrepi/js/svg-lib.js" />[m
       <change type="MODIFICATION" beforePath="$PROJECT_DIR$/urlrewrite.php" afterPath="$PROJECT_DIR$/urlrewrite.php" />[m
[31m-      <change type="MODIFICATION" beforePath="$PROJECT_DIR$/.idea/workspace.xml" afterPath="$PROJECT_DIR$/.idea/workspace.xml" />[m
     </list>[m
     <ignored path="zakrepi.iws" />[m
     <ignored path=".idea/workspace.xml" />[m
[36m@@ -69,94 +29,105 @@[m
   </component>[m
   <component name="FileEditorManager">[m
     <leaf>[m
[31m-      <file leaf-file-name="detail.php" pinned="false" current-in-tab="false">[m
[31m-        <entry file="file://$PROJECT_DIR$/catalog/detail.php">[m
[32m+[m[32m      <file leaf-file-name="urlrewrite.php" pinned="false" current-in-tab="false">[m
[32m+[m[32m        <entry file="file://$PROJECT_DIR$/urlrewrite.php">[m
           <provider selected="true" editor-type-id="text-editor">[m
[31m-            <state vertical-scroll-proportion="-10.423077" vertical-offset="120" max-vertical-offset="1904">[m
[31m-              <caret line="23" column="25" selection-start-line="23" selection-start-column="13" selection-end-line="23" selection-end-column="25" />[m
[32m+[m[32m            <state vertical-scroll-proportion="-22.884615" vertical-offset="0" max-vertical-offset="969">[m
[32m+[m[32m              <caret line="35" column="33" selection-start-line="35" selection-start-column="33" selection-end-line="35" selection-end-column="33" />[m
               <folding />[m
             </state>[m
           </provider>[m
         </entry>[m
       </file>[m
[31m-      <file leaf-file-name="index.php" pinned="false" current-in-tab="false">[m
[31m-        <entry file="file://$PROJECT_DIR$/cart/index.php">[m
[32m+[m[32m      <file leaf-file-name="template.php" pinned="false" current-in-tab="false">[m
[32m+[m[32m        <entry file="file://$PROJECT_DIR$/local/templates/zakrepi/components/bitrix/main.register/registration/template.php">[m
           <provider selected="true" editor-type-id="text-editor">[m
[31m-            <state vertical-scroll-proportion="-0.65384614" vertical-offset="0" max-vertical-offset="153">[m
[31m-              <caret line="1" column="25" selection-start-line="1" selection-start-column="25" selection-end-line="1" selection-end-column="25" />[m
[31m-              <folding />[m
[32m+[m[32m            <state vertical-scroll-proportion="-29.076923" vertical-offset="5177" max-vertical-offset="6052">[m
[32m+[m[32m              <caret line="349" column="13" selection-start-line="171" selection-start-column="4" selection-end-line="349" selection-end-column="13" />[m
[32m+[m[32m              <folding>[m
[32m+[m[32m                <element signature="e#3#100#0#PHP" expanded="true" />[m
[32m+[m[32m              </folding>[m
             </state>[m
           </provider>[m
         </entry>[m
       </file>[m
[31m-      <file leaf-file-name="template_styles.css" pinned="false" current-in-tab="false">[m
[31m-        <entry file="file://$PROJECT_DIR$/local/templates/zakrepi/template_styles.css">[m
[32m+[m[32m      <file leaf-file-name="auth.php" pinned="false" current-in-tab="false">[m
[32m+[m[32m        <entry file="file://$PROJECT_DIR$/personal/auth.php">[m
           <provider selected="true" editor-type-id="text-editor">[m
[31m-            <state vertical-scroll-proportion="-10.035714" vertical-offset="55802" max-vertical-offset="114070">[m
[31m-              <caret line="3299" column="1" selection-start-line="3299" selection-start-column="1" selection-end-line="3299" selection-end-column="13" />[m
[32m+[m[32m            <state vertical-scroll-proportion="-3.9230769" vertical-offset="0" max-vertical-offset="204">[m
[32m+[m[32m              <caret line="6" column="60" selection-start-line="6" selection-start-column="60" selection-end-line="6" selection-end-column="60" />[m
               <folding />[m
             </state>[m
           </provider>[m
         </entry>[m
       </file>[m
[31m-      <file leaf-file-name="function.js" pinned="false" current-in-tab="false">[m
[31m-        <entry file="file://$PROJECT_DIR$/local/templates/zakrepi/js/function.js">[m
[32m+[m[32m      <file leaf-file-name="template.php" pinned="false" current-in-tab="true">[m
[32m+[m[32m        <entry file="file://$PROJECT_DIR$/local/templates/zakrepi/components/bitrix/system.auth.forgotpasswd/.default/template.php">[m
           <provider selected="true" editor-type-id="text-editor">[m
[31m-            <state vertical-scroll-proportion="0.0" vertical-offset="2157" max-vertical-offset="3094">[m
[31m-              <caret line="172" column="1" selection-start-line="172" selection-start-column="1" selection-end-line="172" selection-end-column="1" />[m
[32m+[m[32m            <state vertical-scroll-proportion="0.24887387" vertical-offset="0" max-vertical-offset="1394">[m
[32m+[m[32m              <caret line="13" column="61" selection-start-line="13" selection-start-column="61" selection-end-line="13" selection-end-column="61" />[m
               <folding />[m
             </state>[m
           </provider>[m
         </entry>[m
       </file>[m
[31m-      <file leaf-file-name="urlrewrite.php" pinned="false" current-in-tab="false">[m
[31m-        <entry file="file://$PROJECT_DIR$/urlrewrite.php">[m
[32m+[m[32m      <file leaf-file-name="index.php" pinned="false" current-in-tab="false">[m
[32m+[m[32m        <entry file="file://$PROJECT_DIR$/personal/address/index.php">[m
           <provider selected="true" editor-type-id="text-editor">[m
[31m-            <state vertical-scroll-proportion="-8.884615" vertical-offset="245" max-vertical-offset="1156">[m
[31m-              <caret line="28" column="6" selection-start-line="28" selection-start-column="6" selection-end-line="28" selection-end-column="6" />[m
[32m+[m[32m            <state vertical-scroll-proportion="-5.730769" vertical-offset="55" max-vertical-offset="969">[m
[32m+[m[32m              <caret line="12" column="24" selection-start-line="12" selection-start-column="17" selection-end-line="12" selection-end-column="24" />[m
               <folding />[m
             </state>[m
           </provider>[m
         </entry>[m
       </file>[m
[31m-      <file leaf-file-name="urlwrite_old.php" pinned="false" current-in-tab="false">[m
[31m-        <entry file="file://$PROJECT_DIR$/urlwrite_old.php">[m
[32m+[m[32m      <file leaf-file-name="list.php" pinned="false" current-in-tab="false">[m
[32m+[m[32m        <entry file="file://$PROJECT_DIR$/includes/personal/address/list.php">[m
           <provider selected="true" editor-type-id="text-editor">[m
[31m-            <state vertical-scroll-proportion="-33.73077" vertical-offset="177" max-vertical-offset="1156">[m
[31m-              <caret line="62" column="2" selection-start-line="62" selection-start-column="2" selection-end-line="62" selection-end-column="2" />[m
[32m+[m[32m            <state vertical-scroll-proportion="-0.65384614" vertical-offset="0" max-vertical-offset="1241">[m
[32m+[m[32m              <caret line="1" column="0" selection-start-line="1" selection-start-column="0" selection-end-line="3" selection-end-column="6" />[m
               <folding />[m
             </state>[m
           </provider>[m
         </entry>[m
       </file>[m
[31m-      <file leaf-file-name="template.php" pinned="false" current-in-tab="true">[m
[31m-        <entry file="file://$PROJECT_DIR$/local/templates/zakrepi/components/zakrepi/catalog.element/catalog-element/template.php">[m
[32m+[m[32m      <file leaf-file-name="template.php" pinned="false" current-in-tab="false">[m
[32m+[m[32m        <entry file="file://$PROJECT_DIR$/local/templates/zakrepi/components/bitrix/system.auth.forgotpasswd/.default/lang/ru/template.php">[m
           <provider selected="true" editor-type-id="text-editor">[m
[31m-            <state vertical-scroll-proportion="9.494253" vertical-offset="4439" max-vertical-offset="27438">[m
[31m-              <caret line="747" column="0" selection-start-line="747" selection-start-column="0" selection-end-line="747" selection-end-column="0" />[m
[31m-              <folding>[m
[31m-                <element signature="n#style#0;n#a#0;n#div#0;n#div#0;n#div#0;n#div#0;n#div#1;n#div#0;n#div#0;n#div#2;n#div#1;n#div#2;n#div#0;n#!!top" expanded="true" />[m
[31m-                <element signature="n#style#0;n#div#0;n#div#1;n#div#1;n#div#1;n#div#2;n#!!top" expanded="true" />[m
[31m-              </folding>[m
[32m+[m[32m            <state vertical-scroll-proportion="-0.65384614" vertical-offset="0" max-vertical-offset="238">[m
[32m+[m[32m              <caret line="1" column="74" selection-start-line="1" selection-start-column="74" selection-end-line="1" selection-end-column="74" />[m
[32m+[m[32m              <folding />[m
             </state>[m
           </provider>[m
         </entry>[m
       </file>[m
[31m-      <file leaf-file-name="result_modifier.php" pinned="false" current-in-tab="false">[m
[31m-        <entry file="file://$PROJECT_DIR$/local/templates/zakrepi/components/zakrepi/catalog.element/catalog-element/result_modifier.php">[m
[32m+[m[32m      <file leaf-file-name="template.php" pinned="false" current-in-tab="false">[m
[32m+[m[32m        <entry file="file://$PROJECT_DIR$/local/templates/zakrepi/components/bitrix/system.auth.form/zakrepi-auth/template.php">[m
           <provider selected="true" editor-type-id="text-editor">[m
[31m-            <state vertical-scroll-proportion="-11.5" vertical-offset="7249" max-vertical-offset="10302">[m
[31m-              <caret line="446" column="17" selection-start-line="446" selection-start-column="12" selection-end-line="446" selection-end-column="17" />[m
[32m+[m[32m            <state vertical-scroll-proportion="-15.111111" vertical-offset="0" max-vertical-offset="1224">[m
[32m+[m[32m              <caret line="48" column="41" selection-start-line="48" selection-start-column="41" selection-end-line="48" selection-end-column="41" />[m
               <folding />[m
             </state>[m
           </provider>[m
         </entry>[m
       </file>[m
[31m-      <file leaf-file-name="function.php" pinned="false" current-in-tab="false">[m
[31m-        <entry file="file://$PROJECT_DIR$/local/php_interface/include/function.php">[m
[32m+[m[32m      <file leaf-file-name="template.php" pinned="false" current-in-tab="false">[m
[32m+[m[32m        <entry file="file://$PROJECT_DIR$/local/templates/zakrepi/components/bitrix/socserv.auth.form/soc-zakrepi-auth/template.php">[m
[32m+[m[32m          <provider selected="true" editor-type-id="text-editor">[m
[32m+[m[32m            <state vertical-scroll-proportion="-20.153847" vertical-offset="411" max-vertical-offset="1309">[m
[32m+[m[32m              <caret line="55" column="29" selection-start-line="55" selection-start-column="29" selection-end-line="55" selection-end-column="29" />[m
[32m+[m[32m              <folding>[m
[32m+[m[32m                <element signature="e#453#473#0#HTML" expanded="true" />[m
[32m+[m[32m              </folding>[m
[32m+[m[32m            </state>[m
[32m+[m[32m          </provider>[m
[32m+[m[32m        </entry>[m
[32m+[m[32m      </file>[m
[32m+[m[32m      <file leaf-file-name="registration.php" pinned="false" current-in-tab="false">[m
[32m+[m[32m        <entry file="file://$PROJECT_DIR$/personal/registration.php">[m
           <provider selected="true" editor-type-id="text-editor">[m
[31m-            <state vertical-scroll-proportion="-20.26923" vertical-offset="0" max-vertical-offset="935">[m
[31m-              <caret line="31" column="19" selection-start-line="31" selection-start-column="19" selection-end-line="31" selection-end-column="19" />[m
[32m+[m[32m            <state vertical-scroll-proportion="-20.76923" vertical-offset="4" max-vertical-offset="918">[m
[32m+[m[32m              <caret line="32" column="23" selection-start-line="32" selection-start-column="23" selection-end-line="32" selection-end-column="23" />[m
               <folding />[m
             </state>[m
           </provider>[m
[36m@@ -175,11 +146,26 @@[m
   <component name="IdeDocumentHistory">[m
     <option name="changedFiles">[m
       <list>[m
[32m+[m[32m        <option value="$PROJECT_DIR$/local/modules/bannergrid/install/index.php" />[m
[32m+[m[32m        <option value="$PROJECT_DIR$/bitrix/admin/user_address_list.php" />[m
[32m+[m[32m        <option value="$PROJECT_DIR$/local/modules/zakrepisettigs/options.php" />[m
[32m+[m[32m        <option value="$PROJECT_DIR$/local/modules/zakrepisettigs/lang/ru/options.php" />[m
[32m+[m[32m        <option value="$PROJECT_DIR$/local/php_interface/include/settings.php" />[m
[32m+[m[32m        <option value="$PROJECT_DIR$/local/templates/zakrepi/footer.php" />[m
[32m+[m[32m        <option value="$PROJECT_DIR$/local/modules/cityfranchise/install/unstep.php" />[m
[32m+[m[32m        <option value="$PROJECT_DIR$/local/modules/cityfranchise/install/step.php" />[m
[32m+[m[32m        <option value="$PROJECT_DIR$/local/modules/cityfranchise/install/version.php" />[m
[32m+[m[32m        <option value="$PROJECT_DIR$/local/modules/cityfranchise/install/index.php" />[m
[32m+[m[32m        <option value="$PROJECT_DIR$/local/modules/cityfranchise/include.php" />[m
[32m+[m[32m        <option value="$PROJECT_DIR$/local/modules/cityfranchise/classes/cCityFranchise.php" />[m
         <option value="$PROJECT_DIR$/local/templates/zakrepi/components/bitrix/news.list/brand_home/template.php" />[m
         <option value="$PROJECT_DIR$/brand/index.php" />[m
         <option value="$PROJECT_DIR$/brand/detail.php" />[m
[32m+[m[32m        <option value="$PROJECT_DIR$/index.php" />[m
         <option value="$PROJECT_DIR$/personal/account/personal_update.php" />[m
[32m+[m[32m        <option value="$PROJECT_DIR$/personal/account/update_personal.php" />[m
         <option value="$PROJECT_DIR$/personal/account/update_password.php" />[m
[32m+[m[32m        <option value="$PROJECT_DIR$/personal/address/update_address.php" />[m
         <option value="$PROJECT_DIR$/personal/address/add_address.php" />[m
         <option value="$PROJECT_DIR$/local/modules/useraddress/admin/user_address_list.php" />[m
         <option value="$PROJECT_DIR$/local/modules/useraddress/lib/function/component/remove_address_user.php" />[m
[36m@@ -188,44 +174,29 @@[m
         <option value="$PROJECT_DIR$/local/modules/useraddress/lib/function/remove_address_user.php" />[m
         <option value="$PROJECT_DIR$/local/modules/useraddress/classes/general/cUserAddress.php" />[m
         <option value="$PROJECT_DIR$/local/modules/useraddress/lib/function/component/function_component.php" />[m
[32m+[m[32m        <option value="$PROJECT_DIR$/personal/account/index.php" />[m
[32m+[m[32m        <option value="$PROJECT_DIR$/local/templates/zakrepi/header.php" />[m
[32m+[m[32m        <option value="$PROJECT_DIR$/.top.menu_ext.php" />[m
         <option value="$PROJECT_DIR$/local/templates/zakrepi/components/bitrix/menu/top-menu/template.php" />[m
         <option value="$PROJECT_DIR$/local/templates/zakrepi/js/script.js" />[m
         <option value="$PROJECT_DIR$/local/php_interface/init.php" />[m
[32m+[m[32m        <option value="$PROJECT_DIR$/personal/registration.php" />[m
         <option value="$PROJECT_DIR$/local/php_interface/include/users.php" />[m
[32m+[m[32m        <option value="$PROJECT_DIR$/local/templates/zakrepi/js/function.js" />[m
[32m+[m[32m        <option value="$PROJECT_DIR$/local/templates/zakrepi/template_styles.css" />[m
[32m+[m[32m        <option value="$PROJECT_DIR$/local/templates/zakrepi/components/bitrix/main.register/registration/template.php" />[m
         <option value="$PROJECT_DIR$/local/templates/zakrepi/components/bitrix/system.auth.form/zakrepi-auth/lang/ru/template.php" />[m
         <option value="$PROJECT_DIR$/local/templates/zakrepi/components/bitrix/socserv.auth.form/template.php" />[m
         <option value="$PROJECT_DIR$/local/templates/zakrepi/components/bitrix/socserv.auth.form/soc-zakrepi-auth/component_epilog.php" />[m
         <option value="$PROJECT_DIR$/local/templates/zakrepi/components/bitrix/socserv.auth.form/soc-zakrepi-auth/result_modifer.php" />[m
         <option value="$PROJECT_DIR$/local/templates/zakrepi/js/svg-lib.js" />[m
         <option value="$PROJECT_DIR$/local/templates/zakrepi/components/bitrix/socserv.auth.form/soc-zakrepi-auth/template.php" />[m
[31m-        <option value="$PROJECT_DIR$/local/templates/zakrepi/components/bitrix/system.auth.forgotpasswd/.default/lang/ru/template.php" />[m
[31m-        <option value="$PROJECT_DIR$/local/templates/zakrepi/components/bitrix/system.auth.forgotpasswd/.default/template.php" />[m
[31m-        <option value="$PROJECT_DIR$/includes/header/personal.php" />[m
         <option value="$PROJECT_DIR$/personal/index.php" />[m
[31m-        <option value="$PROJECT_DIR$/personal/registration.php" />[m
[32m+[m[32m        <option value="$PROJECT_DIR$/urlrewrite.php" />[m
         <option value="$PROJECT_DIR$/personal/auth.php" />[m
[31m-        <option value="$PROJECT_DIR$/personal/account/update_personal.php" />[m
[31m-        <option value="$PROJECT_DIR$/local/templates/zakrepi/components/bitrix/main.profile/profile-zakrepi-update/template.php" />[m
[31m-        <option value="$PROJECT_DIR$/personal/address/update_address.php" />[m
[32m+[m[32m        <option value="$PROJECT_DIR$/local/templates/zakrepi/components/bitrix/system.auth.forgotpasswd/.default/lang/ru/template.php" />[m
         <option value="$PROJECT_DIR$/local/templates/zakrepi/components/bitrix/system.auth.form/zakrepi-auth/template.php" />[m
[31m-        <option value="$PROJECT_DIR$/personal/account/index.php" />[m
[31m-        <option value="$PROJECT_DIR$/local/modules/zakrepisettigs/options.php" />[m
[31m-        <option value="$PROJECT_DIR$/local/modules/zakrepisettigs/lang/ru/options.php" />[m
[31m-        <option value="$PROJECT_DIR$/local/php_interface/include/settings.php" />[m
[31m-        <option value="$PROJECT_DIR$/index.php" />[m
[31m-        <option value="$PROJECT_DIR$/.top.menu_ext.php" />[m
[31m-        <option value="$PROJECT_DIR$/local/templates/zakrepi/header.php" />[m
[31m-        <option value="$PROJECT_DIR$/urlwrite_old.php" />[m
[31m-        <option value="$PROJECT_DIR$/urlrewrite.php" />[m
[31m-        <option value="$PROJECT_DIR$/cart/index.php" />[m
[31m-        <option value="$PROJECT_DIR$/catalog/index.php" />[m
[31m-        <option value="$PROJECT_DIR$/catalog/detail.php" />[m
[31m-        <option value="$PROJECT_DIR$/local/templates/zakrepi/js/function.js" />[m
[31m-        <option value="$PROJECT_DIR$/local/templates/zakrepi/components/bitrix/main.register/registration/template.php" />[m
[31m-        <option value="$PROJECT_DIR$/local/php_interface/include/function.php" />[m
[31m-        <option value="$PROJECT_DIR$/local/templates/zakrepi/template_styles.css" />[m
[31m-        <option value="$PROJECT_DIR$/local/templates/zakrepi/components/zakrepi/catalog.element/catalog-element/result_modifier.php" />[m
[31m-        <option value="$PROJECT_DIR$/local/templates/zakrepi/components/zakrepi/catalog.element/catalog-element/template.php" />[m
[32m+[m[32m        <option value="$PROJECT_DIR$/local/templates/zakrepi/components/bitrix/system.auth.forgotpasswd/.default/template.php" />[m
       </list>[m
     </option>[m
   </component>[m
[36m@@ -278,7 +249,6 @@[m
       <sortByType />[m
     </navigator>[m
     <panes>[m
[31m-      <pane id="Scope" />[m
       <pane id="ProjectPane">[m
         <subPane>[m
           <PATH>[m
[36m@@ -321,53 +291,11 @@[m
               <option name="myItemType" value="com.intellij.ide.projectView.impl.nodes.PsiDirectoryNode" />[m
             </PATH_ELEMENT>[m
             <PATH_ELEMENT>[m
[31m-              <option name="myItemId" value="local" />[m
[31m-              <option name="myItemType" value="com.intellij.ide.projectView.impl.nodes.PsiDirectoryNode" />[m
[31m-            </PATH_ELEMENT>[m
[31m-            <PATH_ELEMENT>[m
[31m-              <option name="myItemId" value="templates" />[m
[31m-              <option name="myItemType" value="com.intellij.ide.projectView.impl.nodes.PsiDirectoryNode" />[m
[31m-            </PATH_ELEMENT>[m
[31m-            <PATH_ELEMENT>[m
[31m-              <option name="myItemId" value="zakrepi" />[m
[31m-              <option name="myItemType" value="com.intellij.ide.projectView.impl.nodes.PsiDirectoryNode" />[m
[31m-            </PATH_ELEMENT>[m
[31m-          </PATH>[m
[31m-          <PATH>[m
[31m-            <PATH_ELEMENT>[m
[31m-              <option name="myItemId" value="zakrepi" />[m
[31m-              <option name="myItemType" value="com.intellij.ide.projectView.impl.nodes.ProjectViewProjectNode" />[m
[31m-            </PATH_ELEMENT>[m
[31m-            <PATH_ELEMENT>[m
[31m-              <option name="myItemId" value="zakrepi" />[m
[31m-              <option name="myItemType" value="com.intellij.ide.projectView.impl.nodes.PsiDirectoryNode" />[m
[31m-            </PATH_ELEMENT>[m
[31m-            <PATH_ELEMENT>[m
[31m-              <option name="myItemId" value="local" />[m
[31m-              <option name="myItemType" value="com.intellij.ide.projectView.impl.nodes.PsiDirectoryNode" />[m
[31m-            </PATH_ELEMENT>[m
[31m-            <PATH_ELEMENT>[m
[31m-              <option name="myItemId" value="templates" />[m
[31m-              <option name="myItemType" value="com.intellij.ide.projectView.impl.nodes.PsiDirectoryNode" />[m
[31m-            </PATH_ELEMENT>[m
[31m-            <PATH_ELEMENT>[m
[31m-              <option name="myItemId" value="zakrepi" />[m
[31m-              <option name="myItemType" value="com.intellij.ide.projectView.impl.nodes.PsiDirectoryNode" />[m
[31m-            </PATH_ELEMENT>[m
[31m-            <PATH_ELEMENT>[m
[31m-              <option name="myItemId" value="components" />[m
[31m-              <option name="myItemType" value="com.intellij.ide.projectView.impl.nodes.PsiDirectoryNode" />[m
[31m-            </PATH_ELEMENT>[m
[31m-            <PATH_ELEMENT>[m
[31m-              <option name="myItemId" value="zakrepi" />[m
[31m-              <option name="myItemType" value="com.intellij.ide.projectView.impl.nodes.PsiDirectoryNode" />[m
[31m-            </PATH_ELEMENT>[m
[31m-            <PATH_ELEMENT>[m
[31m-              <option name="myItemId" value="catalog.element" />[m
[32m+[m[32m              <option name="myItemId" value="personal" />[m
               <option name="myItemType" value="com.intellij.ide.projectView.impl.nodes.PsiDirectoryNode" />[m
             </PATH_ELEMENT>[m
             <PATH_ELEMENT>[m
[31m-              <option name="myItemId" value="catalog-element" />[m
[32m+[m[32m              <option name="myItemId" value="address" />[m
               <option name="myItemType" value="com.intellij.ide.projectView.impl.nodes.PsiDirectoryNode" />[m
             </PATH_ELEMENT>[m
           </PATH>[m
[36m@@ -384,22 +312,6 @@[m
               <option name="myItemId" value="local" />[m
               <option name="myItemType" value="com.intellij.ide.projectView.impl.nodes.PsiDirectoryNode" />[m
             </PATH_ELEMENT>[m
[31m-            <PATH_ELEMENT>[m
[31m-              <option name="myItemId" value="templates" />[m
[31m-              <option name="myItemType" value="com.intellij.ide.projectView.impl.nodes.PsiDirectoryNode" />[m
[31m-            </PATH_ELEMENT>[m
[31m-            <PATH_ELEMENT>[m
[31m-              <option name="myItemId" value="zakrepi" />[m
[31m-              <option name="myItemType" value="com.intellij.ide.projectView.impl.nodes.PsiDirectoryNode" />[m
[31m-            </PATH_ELEMENT>[m
[31m-            <PATH_ELEMENT>[m
[31m-              <option name="myItemId" value="components" />[m
[31m-              <option name="myItemType" value="com.intellij.ide.projectView.impl.nodes.PsiDirectoryNode" />[m
[31m-            </PATH_ELEMENT>[m
[31m-            <PATH_ELEMENT>[m
[31m-              <option name="myItemId" value="zakrepi" />[m
[31m-              <option name="myItemType" value="com.intellij.ide.projectView.impl.nodes.PsiDirectoryNode" />[m
[31m-            </PATH_ELEMENT>[m
           </PATH>[m
           <PATH>[m
             <PATH_ELEMENT>[m
[36m@@ -411,19 +323,7 @@[m
               <option name="myItemType" value="com.intellij.ide.projectView.impl.nodes.PsiDirectoryNode" />[m
             </PATH_ELEMENT>[m
             <PATH_ELEMENT>[m
[31m-              <option name="myItemId" value="local" />[m
[31m-              <option name="myItemType" value="com.intellij.ide.projectView.impl.nodes.PsiDirectoryNode" />[m
[31m-            </PATH_ELEMENT>[m
[31m-            <PATH_ELEMENT>[m
[31m-              <option name="myItemId" value="templates" />[m
[31m-              <option name="myItemType" value="com.intellij.ide.projectView.impl.nodes.PsiDirectoryNode" />[m
[31m-            </PATH_ELEMENT>[m
[31m-            <PATH_ELEMENT>[m
[31m-              <option name="myItemId" value="zakrepi" />[m
[31m-              <option name="myItemType" value="com.intellij.ide.projectView.impl.nodes.PsiDirectoryNode" />[m
[31m-            </PATH_ELEMENT>[m
[31m-            <PATH_ELEMENT>[m
[31m-              <option name="myItemId" value="components" />[m
[32m+[m[32m              <option name="myItemId" value="includes" />[m
               <option name="myItemType" value="com.intellij.ide.projectView.impl.nodes.PsiDirectoryNode" />[m
             </PATH_ELEMENT>[m
           </PATH>[m
[36m@@ -437,52 +337,21 @@[m
               <option name="myItemType" value="com.intellij.ide.projectView.impl.nodes.PsiDirectoryNode" />[m
             </PATH_ELEMENT>[m
             <PATH_ELEMENT>[m
[31m-              <option name="myItemId" value="local" />[m
[31m-              <option name="myItemType" value="com.intellij.ide.projectView.impl.nodes.PsiDirectoryNode" />[m
[31m-            </PATH_ELEMENT>[m
[31m-            <PATH_ELEMENT>[m
[31m-              <option name="myItemId" value="php_interface" />[m
[32m+[m[32m              <option name="myItemId" value="includes" />[m
               <option name="myItemType" value="com.intellij.ide.projectView.impl.nodes.PsiDirectoryNode" />[m
             </PATH_ELEMENT>[m
[31m-          </PATH>[m
[31m-          <PATH>[m
             <PATH_ELEMENT>[m
[31m-              <option name="myItemId" value="zakrepi" />[m
[31m-              <option name="myItemType" value="com.intellij.ide.projectView.impl.nodes.ProjectViewProjectNode" />[m
[31m-            </PATH_ELEMENT>[m
[31m-            <PATH_ELEMENT>[m
[31m-              <option name="myItemId" value="zakrepi" />[m
[31m-              <option name="myItemType" value="com.intellij.ide.projectView.impl.nodes.PsiDirectoryNode" />[m
[31m-            </PATH_ELEMENT>[m
[31m-            <PATH_ELEMENT>[m
[31m-              <option name="myItemId" value="local" />[m
[31m-              <option name="myItemType" value="com.intellij.ide.projectView.impl.nodes.PsiDirectoryNode" />[m
[31m-            </PATH_ELEMENT>[m
[31m-            <PATH_ELEMENT>[m
[31m-              <option name="myItemId" value="php_interface" />[m
[31m-              <option name="myItemType" value="com.intellij.ide.projectView.impl.nodes.PsiDirectoryNode" />[m
[31m-            </PATH_ELEMENT>[m
[31m-            <PATH_ELEMENT>[m
[31m-              <option name="myItemId" value="include" />[m
[31m-              <option name="myItemType" value="com.intellij.ide.projectView.impl.nodes.PsiDirectoryNode" />[m
[31m-            </PATH_ELEMENT>[m
[31m-          </PATH>[m
[31m-          <PATH>[m
[31m-            <PATH_ELEMENT>[m
[31m-              <option name="myItemId" value="zakrepi" />[m
[31m-              <option name="myItemType" value="com.intellij.ide.projectView.impl.nodes.ProjectViewProjectNode" />[m
[31m-            </PATH_ELEMENT>[m
[31m-            <PATH_ELEMENT>[m
[31m-              <option name="myItemId" value="zakrepi" />[m
[32m+[m[32m              <option name="myItemId" value="personal" />[m
               <option name="myItemType" value="com.intellij.ide.projectView.impl.nodes.PsiDirectoryNode" />[m
             </PATH_ELEMENT>[m
             <PATH_ELEMENT>[m
[31m-              <option name="myItemId" value="local" />[m
[32m+[m[32m              <option name="myItemId" value="address" />[m
               <option name="myItemType" value="com.intellij.ide.projectView.impl.nodes.PsiDirectoryNode" />[m
             </PATH_ELEMENT>[m
           </PATH>[m
         </subPane>[m
       </pane>[m
[32m+[m[32m      <pane id="Scope" />[m
     </panes>[m
   </component>[m
   <component name="PropertiesComponent">[m
[36m@@ -520,6 +389,9 @@[m
       <BehatRunner />[m
       <method />[m
     </configuration>[m
[32m+[m[32m    <configuration default="true" type="PhpUnitRemoteRunConfigurationType" factoryName="PHPUnit on Server">[m
[32m+[m[32m      <method />[m
[32m+[m[32m    </configuration>[m
     <configuration default="true" type="js.build_tools.gulp" factoryName="Gulp.js">[m
       <node-options />[m
       <gulpfile />[m
[36m@@ -528,9 +400,6 @@[m
       <envs />[m
       <method />[m
     </configuration>[m
[31m-    <configuration default="true" type="PhpUnitRemoteRunConfigurationType" factoryName="PHPUnit on Server">[m
[31m-      <method />[m
[31m-    </configuration>[m
     <list size="0" />[m
   </component>[m
   <component name="ShelveChangesManager" show_recycled="false" />[m
[36m@@ -547,7 +416,7 @@[m
     <servers />[m
   </component>[m
   <component name="ToolWindowManager">[m
[31m-    <frame x="1912" y="-8" width="1936" height="1096" extended-state="7" />[m
[32m+[m[32m    <frame x="1912" y="-8" width="1936" height="1096" extended-state="0" />[m
     <editor active="true" />[m
     <layout>[m
       <window_info id="Changes" active="false" anchor="bottom" auto_hide="false" internal_type="DOCKED" type="DOCKED" visible="false" weight="0.33" sideWeight="0.5" order="7" side_tool="false" content_ui="tabs" />[m
[36m@@ -557,19 +426,19 @@[m
       <window_info id="Structure" active="false" anchor="left" auto_hide="false" internal_type="DOCKED" type="DOCKED" visible="false" weight="0.25" sideWeight="0.5" order="1" side_tool="false" content_ui="tabs" />[m
       <window_info id="Application Servers" active="false" anchor="bottom" auto_hide="false" internal_type="DOCKED" type="DOCKED" visible="false" weight="0.33" sideWeight="0.5" order="7" side_tool="false" content_ui="tabs" />[m
       <window_info id="Remote Host" active="false" anchor="right" auto_hide="false" internal_type="DOCKED" type="DOCKED" visible="false" weight="0.33" sideWeight="0.5" order="3" side_tool="false" content_ui="tabs" />[m
[31m-      <window_info id="Project" active="false" anchor="left" auto_hide="false" internal_type="DOCKED" type="DOCKED" visible="true" weight="0.1663113" sideWeight="0.5" order="0" side_tool="false" content_ui="combo" />[m
[32m+[m[32m      <window_info id="Project" active="false" anchor="left" auto_hide="false" internal_type="DOCKED" type="DOCKED" visible="true" weight="0.23400854" sideWeight="0.5" order="0" side_tool="false" content_ui="combo" />[m
       <window_info id="Favorites" active="false" anchor="left" auto_hide="false" internal_type="DOCKED" type="DOCKED" visible="false" weight="0.33" sideWeight="0.5" order="2" side_tool="true" content_ui="tabs" />[m
       <window_info id="Event Log" active="false" anchor="bottom" auto_hide="false" internal_type="DOCKED" type="DOCKED" visible="false" weight="0.33" sideWeight="0.5" order="7" side_tool="true" content_ui="tabs" />[m
       <window_info id="Version Control" active="false" anchor="bottom" auto_hide="false" internal_type="DOCKED" type="DOCKED" visible="false" weight="0.33" sideWeight="0.5" order="7" side_tool="false" content_ui="tabs" />[m
       <window_info id="Cvs" active="false" anchor="bottom" auto_hide="false" internal_type="DOCKED" type="DOCKED" visible="false" weight="0.25" sideWeight="0.5" order="4" side_tool="false" content_ui="tabs" />[m
       <window_info id="Message" active="false" anchor="bottom" auto_hide="false" internal_type="DOCKED" type="DOCKED" visible="false" weight="0.33" sideWeight="0.5" order="0" side_tool="false" content_ui="tabs" />[m
[31m-      <window_info id="Find" active="false" anchor="bottom" auto_hide="false" internal_type="DOCKED" type="DOCKED" visible="false" weight="0.33" sideWeight="0.5" order="1" side_tool="false" content_ui="tabs" />[m
       <window_info id="Ant Build" active="false" anchor="right" auto_hide="false" internal_type="DOCKED" type="DOCKED" visible="false" weight="0.25" sideWeight="0.5" order="1" side_tool="false" content_ui="tabs" />[m
[32m+[m[32m      <window_info id="Find" active="false" anchor="bottom" auto_hide="false" internal_type="DOCKED" type="DOCKED" visible="false" weight="0.33" sideWeight="0.5" order="1" side_tool="false" content_ui="tabs" />[m
       <window_info id="Debug" active="false" anchor="bottom" auto_hide="false" internal_type="DOCKED" type="DOCKED" visible="false" weight="0.4" sideWeight="0.5" order="3" side_tool="false" content_ui="tabs" />[m
       <window_info id="Commander" active="false" anchor="right" auto_hide="false" internal_type="SLIDING" type="SLIDING" visible="false" weight="0.4" sideWeight="0.5" order="0" side_tool="false" content_ui="tabs" />[m
[31m-      <window_info id="Run" active="false" anchor="bottom" auto_hide="false" internal_type="DOCKED" type="DOCKED" visible="false" weight="0.33" sideWeight="0.5" order="2" side_tool="false" content_ui="tabs" />[m
[31m-      <window_info id="Inspection" active="false" anchor="bottom" auto_hide="false" internal_type="DOCKED" type="DOCKED" visible="false" weight="0.4" sideWeight="0.5" order="5" side_tool="false" content_ui="tabs" />[m
       <window_info id="Hierarchy" active="false" anchor="right" auto_hide="false" internal_type="DOCKED" type="DOCKED" visible="false" weight="0.25" sideWeight="0.5" order="2" side_tool="false" content_ui="combo" />[m
[32m+[m[32m      <window_info id="Inspection" active="false" anchor="bottom" auto_hide="false" internal_type="DOCKED" type="DOCKED" visible="false" weight="0.4" sideWeight="0.5" order="5" side_tool="false" content_ui="tabs" />[m
[32m+[m[32m      <window_info id="Run" active="false" anchor="bottom" auto_hide="false" internal_type="DOCKED" type="DOCKED" visible="false" weight="0.33" sideWeight="0.5" order="2" side_tool="false" content_ui="tabs" />[m
     </layout>[m
     <layout-to-restore>[m
       <window_info id="Cvs" active="false" anchor="bottom" auto_hide="false" internal_type="DOCKED" type="DOCKED" visible="false" weight="0.25" sideWeight="0.5" order="4" side_tool="false" content_ui="tabs" />[m
[36m@@ -589,9 +458,9 @@[m
       <window_info id="Commander" active="false" anchor="right" auto_hide="false" internal_type="SLIDING" type="SLIDING" visible="false" weight="0.4" sideWeight="0.5" order="0" side_tool="false" content_ui="tabs" />[m
       <window_info id="Application Servers" active="false" anchor="bottom" auto_hide="false" internal_type="DOCKED" type="DOCKED" visible="false" weight="0.33" sideWeight="0.5" order="11" side_tool="false" content_ui="tabs" />[m
       <window_info id="Project" active="false" anchor="left" auto_hide="false" internal_type="DOCKED" type="DOCKED" visible="true" weight="0.31183368" sideWeight="0.5" order="0" side_tool="false" content_ui="combo" />[m
[31m-      <window_info id="Hierarchy" active="false" anchor="right" auto_hide="false" internal_type="DOCKED" type="DOCKED" visible="false" weight="0.25" sideWeight="0.5" order="2" side_tool="false" content_ui="combo" />[m
[31m-      <window_info id="Inspection" active="false" anchor="bottom" auto_hide="false" internal_type="DOCKED" type="DOCKED" visible="false" weight="0.4" sideWeight="0.5" order="5" side_tool="false" content_ui="tabs" />[m
       <window_info id="Run" active="false" anchor="bottom" auto_hide="false" internal_type="DOCKED" type="DOCKED" visible="false" weight="0.33" sideWeight="0.5" order="2" side_tool="false" content_ui="tabs" />[m
[32m+[m[32m      <window_info id="Inspection" active="false" anchor="bottom" auto_hide="false" internal_type="DOCKED" type="DOCKED" visible="false" weight="0.4" sideWeight="0.5" order="5" side_tool="false" content_ui="tabs" />[m
[32m+[m[32m      <window_info id="Hierarchy" active="false" anchor="right" auto_hide="false" internal_type="DOCKED" type="DOCKED" visible="false" weight="0.25" sideWeight="0.5" order="2" side_tool="false" content_ui="combo" />[m
     </layout-to-restore>[m
   </component>[m
   <component name="Vcs.Log.UiProperties">[m
[36m@@ -612,387 +481,444 @@[m
   </component>[m
   <component name="XDebuggerManager">[m
     <breakpoint-manager>[m
[31m-      <option name="time" value="30" />[m
[32m+[m[32m      <option name="time" value="27" />[m
     </breakpoint-manager>[m
     <watches-manager />[m
   </component>[m
   <component name="editorHistoryManager">[m
[31m-    <entry file="file://$PROJECT_DIR$/local/templates/zakrepi/components/bitrix/system.auth.forgotpasswd/.default/lang/ru/template.php">[m
[32m+[m[32m    <entry file="file://$PROJECT_DIR$/news/detail.php">[m
       <provider selected="true" editor-type-id="text-editor">[m
[31m-        <state vertical-scroll-proportion="0.018660812" vertical-offset="0" max-vertical-offset="911">[m
[31m-          <caret line="1" column="74" selection-start-line="1" selection-start-column="74" selection-end-line="1" selection-end-column="74" />[m
[32m+[m[32m        <state vertical-scroll-proportion="0.6454446" vertical-offset="143" max-vertical-offset="1054">[m
[32m+[m[32m          <caret line="43" column="39" selection-start-line="0" selection-start-column="0" selection-end-line="56" selection-end-column="2" />[m
         </state>[m
       </provider>[m
     </entry>[m
[31m-    <entry file="file://$PROJECT_DIR$/local/templates/zakrepi/components/bitrix/socserv.auth.form/soc-zakrepi-auth/template.php">[m
[32m+[m[32m    <entry file="file://$PROJECT_DIR$/local/components/zakrepi/banner.grid/component.php">[m
       <provider selected="true" editor-type-id="text-editor">[m
[31m-        <state vertical-scroll-proportion="0.5835189" vertical-offset="411" max-vertical-offset="1309">[m
[31m-          <caret line="55" column="29" selection-start-line="55" selection-start-column="29" selection-end-line="55" selection-end-column="29" />[m
[32m+[m[32m        <state vertical-scroll-proportion="0.24259056" vertical-offset="0" max-vertical-offset="2108">[m
[32m+[m[32m          <caret line="13" column="0" selection-start-line="13" selection-start-column="0" selection-end-line="14" selection-end-column="11" />[m
         </state>[m
       </provider>[m
     </entry>[m
[31m-    <entry file="file://$PROJECT_DIR$/local/templates/zakrepi/js/script.js">[m
[32m+[m[32m    <entry file="file://$PROJECT_DIR$/local/templates/zakrepi/components/bitrix/news.list/brand_home/template.php">[m
       <provider selected="true" editor-type-id="text-editor">[m
[31m-        <state vertical-scroll-proportion="1.7801495" vertical-offset="6339" max-vertical-offset="9061">[m
[31m-          <caret line="471" column="7" selection-start-line="471" selection-start-column="7" selection-end-line="471" selection-end-column="7" />[m
[32m+[m[32m        <state vertical-scroll-proportion="-14.384615" vertical-offset="0" max-vertical-offset="527">[m
[32m+[m[32m          <caret line="22" column="27" selection-start-line="22" selection-start-column="22" selection-end-line="22" selection-end-column="27" />[m
         </state>[m
       </provider>[m
     </entry>[m
[31m-    <entry file="file://$PROJECT_DIR$/local/templates/zakrepi/components/bitrix/system.auth.forgotpasswd/.default/template.php">[m
[32m+[m[32m    <entry file="file://$PROJECT_DIR$/brand/index.php">[m
       <provider selected="true" editor-type-id="text-editor">[m
[31m-        <state vertical-scroll-proportion="0.70911086" vertical-offset="0" max-vertical-offset="1394">[m
[31m-          <caret line="38" column="10" selection-start-line="38" selection-start-column="10" selection-end-line="38" selection-end-column="10" />[m
[32m+[m[32m        <state vertical-scroll-proportion="-2.6153846" vertical-offset="0" max-vertical-offset="221">[m
[32m+[m[32m          <caret line="4" column="0" selection-start-line="4" selection-start-column="0" selection-end-line="4" selection-end-column="0" />[m
         </state>[m
       </provider>[m
     </entry>[m
[31m-    <entry file="file://$PROJECT_DIR$/bitrix/components/bitrix/system.auth.form/templates/.default/template.php">[m
[32m+[m[32m    <entry file="file://$PROJECT_DIR$/brand/detail.php">[m
       <provider selected="true" editor-type-id="text-editor">[m
[31m-        <state vertical-scroll-proportion="0.41053787" vertical-offset="1428" max-vertical-offset="3060">[m
[31m-          <caret line="106" column="9" selection-start-line="106" selection-start-column="9" selection-end-line="106" selection-end-column="9" />[m
[32m+[m[32m        <state vertical-scroll-proportion="-1.6923077" vertical-offset="143" max-vertical-offset="1054">[m
[32m+[m[32m          <caret line="11" column="29" selection-start-line="11" selection-start-column="29" selection-end-line="11" selection-end-column="29" />[m
         </state>[m
       </provider>[m
     </entry>[m
[31m-    <entry file="file://$PROJECT_DIR$/local/templates/zakrepi/styles.css">[m
[32m+[m[32m    <entry file="file://$PROJECT_DIR$/index.php">[m
       <provider selected="true" editor-type-id="text-editor">[m
[31m-        <state vertical-scroll-proportion="0.0" vertical-offset="0" max-vertical-offset="937">[m
[31m-          <caret line="0" column="0" selection-start-line="0" selection-start-column="0" selection-end-line="0" selection-end-column="0" />[m
[32m+[m[32m        <state vertical-scroll-proportion="-10.846154" vertical-offset="1027" max-vertical-offset="2397">[m
[32m+[m[32m          <caret line="77" column="32" selection-start-line="77" selection-start-column="32" selection-end-line="77" selection-end-column="32" />[m
         </state>[m
       </provider>[m
     </entry>[m
[31m-    <entry file="file://$PROJECT_DIR$/includes/header/personal.php">[m
[32m+[m[32m    <entry file="file://$PROJECT_DIR$/includes/news/list.php">[m
       <provider selected="true" editor-type-id="text-editor">[m
[31m-        <state vertical-scroll-proportion="0.24259056" vertical-offset="0" max-vertical-offset="911">[m
[31m-          <caret line="13" column="0" selection-start-line="13" selection-start-column="0" selection-end-line="13" selection-end-column="0" />[m
[32m+[m[32m        <state vertical-scroll-proportion="-0.2316136" vertical-offset="211" max-vertical-offset="1122">[m
[32m+[m[32m          <caret line="0" column="0" selection-start-line="0" selection-start-column="0" selection-end-line="0" selection-end-column="88" />[m
         </state>[m
       </provider>[m
     </entry>[m
[31m-    <entry file="file://$PROJECT_DIR$/personal/auth.php">[m
[32m+[m[32m    <entry file="file://$PROJECT_DIR$/promo/index.php">[m
       <provider selected="true" editor-type-id="text-editor">[m
[31m-        <state vertical-scroll-proportion="0.09330406" vertical-offset="0" max-vertical-offset="911">[m
[31m-          <caret line="5" column="0" selection-start-line="5" selection-start-column="0" selection-end-line="5" selection-end-column="0" />[m
[32m+[m[32m        <state vertical-scroll-proportion="0.111964874" vertical-offset="0" max-vertical-offset="911">[m
[32m+[m[32m          <caret line="6" column="73" selection-start-line="6" selection-start-column="8" selection-end-line="6" selection-end-column="73" />[m
         </state>[m
       </provider>[m
     </entry>[m
[31m-    <entry file="file://$PROJECT_DIR$/personal/index.php">[m
[32m+[m[32m    <entry file="file://$PROJECT_DIR$/bitrix/components/bitrix/form.result.edit/templates/.default/template.php">[m
       <provider selected="true" editor-type-id="text-editor">[m
[31m-        <state vertical-scroll-proportion="0.0" vertical-offset="102" max-vertical-offset="493">[m
[31m-          <caret line="6" column="15" selection-start-line="6" selection-start-column="15" selection-end-line="6" selection-end-column="15" />[m
[32m+[m[32m        <state vertical-scroll-proportion="0.0" vertical-offset="0" max-vertical-offset="3145">[m
[32m+[m[32m          <caret line="0" column="0" selection-start-line="0" selection-start-column="0" selection-end-line="0" selection-end-column="0" />[m
         </state>[m
       </provider>[m
     </entry>[m
[31m-    <entry file="file://$PROJECT_DIR$/bitrix/components/bitrix/main.profile/templates/.default/template.php">[m
[32m+[m[32m    <entry file="file://$PROJECT_DIR$/bitrix/components/bitrix/form.result.edit/component.php">[m
       <provider selected="true" editor-type-id="text-editor">[m
[31m-        <state vertical-scroll-proportion="-5.230769" vertical-offset="0" max-vertical-offset="9231">[m
[31m-          <caret line="12" column="0" selection-start-line="12" selection-start-column="0" selection-end-line="16" selection-end-column="2" />[m
[32m+[m[32m        <state vertical-scroll-proportion="-0.7951002" vertical-offset="969" max-vertical-offset="15351">[m
[32m+[m[32m          <caret line="15" column="78" selection-start-line="15" selection-start-column="78" selection-end-line="15" selection-end-column="78" />[m
         </state>[m
       </provider>[m
     </entry>[m
[31m-    <entry file="file://$PROJECT_DIR$/includes/personal/address/list.php">[m
[32m+[m[32m    <entry file="file://$PROJECT_DIR$/local/modules/useraddress/install/db/mysql/install.sql">[m
       <provider selected="true" editor-type-id="text-editor">[m
[31m-        <state vertical-scroll-proportion="0.019428572" vertical-offset="0" max-vertical-offset="1241">[m
[31m-          <caret line="1" column="0" selection-start-line="1" selection-start-column="0" selection-end-line="3" selection-end-column="6" />[m
[32m+[m[32m        <state vertical-scroll-proportion="0.076662906" vertical-offset="0" max-vertical-offset="887">[m
[32m+[m[32m          <caret line="4" column="17" selection-start-line="4" selection-start-column="2" selection-end-line="4" selection-end-column="17" />[m
         </state>[m
       </provider>[m
     </entry>[m
[31m-    <entry file="file://$PROJECT_DIR$/personal/address/index.php">[m
[32m+[m[32m    <entry file="file://$PROJECT_DIR$/local/modules/useraddress/admin/user_address_add.php">[m
       <provider selected="true" editor-type-id="text-editor">[m
[31m-        <state vertical-scroll-proportion="0.42117116" vertical-offset="0" max-vertical-offset="969">[m
[31m-          <caret line="22" column="47" selection-start-line="22" selection-start-column="47" selection-end-line="22" selection-end-column="47" />[m
[32m+[m[32m        <state vertical-scroll-proportion="0.99121845" vertical-offset="593" max-vertical-offset="1734">[m
[32m+[m[32m          <caret line="89" column="65" selection-start-line="89" selection-start-column="55" selection-end-line="89" selection-end-column="65" />[m
         </state>[m
       </provider>[m
     </entry>[m
[31m-    <entry file="file://$PROJECT_DIR$/local/templates/zakrepi/components/bitrix/main.profile/profile-zakrepi-update/template.php">[m
[32m+[m[32m    <entry file="file://$PROJECT_DIR$/local/modules/useraddress/admin/user_address_edit.php">[m
       <provider selected="true" editor-type-id="text-editor">[m
[31m-        <state vertical-scroll-proportion="-0.22135706" vertical-offset="2732" max-vertical-offset="5899">[m
[31m-          <caret line="149" column="103" selection-start-line="149" selection-start-column="103" selection-end-line="149" selection-end-column="103" />[m
[32m+[m[32m        <state vertical-scroll-proportion="0.6057907" vertical-offset="0" max-vertical-offset="1734">[m
[32m+[m[32m          <caret line="33" column="76" selection-start-line="33" selection-start-column="69" selection-end-line="33" selection-end-column="76" />[m
         </state>[m
       </provider>[m
     </entry>[m
[31m-    <entry file="file://$PROJECT_DIR$/personal/address/update_address.php">[m
[32m+[m[32m    <entry file="file://$PROJECT_DIR$/personal/address/add_address.php">[m
       <provider selected="true" editor-type-id="text-editor">[m
[31m-        <state vertical-scroll-proportion="0.2647386" vertical-offset="0" max-vertical-offset="1513">[m
[31m-          <caret line="14" column="26" selection-start-line="14" selection-start-column="26" selection-end-line="14" selection-end-column="26" />[m
[32m+[m[32m        <state vertical-scroll-proportion="0.054884743" vertical-offset="273" max-vertical-offset="1207">[m
[32m+[m[32m          <caret line="19" column="98" selection-start-line="19" selection-start-column="98" selection-end-line="19" selection-end-column="98" />[m
         </state>[m
       </provider>[m
     </entry>[m
[31m-    <entry file="file://$PROJECT_DIR$/local/templates/zakrepi/components/bitrix/system.auth.form/zakrepi-auth/template.php">[m
[32m+[m[32m    <entry file="file://$PROJECT_DIR$/personal/address/update_address.php">[m
       <provider selected="true" editor-type-id="text-editor">[m
[31m-        <state vertical-scroll-proportion="0.79495615" vertical-offset="329" max-vertical-offset="1241">[m
[31m-          <caret line="62" column="22" selection-start-line="62" selection-start-column="22" selection-end-line="62" selection-end-column="22" />[m
[32m+[m[32m        <state vertical-scroll-proportion="-18.961538" vertical-offset="0" max-vertical-offset="1479">[m
[32m+[m[32m          <caret line="29" column="4" selection-start-line="29" selection-start-column="4" selection-end-line="29" selection-end-column="98" />[m
         </state>[m
       </provider>[m
     </entry>[m
[31m-    <entry file="file://$PROJECT_DIR$/personal/account/update_personal.php">[m
[32m+[m[32m    <entry file="file://$PROJECT_DIR$/local/templates/zakrepi/components/bitrix/news.list/news/template.php">[m
       <provider selected="true" editor-type-id="text-editor">[m
[31m-        <state vertical-scroll-proportion="0.18640351" vertical-offset="0" max-vertical-offset="912">[m
[31m-          <caret line="10" column="10" selection-start-line="10" selection-start-column="10" selection-end-line="10" selection-end-column="10" />[m
[32m+[m[32m        <state vertical-scroll-proportion="0.71603566" vertical-offset="207" max-vertical-offset="1105">[m
[32m+[m[32m          <caret line="50" column="66" selection-start-line="50" selection-start-column="66" selection-end-line="50" selection-end-column="66" />[m
         </state>[m
       </provider>[m
     </entry>[m
[31m-    <entry file="file://$PROJECT_DIR$/personal/account/index.php">[m
[32m+[m[32m    <entry file="file://$PROJECT_DIR$/bitrix/php_interface/dbconn.php">[m
       <provider selected="true" editor-type-id="text-editor">[m
[31m-        <state vertical-scroll-proportion="0.63377196" vertical-offset="408" max-vertical-offset="1700">[m
[31m-          <caret line="58" column="46" selection-start-line="58" selection-start-column="46" selection-end-line="58" selection-end-column="46" />[m
[32m+[m[32m        <state vertical-scroll-proportion="0.22392975" vertical-offset="0" max-vertical-offset="911">[m
[32m+[m[32m          <caret line="12" column="40" selection-start-line="3" selection-start-column="0" selection-end-line="12" selection-end-column="40" />[m
         </state>[m
       </provider>[m
     </entry>[m
[31m-    <entry file="file://$PROJECT_DIR$/local/modules/zakrepisettigs/lang/ru/options.php">[m
[32m+[m[32m    <entry file="file://$PROJECT_DIR$/local/modules/useraddress/admin/user_address_list.php">[m
       <provider selected="true" editor-type-id="text-editor">[m
[31m-        <state vertical-scroll-proportion="-4.576923" vertical-offset="0" max-vertical-offset="323">[m
[31m-          <caret line="7" column="56" selection-start-line="7" selection-start-column="56" selection-end-line="7" selection-end-column="56" />[m
[32m+[m[32m        <state vertical-scroll-proportion="0.35634744" vertical-offset="2128" max-vertical-offset="3026">[m
[32m+[m[32m          <caret line="145" column="25" selection-start-line="145" selection-start-column="25" selection-end-line="145" selection-end-column="25" />[m
         </state>[m
       </provider>[m
     </entry>[m
[31m-    <entry file="file://$PROJECT_DIR$/.top.menu.php">[m
[32m+[m[32m    <entry file="file://$PROJECT_DIR$/local/modules/useraddress/lib/function/component/function_component.php">[m
       <provider selected="true" editor-type-id="text-editor">[m
[31m-        <state vertical-scroll-proportion="0.1491228" vertical-offset="0" max-vertical-offset="912">[m
[31m-          <caret line="8" column="5" selection-start-line="8" selection-start-column="5" selection-end-line="8" selection-end-column="5" />[m
[32m+[m[32m        <state vertical-scroll-proportion="0.1679473" vertical-offset="0" max-vertical-offset="911">[m
[32m+[m[32m          <caret line="9" column="1" selection-start-line="9" selection-start-column="1" selection-end-line="9" selection-end-column="1" />[m
         </state>[m
       </provider>[m
     </entry>[m
[31m-    <entry file="file://$PROJECT_DIR$/index.php">[m
[32m+[m[32m    <entry file="file://$PROJECT_DIR$/local/modules/useraddress/lib/function/remove_address_user.php">[m
       <provider selected="true" editor-type-id="text-editor">[m
[31m-        <state vertical-scroll-proportion="0.055982437" vertical-offset="0" max-vertical-offset="2397">[m
[31m-          <caret line="3" column="2" selection-start-line="3" selection-start-column="2" selection-end-line="3" selection-end-column="2" />[m
[32m+[m[32m        <state vertical-scroll-proportion="0.0" vertical-offset="153" max-vertical-offset="1071">[m
[32m+[m[32m          <caret line="9" column="33" selection-start-line="9" selection-start-column="33" selection-end-line="9" selection-end-column="33" />[m
         </state>[m
       </provider>[m
     </entry>[m
[31m-    <entry file="file://$PROJECT_DIR$/local/modules/zakrepisettigs/options.php">[m
[32m+[m[32m    <entry file="file://$PROJECT_DIR$/local/modules/useraddress/classes/general/cUserAddress.php">[m
       <provider selected="true" editor-type-id="text-editor">[m
[31m-        <state vertical-scroll-proportion="0.37321624" vertical-offset="0" max-vertical-offset="1394">[m
[31m-          <caret line="20" column="21" selection-start-line="20" selection-start-column="11" selection-end-line="20" selection-end-column="21" />[m
[32m+[m[32m        <state vertical-scroll-proportion="0.701427" vertical-offset="1622" max-vertical-offset="2686">[m
[32m+[m[32m          <caret line="133" column="9" selection-start-line="133" selection-start-column="9" selection-end-line="133" selection-end-column="9" />[m
         </state>[m
       </provider>[m
     </entry>[m
[31m-    <entry file="file://$PROJECT_DIR$/local/modules/cityfranchise/include.php">[m
[32m+[m[32m    <entry file="file://$PROJECT_DIR$/bitrix/components/bitrix/menu/templates/tree/result_modifier.php">[m
       <provider selected="true" editor-type-id="text-editor">[m
         <state vertical-scroll-proportion="0.0" vertical-offset="0" max-vertical-offset="937">[m
           <caret line="0" column="0" selection-start-line="0" selection-start-column="0" selection-end-line="0" selection-end-column="0" />[m
         </state>[m
       </provider>[m
     </entry>[m
[31m-    <entry file="file://$PROJECT_DIR$/local/modules/cityfranchise/classes/cCityFranchise.php">[m
[32m+[m[32m    <entry file="file://$PROJECT_DIR$/bitrix/components/bitrix/menu/templates/tree/template.php">[m
       <provider selected="true" editor-type-id="text-editor">[m
         <state vertical-scroll-proportion="0.0" vertical-offset="0" max-vertical-offset="937">[m
           <caret line="0" column="0" selection-start-line="0" selection-start-column="0" selection-end-line="0" selection-end-column="0" />[m
         </state>[m
       </provider>[m
     </entry>[m
[31m-    <entry file="file://$PROJECT_DIR$/local/templates/zakrepi/scss/pages/_catalog.scss">[m
[32m+[m[32m    <entry file="file://$PROJECT_DIR$/.top.menu.php">[m
       <provider selected="true" editor-type-id="text-editor">[m
[31m-        <state vertical-scroll-proportion="0.0" vertical-offset="0" max-vertical-offset="937">[m
[31m-          <caret line="0" column="0" selection-start-line="0" selection-start-column="0" selection-end-line="0" selection-end-column="0" />[m
[31m-          <folding />[m
[32m+[m[32m        <state vertical-scroll-proportion="0.1492865" vertical-offset="0" max-vertical-offset="911">[m
[32m+[m[32m          <caret line="8" column="5" selection-start-line="8" selection-start-column="5" selection-end-line="8" selection-end-column="5" />[m
         </state>[m
       </provider>[m
     </entry>[m
[31m-    <entry file="file://$PROJECT_DIR$/local/templates/zakrepi/scss/template_styles.scss">[m
[32m+[m[32m    <entry file="file://$PROJECT_DIR$/bitrix/components/bitrix/menu/templates/horizontal_multilevel/template.php">[m
       <provider selected="true" editor-type-id="text-editor">[m
[31m-        <state vertical-scroll-proportion="0.0" vertical-offset="0" max-vertical-offset="937">[m
[31m-          <caret line="0" column="0" selection-start-line="0" selection-start-column="0" selection-end-line="0" selection-end-column="0" />[m
[32m+[m[32m        <state vertical-scroll-proportion="0.24610245" vertical-offset="0" max-vertical-offset="1037">[m
[32m+[m[32m          <caret line="13" column="34" selection-start-line="13" selection-start-column="34" selection-end-line="13" selection-end-column="34" />[m
         </state>[m
       </provider>[m
     </entry>[m
[31m-    <entry file="file://$PROJECT_DIR$/local/templates/zakrepi/scss/elements/_form.scss">[m
[32m+[m[32m    <entry file="file://$PROJECT_DIR$/personal/account/update_password.php">[m
       <provider selected="true" editor-type-id="text-editor">[m
[31m-        <state vertical-scroll-proportion="0.35455543" vertical-offset="0" max-vertical-offset="1785">[m
[31m-          <caret line="19" column="4" selection-start-line="19" selection-start-column="4" selection-end-line="19" selection-end-column="4" />[m
[32m+[m[32m        <state vertical-scroll-proportion="0.0" vertical-offset="136" max-vertical-offset="289">[m
[32m+[m[32m          <caret line="8" column="22" selection-start-line="8" selection-start-column="22" selection-end-line="8" selection-end-column="22" />[m
         </state>[m
       </provider>[m
     </entry>[m
     <entry file="file://$PROJECT_DIR$/local/templates/zakrepi/header.php">[m
       <provider selected="true" editor-type-id="text-editor">[m
[31m-        <state vertical-scroll-proportion="-24.192308" vertical-offset="2397" max-vertical-offset="3485">[m
[31m-          <caret line="178" column="55" selection-start-line="178" selection-start-column="55" selection-end-line="178" selection-end-column="55" />[m
[32m+[m[32m        <state vertical-scroll-proportion="0.0" vertical-offset="2383" max-vertical-offset="3298">[m
[32m+[m[32m          <caret line="155" column="35" selection-start-line="155" selection-start-column="35" selection-end-line="155" selection-end-column="35" />[m
         </state>[m
       </provider>[m
     </entry>[m
[31m-    <entry file="file://$PROJECT_DIR$/includes/news/list.php">[m
[32m+[m[32m    <entry file="file://$PROJECT_DIR$/.top.menu_ext.php">[m
       <provider selected="true" editor-type-id="text-editor">[m
[31m-        <state vertical-scroll-proportion="-0.0" vertical-offset="0" max-vertical-offset="1122">[m
[31m-          <caret line="0" column="0" selection-start-line="0" selection-start-column="0" selection-end-line="0" selection-end-column="88" />[m
[31m-          <folding />[m
[32m+[m[32m        <state vertical-scroll-proportion="0.0" vertical-offset="170" max-vertical-offset="527">[m
[32m+[m[32m          <caret line="10" column="64" selection-start-line="10" selection-start-column="64" selection-end-line="10" selection-end-column="64" />[m
         </state>[m
       </provider>[m
     </entry>[m
[31m-    <entry file="file://$PROJECT_DIR$/news/index.php">[m
[32m+[m[32m    <entry file="file://$PROJECT_DIR$/personal/account/index.php">[m
       <provider selected="true" editor-type-id="text-editor">[m
[31m-        <state vertical-scroll-proportion="0.0" vertical-offset="0" max-vertical-offset="937">[m
[31m-          <caret line="0" column="0" selection-start-line="0" selection-start-column="0" selection-end-line="0" selection-end-column="0" />[m
[32m+[m[32m        <state vertical-scroll-proportion="0.0" vertical-offset="408" max-vertical-offset="1666">[m
[32m+[m[32m          <caret line="52" column="33" selection-start-line="52" selection-start-column="33" selection-end-line="52" selection-end-column="33" />[m
         </state>[m
       </provider>[m
     </entry>[m
[31m-    <entry file="file://$PROJECT_DIR$/includes/promo/list.php">[m
[32m+[m[32m    <entry file="file://$PROJECT_DIR$/local/templates/zakrepi/components/bitrix/menu/top-menu/template.php">[m
       <provider selected="true" editor-type-id="text-editor">[m
[31m-        <state vertical-scroll-proportion="0.5894621" vertical-offset="211" max-vertical-offset="1122">[m
[31m-          <caret line="44" column="34" selection-start-line="44" selection-start-column="29" selection-end-line="44" selection-end-column="34" />[m
[32m+[m[32m        <state vertical-scroll-proportion="0.77607024" vertical-offset="7470" max-vertical-offset="8381">[m
[32m+[m[32m          <caret line="481" column="17" selection-start-line="481" selection-start-column="17" selection-end-line="481" selection-end-column="17" />[m
         </state>[m
       </provider>[m
     </entry>[m
[31m-    <entry file="file://$PROJECT_DIR$/news/detail.php">[m
[32m+[m[32m    <entry file="file://$PROJECT_DIR$/local/php_interface/init.php">[m
       <provider selected="true" editor-type-id="text-editor">[m
[31m-        <state vertical-scroll-proportion="0.18660812" vertical-offset="0" max-vertical-offset="1054">[m
[31m-          <caret line="10" column="43" selection-start-line="10" selection-start-column="26" selection-end-line="10" selection-end-column="43" />[m
[32m+[m[32m        <state vertical-scroll-proportion="0.18660812" vertical-offset="0" max-vertical-offset="911">[m
[32m+[m[32m          <caret line="10" column="22" selection-start-line="10" selection-start-column="22" selection-end-line="10" selection-end-column="22" />[m
         </state>[m
       </provider>[m
     </entry>[m
[31m-    <entry file="file://$PROJECT_DIR$/local/templates/zakrepi/components/zakrepi/catalog.element/catalog-element/style.css">[m
[32m+[m[32m    <entry file="file://$PROJECT_DIR$/personal/account/update_personal.php">[m
       <provider selected="true" editor-type-id="text-editor">[m
[31m-        <state vertical-scroll-proportion="0.0" vertical-offset="0" max-vertical-offset="16728">[m
[31m-          <caret line="0" column="0" selection-start-line="0" selection-start-column="0" selection-end-line="0" selection-end-column="0" />[m
[32m+[m[32m        <state vertical-scroll-proportion="-5.230769" vertical-offset="0" max-vertical-offset="289">[m
[32m+[m[32m          <caret line="8" column="19" selection-start-line="8" selection-start-column="19" selection-end-line="8" selection-end-column="19" />[m
[32m+[m[32m          <folding />[m
         </state>[m
       </provider>[m
     </entry>[m
[31m-    <entry file="file://$PROJECT_DIR$/local/templates/zakrepi/components/zakrepi/catalog.element/catalog-element/functions.php">[m
[32m+[m[32m    <entry file="file://$PROJECT_DIR$/local/php_interface/include/users.php">[m
       <provider selected="true" editor-type-id="text-editor">[m
[31m-        <state vertical-scroll-proportion="0.0" vertical-offset="0" max-vertical-offset="1836">[m
[31m-          <caret line="0" column="0" selection-start-line="0" selection-start-column="0" selection-end-line="0" selection-end-column="0" />[m
[32m+[m[32m        <state vertical-scroll-proportion="-11.115385" vertical-offset="0" max-vertical-offset="391">[m
[32m+[m[32m          <caret line="17" column="2" selection-start-line="17" selection-start-column="2" selection-end-line="17" selection-end-column="2" />[m
[32m+[m[32m          <folding />[m
         </state>[m
       </provider>[m
     </entry>[m
[31m-    <entry file="file://$PROJECT_DIR$/local/php_interface/include/settings.php">[m
[32m+[m[32m    <entry file="file://$PROJECT_DIR$/local/templates/zakrepi/js/script.js">[m
       <provider selected="true" editor-type-id="text-editor">[m
[31m-        <state vertical-scroll-proportion="0.42919868" vertical-offset="0" max-vertical-offset="911">[m
[31m-          <caret line="23" column="0" selection-start-line="23" selection-start-column="0" selection-end-line="23" selection-end-column="0" />[m
[32m+[m[32m        <state vertical-scroll-proportion="0.0" vertical-offset="7466" max-vertical-offset="9061">[m
[32m+[m[32m          <caret line="457" column="3" selection-start-line="457" selection-start-column="3" selection-end-line="471" selection-end-column="7" />[m
[32m+[m[32m          <folding>[m
[32m+[m[32m            <marker date="1446208946583" expanded="true" signature="-1:-1" placeholder="{...}" />[m
[32m+[m[32m            <marker date="1446208946583" expanded="true" signature="-1:-1" placeholder="{...}" />[m
[32m+[m[32m            <marker date="1446208946583" expanded="true" signature="-1:-1" placeholder="{...}" />[m
[32m+[m[32m            <marker date="1446208946583" expanded="true" signature="-1:-1" placeholder="{...}" />[m
[32m+[m[32m            <marker date="1446208946583" expanded="true" signature="-1:-1" placeholder="{...}" />[m
[32m+[m[32m            <marker date="1446208946583" expanded="true" signature="-1:-1" placeholder="{...}" />[m
[32m+[m[32m            <marker date="1446208946583" expanded="true" signature="-1:-1" placeholder="{...}" />[m
[32m+[m[32m            <marker date="1446208946583" expanded="true" signature="-1:-1" placeholder="{...}" />[m
[32m+[m[32m            <marker date="1446208946583" expanded="true" signature="-1:-1" placeholder="{...}" />[m
[32m+[m[32m            <marker date="1446208946583" expanded="true" signature="-1:-1" placeholder="//..." />[m
[32m+[m[32m            <marker date="1446208946583" expanded="true" signature="-1:-1" placeholder="{...}" />[m
[32m+[m[32m            <marker date="1446208946583" expanded="true" signature="-1:-1" placeholder="{...}" />[m
[32m+[m[32m            <marker date="1446208946583" expanded="true" signature="-1:-1" placeholder="{...}" />[m
[32m+[m[32m            <marker date="1446208946583" expanded="true" signature="-1:-1" placeholder="{...}" />[m
[32m+[m[32m            <marker date="1446208946583" expanded="true" signature="-1:-1" placeholder="{...}" />[m
[32m+[m[32m            <marker date="1446208946583" expanded="true" signature="-1:-1" placeholder="{...}" />[m
[32m+[m[32m            <marker date="1446208946583" expanded="true" signature="-1:-1" placeholder="//..." />[m
[32m+[m[32m            <marker date="1446208946583" expanded="true" signature="-1:-1" placeholder="{...}" />[m
[32m+[m[32m            <marker date="1446208946583" expanded="true" signature="-1:-1" placeholder="{...}" />[m
[32m+[m[32m            <marker date="1446208946583" expanded="true" signature="-1:-1" placeholder="{...}" />[m
[32m+[m[32m            <marker date="1446208946583" expanded="true" signature="-1:-1" placeholder="{...}" />[m
[32m+[m[32m            <marker date="1446208946583" expanded="true" signature="-1:-1" placeholder="{...}" />[m
[32m+[m[32m            <marker date="1446208946583" expanded="true" signature="-1:-1" placeholder="{...}" />[m
[32m+[m[32m            <marker date="1446208946583" expanded="true" signature="-1:-1" placeholder="{...}" />[m
[32m+[m[32m            <marker date="1446208946583" expanded="true" signature="-1:-1" placeholder="{...}" />[m
[32m+[m[32m            <marker date="1446208946583" expanded="true" signature="-1:-1" placeholder="{...}" />[m
[32m+[m[32m            <marker date="1446208946583" expanded="true" signature="-1:-1" placeholder="{...}" />[m
[32m+[m[32m            <marker date="1446208946583" expanded="true" signature="-1:-1" placeholder="{...}" />[m
[32m+[m[32m            <marker date="1446208946583" expanded="true" signature="-1:-1" placeholder="{...}" />[m
[32m+[m[32m            <marker date="1446208946583" expanded="true" signature="-1:-1" placeholder="{...}" />[m
[32m+[m[32m            <marker date="1446208946583" expanded="true" signature="-1:-1" placeholder="{...}" />[m
[32m+[m[32m            <marker date="1446208946583" expanded="true" signature="-1:-1" placeholder="{...}" />[m
[32m+[m[32m            <marker date="1446208946583" expanded="true" signature="-1:-1" placeholder="{...}" />[m
[32m+[m[32m            <marker date="1446208946583" expanded="true" signature="-1:-1" placeholder="{...}" />[m
[32m+[m[32m            <marker date="1446208946583" expanded="true" signature="-1:-1" placeholder="{...}" />[m
[32m+[m[32m            <marker date="1446208946583" expanded="true" signature="-1:-1" placeholder="{...}" />[m
[32m+[m[32m            <marker date="1446208946583" expanded="true" signature="-1:-1" placeholder="{...}" />[m
[32m+[m[32m            <marker date="1446208946583" expanded="true" signature="-1:-1" placeholder="{...}" />[m
[32m+[m[32m            <marker date="1446208946583" expanded="true" signature="-1:-1" placeholder="{...}" />[m
[32m+[m[32m            <marker date="1446208946583" expanded="true" signature="-1:-1" placeholder="{...}" />[m
[32m+[m[32m            <marker date="1446208946583" expanded="true" signature="-1:-1" placeholder="{...}" />[m
[32m+[m[32m            <marker date="1446208946583" expanded="true" signature="-1:-1" placeholder="{...}" />[m
[32m+[m[32m            <marker date="1446208946583" expanded="true" signature="-1:-1" placeholder="{...}" />[m
[32m+[m[32m            <marker date="1446208946583" expanded="true" signature="-1:-1" placeholder="{...}" />[m
[32m+[m[32m            <marker date="1446208946583" expanded="true" signature="-1:-1" placeholder="{...}" />[m
[32m+[m[32m            <marker date="1446208946583" expanded="true" signature="-1:-1" placeholder="{...}" />[m
[32m+[m[32m            <marker date="1446208946583" expanded="true" signature="-1:-1" placeholder="{...}" />[m
[32m+[m[32m            <marker date="1446208946583" expanded="true" signature="-1:-1" placeholder="{...}" />[m
[32m+[m[32m            <marker date="1446208946583" expanded="true" signature="-1:-1" placeholder="{...}" />[m
[32m+[m[32m            <marker date="1446208946583" expanded="true" signature="-1:-1" placeholder="{...}" />[m
[32m+[m[32m            <marker date="1446208946583" expanded="true" signature="-1:-1" placeholder="//..." />[m
[32m+[m[32m            <marker date="1446208946583" expanded="true" signature="-1:-1" placeholder="/*...*/" />[m
[32m+[m[32m          </folding>[m
         </state>[m
       </provider>[m
     </entry>[m
[31m-    <entry file="file://$PROJECT_DIR$/.top.menu_ext.php">[m
[32m+[m[32m    <entry file="file://$PROJECT_DIR$/local/templates/zakrepi/components/bitrix/news.list/news/result_modifier.php">[m
       <provider selected="true" editor-type-id="text-editor">[m
[31m-        <state vertical-scroll-proportion="0.0" vertical-offset="0" max-vertical-offset="911">[m
[31m-          <caret line="0" column="0" selection-start-line="0" selection-start-column="0" selection-end-line="0" selection-end-column="0" />[m
[32m+[m[32m        <state vertical-scroll-proportion="-0.0" vertical-offset="0" max-vertical-offset="357">[m
[32m+[m[32m          <caret line="0" column="0" selection-start-line="0" selection-start-column="0" selection-end-line="15" selection-end-column="2" />[m
           <folding />[m
         </state>[m
       </provider>[m
     </entry>[m
[31m-    <entry file="file://$PROJECT_DIR$/catalog/index.php">[m
[32m+[m[32m    <entry file="file://$PROJECT_DIR$/local/templates/zakrepi/js/svg-lib.js">[m
       <provider selected="true" editor-type-id="text-editor">[m
[31m-        <state vertical-scroll-proportion="-6.269231" vertical-offset="1146" max-vertical-offset="2057">[m
[31m-          <caret line="77" column="44" selection-start-line="77" selection-start-column="44" selection-end-line="77" selection-end-column="44" />[m
[32m+[m[32m        <state vertical-scroll-proportion="0.8896104" vertical-offset="164" max-vertical-offset="1088">[m
[32m+[m[32m          <caret line="58" column="13" selection-start-line="58" selection-start-column="13" selection-end-line="58" selection-end-column="13" />[m
           <folding />[m
         </state>[m
       </provider>[m
     </entry>[m
[31m-    <entry file="file://$PROJECT_DIR$/personal/registration.php">[m
[32m+[m[32m    <entry file="file://$PROJECT_DIR$/local/templates/zakrepi/components/bitrix/socserv.auth.form/soc-zakrepi-auth/component_epilog.php">[m
       <provider selected="true" editor-type-id="text-editor">[m
[31m-        <state vertical-scroll-proportion="0.5225027" vertical-offset="0" max-vertical-offset="918">[m
[31m-          <caret line="28" column="0" selection-start-line="28" selection-start-column="0" selection-end-line="29" selection-end-column="43" />[m
[32m+[m[32m        <state vertical-scroll-proportion="0.1679473" vertical-offset="0" max-vertical-offset="911">[m
[32m+[m[32m          <caret line="9" column="2" selection-start-line="9" selection-start-column="2" selection-end-line="9" selection-end-column="2" />[m
           <folding />[m
         </state>[m
       </provider>[m
     </entry>[m
[31m-    <entry file="file://$PROJECT_DIR$/local/templates/zakrepi/components/bitrix/main.register/registration/template.php">[m
[32m+[m[32m    <entry file="file://$PROJECT_DIR$/local/templates/zakrepi/template_styles.css">[m
       <provider selected="true" editor-type-id="text-editor">[m
[31m-        <state vertical-scroll-proportion="0.34075725" vertical-offset="2227" max-vertical-offset="6239">[m
[31m-          <caret line="154" column="67" selection-start-line="154" selection-start-column="67" selection-end-line="154" selection-end-column="67" />[m
[32m+[m[32m        <state vertical-scroll-proportion="0.9632035" vertical-offset="104969" max-vertical-offset="105978">[m
[32m+[m[32m          <caret line="6227" column="17" selection-start-line="6227" selection-start-column="17" selection-end-line="6227" selection-end-column="17" />[m
           <folding />[m
         </state>[m
       </provider>[m
     </entry>[m
[31m-    <entry file="file://$PROJECT_DIR$/local/components/zakrepi/catalog.compare.result/component.php">[m
[32m+[m[32m    <entry file="file://$PROJECT_DIR$/personal/index.php">[m
       <provider selected="true" editor-type-id="text-editor">[m
[31m-        <state vertical-scroll-proportion="0.33333334" vertical-offset="1053" max-vertical-offset="18394">[m
[31m-          <caret line="81" column="29" selection-start-line="81" selection-start-column="24" selection-end-line="81" selection-end-column="29" />[m
[32m+[m[32m        <state vertical-scroll-proportion="-5.8846154" vertical-offset="0" max-vertical-offset="493">[m
[32m+[m[32m          <caret line="9" column="42" selection-start-line="8" selection-start-column="4" selection-end-line="9" selection-end-column="42" />[m
           <folding />[m
         </state>[m
       </provider>[m
     </entry>[m
[31m-    <entry file="file://$PROJECT_DIR$/local/templates/zakrepi/components/zakrepi/catalog.element/catalog-element/component_epilog.php">[m
[32m+[m[32m    <entry file="file://$PROJECT_DIR$/local/templates/zakrepi/js/function.js">[m
       <provider selected="true" editor-type-id="text-editor">[m
[31m-        <state vertical-scroll-proportion="0.0" vertical-offset="0" max-vertical-offset="937">[m
[31m-          <caret line="0" column="0" selection-start-line="0" selection-start-column="0" selection-end-line="0" selection-end-column="0" />[m
[31m-          <folding />[m
[32m+[m[32m        <state vertical-scroll-proportion="0.0" vertical-offset="0" max-vertical-offset="3145">[m
[32m+[m[32m          <caret line="30" column="57" selection-start-line="30" selection-start-column="57" selection-end-line="30" selection-end-column="57" />[m
[32m+[m[32m          <folding>[m
[32m+[m[32m            <element signature="n#!!doc" expanded="true" />[m
[32m+[m[32m          </folding>[m
         </state>[m
       </provider>[m
     </entry>[m
[31m-    <entry file="file://$PROJECT_DIR$/local/components/zakrepi/catalog.element/ajax.php">[m
[32m+[m[32m    <entry file="file://$PROJECT_DIR$/urlrewrite.php">[m
       <provider selected="true" editor-type-id="text-editor">[m
[31m-        <state vertical-scroll-proportion="0.298573" vertical-offset="0" max-vertical-offset="969">[m
[31m-          <caret line="17" column="47" selection-start-line="17" selection-start-column="47" selection-end-line="17" selection-end-column="47" />[m
[32m+[m[32m        <state vertical-scroll-proportion="-22.884615" vertical-offset="0" max-vertical-offset="969">[m
[32m+[m[32m          <caret line="35" column="33" selection-start-line="35" selection-start-column="33" selection-end-line="35" selection-end-column="33" />[m
           <folding />[m
         </state>[m
       </provider>[m
     </entry>[m
[31m-    <entry file="file://$PROJECT_DIR$/local/components/zakrepi/catalog.element/component.php">[m
[32m+[m[32m    <entry file="file://$PROJECT_DIR$/local/templates/zakrepi/components/bitrix/main.register/registration/template.php">[m
       <provider selected="true" editor-type-id="text-editor">[m
[31m-        <state vertical-scroll-proportion="0.33295584" vertical-offset="3956" max-vertical-offset="21607">[m
[31m-          <caret line="254" column="28" selection-start-line="254" selection-start-column="23" selection-end-line="254" selection-end-column="28" />[m
[31m-          <folding />[m
[32m+[m[32m        <state vertical-scroll-proportion="-29.076923" vertical-offset="5177" max-vertical-offset="6052">[m
[32m+[m[32m          <caret line="349" column="13" selection-start-line="171" selection-start-column="4" selection-end-line="349" selection-end-column="13" />[m
[32m+[m[32m          <folding>[m
[32m+[m[32m            <element signature="e#3#100#0#PHP" expanded="true" />[m
[32m+[m[32m          </folding>[m
         </state>[m
       </provider>[m
     </entry>[m
[31m-    <entry file="file://$PROJECT_DIR$/cart/index.php">[m
[32m+[m[32m    <entry file="file://$PROJECT_DIR$/local/templates/zakrepi/components/bitrix/system.auth.form/zakrepi-auth/template.php">[m
       <provider selected="true" editor-type-id="text-editor">[m
[31m-        <state vertical-scroll-proportion="-0.65384614" vertical-offset="0" max-vertical-offset="153">[m
[31m-          <caret line="1" column="25" selection-start-line="1" selection-start-column="25" selection-end-line="1" selection-end-column="25" />[m
[32m+[m[32m        <state vertical-scroll-proportion="-15.111111" vertical-offset="0" max-vertical-offset="1224">[m
[32m+[m[32m          <caret line="48" column="41" selection-start-line="48" selection-start-column="41" selection-end-line="48" selection-end-column="41" />[m
           <folding />[m
         </state>[m
       </provider>[m
     </entry>[m
[31m-    <entry file="file://$PROJECT_DIR$/catalog/detail.php">[m
[32m+[m[32m    <entry file="file://$PROJECT_DIR$/local/templates/zakrepi/components/bitrix/system.auth.form/zakrepi-auth/lang/ru/template.php">[m
       <provider selected="true" editor-type-id="text-editor">[m
[31m-        <state vertical-scroll-proportion="-10.423077" vertical-offset="120" max-vertical-offset="1904">[m
[31m-          <caret line="23" column="25" selection-start-line="23" selection-start-column="13" selection-end-line="23" selection-end-column="25" />[m
[32m+[m[32m        <state vertical-scroll-proportion="0.019144144" vertical-offset="0" max-vertical-offset="888">[m
[32m+[m[32m          <caret line="1" column="24" selection-start-line="1" selection-start-column="7" selection-end-line="1" selection-end-column="24" />[m
           <folding />[m
         </state>[m
       </provider>[m
     </entry>[m
[31m-    <entry file="file://$PROJECT_DIR$/local/templates/zakrepi/js/function.js">[m
[32m+[m[32m    <entry file="file://$PROJECT_DIR$/personal/registration.php">[m
       <provider selected="true" editor-type-id="text-editor">[m
[31m-        <state vertical-scroll-proportion="0.0" vertical-offset="2157" max-vertical-offset="3094">[m
[31m-          <caret line="172" column="1" selection-start-line="172" selection-start-column="1" selection-end-line="172" selection-end-column="1" />[m
[32m+[m[32m        <state vertical-scroll-proportion="-20.76923" vertical-offset="4" max-vertical-offset="918">[m
[32m+[m[32m          <caret line="32" column="23" selection-start-line="32" selection-start-column="23" selection-end-line="32" selection-end-column="23" />[m
           <folding />[m
         </state>[m
       </provider>[m
     </entry>[m
[31m-    <entry file="file://$PROJECT_DIR$/local/templates/zakrepi/template_styles.css">[m
[32m+[m[32m    <entry file="file://$PROJECT_DIR$/local/templates/zakrepi/components/bitrix/socserv.auth.form/soc-zakrepi-auth/template.php">[m
       <provider selected="true" editor-type-id="text-editor">[m
[31m-        <state vertical-scroll-proportion="-10.035714" vertical-offset="55802" max-vertical-offset="114070">[m
[31m-          <caret line="3299" column="1" selection-start-line="3299" selection-start-column="1" selection-end-line="3299" selection-end-column="13" />[m
[31m-          <folding />[m
[32m+[m[32m        <state vertical-scroll-proportion="-20.153847" vertical-offset="411" max-vertical-offset="1309">[m
[32m+[m[32m          <caret line="55" column="29" selection-start-line="55" selection-start-column="29" selection-end-line="55" selection-end-column="29" />[m
[32m+[m[32m          <folding>[m
[32m+[m[32m            <element signature="e#453#473#0#HTML" expanded="true" />[m
[32m+[m[32m          </folding>[m
         </state>[m
       </provider>[m
     </entry>[m
[31m-    <entry file="file://$PROJECT_DIR$/local/templates/zakrepi/components/zakrepi/catalog.element/catalog-element/result_modifier.php">[m
[32m+[m[32m    <entry file="file://$PROJECT_DIR$/local/templates/zakrepi/components/bitrix/system.auth.forgotpasswd/.default/lang/ru/template.php">[m
       <provider selected="true" editor-type-id="text-editor">[m
[31m-        <state vertical-scroll-proportion="-11.5" vertical-offset="7249" max-vertical-offset="10302">[m
[31m-          <caret line="446" column="17" selection-start-line="446" selection-start-column="12" selection-end-line="446" selection-end-column="17" />[m
[32m+[m[32m        <state vertical-scroll-proportion="-0.65384614" vertical-offset="0" max-vertical-offset="238">[m
[32m+[m[32m          <caret line="1" column="74" selection-start-line="1" selection-start-column="74" selection-end-line="1" selection-end-column="74" />[m
           <folding />[m
         </state>[m
       </provider>[m
     </entry>[m
[31m-    <entry file="file://$PROJECT_DIR$/local/php_interface/include/function.php">[m
[32m+[m[32m    <entry file="file://$PROJECT_DIR$/personal/address/index.php">[m
       <provider selected="true" editor-type-id="text-editor">[m
[31m-        <state vertical-scroll-proportion="-20.26923" vertical-offset="0" max-vertical-offset="935">[m
[31m-          <caret line="31" column="19" selection-start-line="31" selection-start-column="19" selection-end-line="31" selection-end-column="19" />[m
[32m+[m[32m        <state vertical-scroll-proportion="-5.730769" vertical-offset="55" max-vertical-offset="969">[m
[32m+[m[32m          <caret line="12" column="24" selection-start-line="12" selection-start-column="17" selection-end-line="12" selection-end-column="24" />[m
           <folding />[m
         </state>[m
       </provider>[m
     </entry>[m
[31m-    <entry file="file://$PROJECT_DIR$/urlwrite_old.php">[m
[32m+[m[32m    <entry file="file://$PROJECT_DIR$/includes/personal/address/list.php">[m
       <provider selected="true" editor-type-id="text-editor">[m
[31m-        <state vertical-scroll-proportion="-33.73077" vertical-offset="177" max-vertical-offset="1156">[m
[31m-          <caret line="62" column="2" selection-start-line="62" selection-start-column="2" selection-end-line="62" selection-end-column="2" />[m
[32m+[m[32m        <state vertical-scroll-proportion="-0.65384614" vertical-offset="0" max-vertical-offset="1241">[m
[32m+[m[32m          <caret line="1" column="0" selection-start-line="1" selection-start-column="0" selection-end-line="3" selection-end-column="6" />[m
           <folding />[m
         </state>[m
       </provider>[m
     </entry>[m
[31m-    <entry file="file://$PROJECT_DIR$/urlrewrite.php">[m
[32m+[m[32m    <entry file="file://$PROJECT_DIR$/personal/auth.php">[m
       <provider selected="true" editor-type-id="text-editor">[m
[31m-        <state vertical-scroll-proportion="-8.884615" vertical-offset="245" max-vertical-offset="1156">[m
[31m-          <caret line="28" column="6" selection-start-line="28" selection-start-column="6" selection-end-line="28" selection-end-column="6" />[m
[32m+[m[32m        <state vertical-scroll-proportion="-3.9230769" vertical-offset="0" max-vertical-offset="204">[m
[32m+[m[32m          <caret line="6" column="60" selection-start-line="6" selection-start-column="60" selection-end-line="6" selection-end-column="60" />[m
           <folding />[m
         </state>[m
       </provider>[m
     </entry>[m
[31m-    <entry file="file://$PROJECT_DIR$/local/templates/zakrepi/components/zakrepi/catalog.element/catalog-element/template.php">[m
[32m+[m[32m    <entry file="file://$PROJECT_DIR$/local/templates/zakrepi/components/bitrix/system.auth.forgotpasswd/.default/template.php">[m
       <provider selected="true" editor-type-id="text-editor">[m
[31m-        <state vertical-scroll-proportion="9.494253" vertical-offset="4439" max-vertical-offset="27438">[m
[31m-          <caret line="747" column="0" selection-start-line="747" selection-start-column="0" selection-end-line="747" selection-end-column="0" />[m
[31m-          <folding>[m
[31m-            <element signature="n#style#0;n#a#0;n#div#0;n#div#0;n#div#0;n#div#0;n#div#1;n#div#0;n#div#0;n#div#2;n#div#1;n#div#2;n#div#0;n#!!top" expanded="true" />[m
[31m-            <element signature="n#style#0;n#div#0;n#div#1;n#div#1;n#div#1;n#div#2;n#!!top" expanded="true" />[m
[31m-          </folding>[m
[32m+[m[32m        <state vertical-scroll-proportion="0.24887387" vertical-offset="0" max-vertical-offset="1394">[m
[32m+[m[32m          <caret line="13" column="61" selection-start-line="13" selection-start-column="61" selection-end-line="13" selection-end-column="61" />[m
[32m+[m[32m          <folding />[m
         </state>[m
       </provider>[m
     </entry>[m
[1mdiff --git a/.top.menu_ext.php b/.top.menu_ext.php[m
[1mindex 9b93cd4..069415a 100644[m
[1m--- a/.top.menu_ext.php[m
[1m+++ b/.top.menu_ext.php[m
[36m@@ -10,7 +10,7 @@[m [m$aMenuLinksExt = $APPLICATION->IncludeComponent([m
         /*"SECTION_PAGE_URL" => "#SECTION_CODE#/",[m
         "DETAIL_PAGE_URL" => "#SECTION_CODE#/#ELEMENT_CODE#/",*/[m
         "IBLOCK_TYPE" => "information", /* тип инфоблока */[m
[31m-        "IBLOCK_ID" => 7, /* ID инфоблока */[m
[32m+[m[32m        "IBLOCK_ID" => "6", /* ID инфоблока */[m
         "DEPTH_LEVEL" => "4", /* уровень вложенности разделов */[m
         "CACHE_TYPE" => "A",[m
         "CACHE_TIME" => "36000000"[m
[1mdiff --git a/cart/index.php b/cart/index.php[m
[1mdeleted file mode 100644[m
[1mindex 9302878..0000000[m
[1m--- a/cart/index.php[m
[1m+++ /dev/null[m
[36m@@ -1,4 +0,0 @@[m
[31m-<?require($_SERVER["DOCUMENT_ROOT"]."/bitrix/header.php");?>[m
[31m-<?$APPLICATION->SetTitle("Корзина");?>[m
[31m-Корзина[m
[31m-<?require($_SERVER["DOCUMENT_ROOT"]."/bitrix/footer.php");?>[m
\ No newline at end of file[m
[1mdiff --git a/catalog/detail.php b/catalog/detail.php[m
[1mdeleted file mode 100644[m
[1mindex 2bec997..0000000[m
[1m--- a/catalog/detail.php[m
[1m+++ /dev/null[m
[36m@@ -1,107 +0,0 @@[m
[31m-<?require($_SERVER["DOCUMENT_ROOT"]."/bitrix/header.php");[m
[31m-$APPLICATION->SetTitle("");?>[m
[31m-    <div class="breadcrumbs">[m
[31m-        <a class="brdcmb-link" href="#">Главная</a> /[m
[31m-        <a class="brdcmb-link" href="#">Строительство и ремонт</a> /[m
[31m-        <a class="brdcmb-link" href="#">Инструменты</a> /[m
[31m-        <a class="brdcmb-link" href="#">Электроинструменты</a> /[m
[31m-        <a class="brdcmb-link" href="#">Гайковерты</a>[m
[31m-    </div>[m
[31m-<div class="workarea">[m
[31m-<?$APPLICATION->IncludeComponent([m
[31m-    "zakrepi:catalog.element",[m
[31m-    "catalog-element",[m
[31m-    Array([m
[31m-        "COMPONENT_TEMPLATE" => ".default",[m
[31m-        "IBLOCK_TYPE" => "",[m
[31m-        "IBLOCK_ID" => $arZSettings['CATALOG_ID'],[m
[31m-        "ELEMENT_ID" => "",[m
[31m-        "ELEMENT_CODE" => $_REQUEST["code"],[m
[31m-        "SECTION_ID" => $_REQUEST["SECTION_ID"],[m
[31m-        "SECTION_CODE" => "",[m
[31m-        "HIDE_NOT_AVAILABLE" => "N",[m
[31m-        "PROPERTY_CODE" =>  array([m
[31m-            "CML2_ARTICLE",[m
[31m-            "CML2_BASE_UNIT",[m
[31m-            "vote_count",[m
[31m-            "CML2_MANUFACTURER",[m
[31m-            "rating",[m
[31m-            "CML2_TRAITS",[m
[31m-            "CML2_TAXES",[m
[31m-            "vote_sum",[m
[31m-            "CML2_ATTRIBUTES",[m
[31m-            "CML2_BAR_CODE",[m
[31m-            ""),[m
[31m-        "OFFERS_LIMIT" => "0",[m
[31m-        "TEMPLATE_THEME" => "blue",[m
[31m-        "DISPLAY_NAME" => "Y",[m
[31m-        "DETAIL_PICTURE_MODE" => "IMG",[m
[31m-        "ADD_DETAIL_TO_SLIDER" => "N",[m
[31m-        "DISPLAY_PREVIEW_TEXT_MODE" => "E",[m
[31m-        "PRODUCT_SUBSCRIPTION" => "N",[m
[31m-        "SHOW_DISCOUNT_PERCENT" => "N",[m
[31m-        "SHOW_OLD_PRICE" => "N",[m
[31m-        "SHOW_MAX_QUANTITY" => "N",[m
[31m-        "SHOW_CLOSE_POPUP" => "N",[m
[31m-        "MESS_BTN_BUY" => "Купить",[m
[31m-        "MESS_BTN_ADD_TO_BASKET" => "В корзину",[m
[31m-        "MESS_BTN_SUBSCRIBE" => "Подписаться",[m
[31m-        "MESS_NOT_AVAILABLE" => "Нет в наличии",[m
[31m-[m
[31m-        /*rating*/[m
[31m-        "USE_VOTE_RATING" => "Y",[m
[31m-        /*comments*/[m
[31m-        "USE_COMMENTS" => "Y",[m
[31m-[m
[31m-        "BRAND_USE" => "Y",[m
[31m-        "SECTION_URL" => "",[m
[31m-        "DETAIL_URL" => "",[m
[31m-        "SECTION_ID_VARIABLE" => "SECTION_ID",[m
[31m-        "CHECK_SECTION_ID_VARIABLE" => "N",[m
[31m-        "SEF_MODE" => "N",[m
[31m-        "CACHE_TYPE" => "A",[m
[31m-        "CACHE_TIME" => "36000000",[m
[31m-        "CACHE_GROUPS" => "Y",[m
[31m-        "SET_TITLE" => "Y",[m
[31m-        "SET_CANONICAL_URL" => "N",[m
[31m-        "SET_BROWSER_TITLE" => "Y",[m
[31m-        "BROWSER_TITLE" => "-",[m
[31m-        "SET_META_KEYWORDS" => "Y",[m
[31m-        "META_KEYWORDS" => "-",[m
[31m-        "SET_META_DESCRIPTION" => "Y",[m
[31m-        "META_DESCRIPTION" => "-",[m
[31m-        "SET_LAST_MODIFIED" => "N",[m
[31m-        "USE_MAIN_ELEMENT_SECTION" => "N",[m
[31m-        "ADD_SECTIONS_CHAIN" => "Y",[m
[31m-        "ADD_ELEMENT_CHAIN" => "N",[m
[31m-        "USE_ELEMENT_COUNTER" => "Y",[m
[31m-        "SHOW_DEACTIVATED" => "N",[m
[31m-        "ACTION_VARIABLE" => "action",[m
[31m-        "PRODUCT_ID_VARIABLE" => "id",[m
[31m-        "DISPLAY_COMPARE" => "Y",[m
[31m-        "COMPARE_PATH" => "/compare/",[m
[31m-        "PRICE_CODE" => array(0 => "Розничная",),[m
[31m-        "USE_PRICE_COUNT" => "N",[m
[31m-        "SHOW_PRICE_COUNT" => "1",[m
[31m-        "PRICE_VAT_INCLUDE" => "Y",[m
[31m-        "PRICE_VAT_SHOW_VALUE" => "N",[m
[31m-        "CONVERT_CURRENCY" => "N",[m
[31m-        "BASKET_URL" => "/cart/index.php",[m
[31m-        "USE_PRODUCT_QUANTITY" => "N",[m
[31m-        "PRODUCT_QUANTITY_VARIABLE" => "",[m
[31m-        "ADD_PROPERTIES_TO_BASKET" => "Y",[m
[31m-        "PRODUCT_PROPS_VARIABLE" => "prop",[m
[31m-        "PARTIAL_PRODUCT_PROPERTIES" => "N",[m
[31m-        "PRODUCT_PROPERTIES" => array(),[m
[31m-        "ADD_TO_BASKET_ACTION" => array("ADD"),[m
[31m-        "LINK_IBLOCK_TYPE" => "",[m
[31m-        "LINK_IBLOCK_ID" => "",[m
[31m-        "LINK_PROPERTY_SID" => "",[m
[31m-        "LINK_ELEMENTS_URL" => "link.php?PARENT_ELEMENT_ID=#ELEMENT_ID#",[m
[31m-        "SET_STATUS_404" => "N",[m
[31m-        "SHOW_404" => "N",[m
[31m-        "MESSAGE_404" => ""[m
[31m-    )[m
[31m-);?>[m
[31m-</div> <!-- /.workarea -->[m
[31m-<?require($_SERVER["DOCUMENT_ROOT"]."/bitrix/footer.php");?>[m
\ No newline at end of file[m
[1mdiff --git a/catalog/index.php b/catalog/index.php[m
[1mindex 6e1af8a..80f553c 100644[m
[1m--- a/catalog/index.php[m
[1m+++ b/catalog/index.php[m
[36m@@ -6,9 +6,9 @@[m [m$APPLICATION->SetTitle("");?>[m
 	array([m
 		"COMPONENT_TEMPLATE" => ".default",[m
 		"IBLOCK_TYPE" => "1c_catalog",[m
[31m-		"IBLOCK_ID" => $arZSettings['CATALOG_ID'],[m
[31m-		"SECTION_ID" => "",//$_REQUEST["SECTION_ID"],[m
[31m-		"SECTION_CODE" => $_REQUEST["code"],[m
[32m+[m		[32m"IBLOCK_ID" => "5",[m
[32m+[m		[32m"SECTION_ID" => $_REQUEST["SECTION_ID"],[m
[32m+[m		[32m"SECTION_CODE" => "",[m
 		"SECTION_USER_FIELDS" => array([m
 			0 => "",[m
 			1 => "",[m
[36m@@ -70,7 +70,7 @@[m [m$APPLICATION->SetTitle("");?>[m
 		"SHOW_PRICE_COUNT" => "1",[m
 		"PRICE_VAT_INCLUDE" => "Y",[m
 		"CONVERT_CURRENCY" => "N",[m
[31m-		"BASKET_URL" => "/cart/index.php",[m
[32m+[m		[32m"BASKET_URL" => "/personal/basket.php",[m
 		"USE_PRODUCT_QUANTITY" => "N",[m
 		"PRODUCT_QUANTITY_VARIABLE" => "",[m
 		"ADD_PROPERTIES_TO_BASKET" => "Y",[m
[36m@@ -79,7 +79,7 @@[m [m$APPLICATION->SetTitle("");?>[m
 		"PRODUCT_PROPERTIES" => array([m
 		),[m
 		"ADD_TO_BASKET_ACTION" => "ADD",[m
[31m-		"PAGER_TEMPLATE" => "pagen",[m
[32m+[m		[32m"PAGER_TEMPLATE" => ".default",[m
 		"DISPLAY_TOP_PAGER" => "N",[m
 		"DISPLAY_BOTTOM_PAGER" => "Y",[m
 		"PAGER_TITLE" => "Товары",[m
[1mdiff --git a/includes/header/personal.php b/includes/header/personal.php[m
[1mdeleted file mode 100644[m
[1mindex 4db9a39..0000000[m
[1m--- a/includes/header/personal.php[m
[1m+++ /dev/null[m
[36m@@ -1,21 +0,0 @@[m
[31m-<?if($USER->IsAuthorized()):?>[m
[31m-<div class="auth-box loged-in col l3">[m
[31m-    <div class="col l2 right">[m
[31m-        <a class="auth-link login" id="lk-menu-link" href="/personal/"><svg class="icon"><use xlink:href="#profile"/></svg> Личный кабинет</a>[m
[31m-        <div class="lk-menu tooltip" data-box="#lk-menu-link" data-position="bottom-center">[m
[31m-            <div class="tooltip-tngl"></div>[m
[31m-            <ul class="menu tooltip-content">[m
[31m-                <li class="menu-item"><a href="/personal/orders/" class="menu-link">Мои заказы</a></li>[m
[31m-                <li class="menu-item"><a href="/personal/account/" class="menu-link">Личные данные</a></li>[m
[31m-                <li class="menu-item"><a href="?logout=yes" class="menu-link">Выйти</a></li>[m
[31m-            </ul>[m
[31m-        </div>[m
[31m-    </div>[m
[31m-</div>[m
[31m-<?else:?>[m
[31m-<div class="auth-box col l3">[m
[31m-    <a class="auth-link login" href="/personal/"><svg class="icon"><use xlink:href="#profile"/></svg> Вход</a>[m
[31m-    <a class="auth-link register" href="/personal/registration/">Регистрация</a>[m
[31m-</div>[m
[31m-<?endif;?>[m
[31m-[m
[1mdiff --git a/local/components/zakrepi/catalog.element/.description.php b/local/components/zakrepi/catalog.element/.description.php[m
[1mdeleted file mode 100644[m
[1mindex 21f4714..0000000[m
[1m--- a/local/components/zakrepi/catalog.element/.description.php[m
[1m+++ /dev/null[m
[36m@@ -1,20 +0,0 @@[m
[31m-<?[m
[31m-if (!defined("B_PROLOG_INCLUDED") || B_PROLOG_INCLUDED!==true) die();[m
[31m-[m
[31m-$arComponentDescription = array([m
[31m-	"NAME" => GetMessage("IBLOCK_ELEMENT_TEMPLATE_NAME"),[m
[31m-	"DESCRIPTION" => GetMessage("IBLOCK_ELEMENT_TEMPLATE_DESCRIPTION"),[m
[31m-	"ICON" => "/images/cat_detail.gif",[m
[31m-	"CACHE_PATH" => "Y",[m
[31m-	"SORT" => 40,[m
[31m-	"PATH" => array([m
[31m-		"ID" => "content",[m
[31m-		"CHILD" => array([m
[31m-			"ID" => "catalog",[m
[31m-			"NAME" => GetMessage("T_IBLOCK_DESC_CATALOG"),[m
[31m-			"SORT" => 30[m
[31m-		),[m
[31m-	),[m
[31m-);[m
[31m-[m
[31m-?>[m
\ No newline at end of file[m
[1mdiff --git a/local/components/zakrepi/catalog.element/.parameters.php b/local/components/zakrepi/catalog.element/.parameters.php[m
[1mdeleted file mode 100644[m
[1mindex d1db3e0..0000000[m
[1m--- a/local/components/zakrepi/catalog.element/.parameters.php[m
[1m+++ /dev/null[m
[36m@@ -1,620 +0,0 @@[m
[31m-<?[m
[31m-if (!defined("B_PROLOG_INCLUDED") || B_PROLOG_INCLUDED!==true) die();[m
[31m-/** @var array $arCurrentValues */[m
[31m-use Bitrix\Main\Loader;[m
[31m-use Bitrix\Iblock;[m
[31m-use Bitrix\Currency;[m
[31m-[m
[31m-if (!Loader::includeModule('iblock'))[m
[31m-	return;[m
[31m-$catalogIncluded = Loader::includeModule('catalog');[m
[31m-$iblockExists = (!empty($arCurrentValues['IBLOCK_ID']) && (int)$arCurrentValues['IBLOCK_ID'] > 0);[m
[31m-[m
[31m-$arIBlockType = CIBlockParameters::GetIBlockTypes();[m
[31m-[m
[31m-$arIBlock = array();[m
[31m-$iblockFilter = ([m
[31m-	!empty($arCurrentValues['IBLOCK_TYPE'])[m
[31m-	? array('TYPE' => $arCurrentValues['IBLOCK_TYPE'], 'ACTIVE' => 'Y')[m
[31m-	: array('ACTIVE' => 'Y')[m
[31m-);[m
[31m-$rsIBlock = CIBlock::GetList(array('SORT' => 'ASC'), $iblockFilter);[m
[31m-while ($arr = $rsIBlock->Fetch())[m
[31m-	$arIBlock[$arr['ID']] = '['.$arr['ID'].'] '.$arr['NAME'];[m
[31m-unset($arr, $rsIBlock, $iblockFilter);[m
[31m-[m
[31m-$arProperty = array();[m
[31m-$arProperty_LS = array();[m
[31m-$arProperty_N = array();[m
[31m-$arProperty_X = array();[m
[31m-if ($iblockExists)[m
[31m-{[m
[31m-	$propertyIterator = Iblock\PropertyTable::getList(array([m
[31m-		'select' => array('ID', 'IBLOCK_ID', 'NAME', 'CODE', 'PROPERTY_TYPE', 'MULTIPLE', 'LINK_IBLOCK_ID', 'USER_TYPE'),[m
[31m-		'filter' => array('=IBLOCK_ID' => $arCurrentValues['IBLOCK_ID'], '=ACTIVE' => 'Y'),[m
[31m-		'order' => array('SORT' => 'ASC', 'NAME' => 'ASC')[m
[31m-	));[m
[31m-	while ($property = $propertyIterator->fetch())[m
[31m-	{[m
[31m-		$propertyCode = (string)$property['CODE'];[m
[31m-		if ($propertyCode == '')[m
[31m-			$propertyCode = $property['ID'];[m
[31m-		$propertyName = '['.$propertyCode.'] '.$property['NAME'];[m
[31m-[m
[31m-		if ($property['PROPERTY_TYPE'] != Iblock\PropertyTable::TYPE_FILE)[m
[31m-		{[m
[31m-			$arProperty[$propertyCode] = $propertyName;[m
[31m-[m
[31m-			if ($property['MULTIPLE'] == 'Y')[m
[31m-				$arProperty_X[$propertyCode] = $propertyName;[m
[31m-			elseif ($property['PROPERTY_TYPE'] == Iblock\PropertyTable::TYPE_LIST)[m
[31m-				$arProperty_X[$propertyCode] = $propertyName;[m
[31m-			elseif ($property['PROPERTY_TYPE'] == Iblock\PropertyTable::TYPE_ELEMENT && (int)$property['LINK_IBLOCK_ID'] > 0)[m
[31m-				$arProperty_X[$propertyCode] = $propertyName;[m
[31m-		}[m
[31m-[m
[31m-		if ($property['PROPERTY_TYPE'] == Iblock\PropertyTable::TYPE_LIST || $property['PROPERTY_TYPE'] == Iblock\PropertyTable::TYPE_STRING)[m
[31m-			$arProperty_LS[$propertyCode] = $propertyName;[m
[31m-[m
[31m-		if ($property['PROPERTY_TYPE'] == Iblock\PropertyTable::TYPE_NUMBER)[m
[31m-			$arProperty_N[$propertyCode] = $propertyName;[m
[31m-	}[m
[31m-	unset($propertyCode, $propertyName, $property, $propertyIterator);[m
[31m-}[m
[31m-[m
[31m-$offers = false;[m
[31m-$arProperty_Offers = array();[m
[31m-$arProperty_OffersWithoutFile = array();[m
[31m-if ($catalogIncluded && $iblockExists)[m
[31m-{[m
[31m-	$offers = CCatalogSKU::GetInfoByProductIBlock($arCurrentValues['IBLOCK_ID']);[m
[31m-	if (!empty($offers))[m
[31m-	{[m
[31m-		$propertyIterator = Iblock\PropertyTable::getList(array([m
[31m-			'select' => array('ID', 'IBLOCK_ID', 'NAME', 'CODE', 'PROPERTY_TYPE', 'MULTIPLE', 'LINK_IBLOCK_ID', 'USER_TYPE'),[m
[31m-			'filter' => array('=IBLOCK_ID' => $offers['IBLOCK_ID'], '=ACTIVE' => 'Y', '!=ID' => $offers['SKU_PROPERTY_ID']),[m
[31m-			'order' => array('SORT' => 'ASC', 'NAME' => 'ASC')[m
[31m-		));[m
[31m-		while ($property = $propertyIterator->fetch())[m
[31m-		{[m
[31m-			$propertyCode = (string)$property['CODE'];[m
[31m-			if ($propertyCode == '')[m
[31m-				$propertyCode = $property['ID'];[m
[31m-			$propertyName = '['.$propertyCode.'] '.$property['NAME'];[m
[31m-[m
[31m-			$arProperty_Offers[$propertyCode] = $propertyName;[m
[31m-			if ($property['PROPERTY_TYPE'] != Iblock\PropertyTable::TYPE_FILE)[m
[31m-				$arProperty_OffersWithoutFile[$propertyCode] = $propertyName;[m
[31m-		}[m
[31m-		unset($propertyCode, $propertyName, $property, $propertyIterator);[m
[31m-	}[m
[31m-}[m
[31m-[m
[31m-$arSort = CIBlockParameters::GetElementSortFields([m
[31m-	array('SHOWS', 'SORT', 'TIMESTAMP_X', 'NAME', 'ID', 'ACTIVE_FROM', 'ACTIVE_TO'),[m
[31m-	array('KEY_LOWERCASE' => 'Y')[m
[31m-);[m
[31m-[m
[31m-$arPrice = array();[m
[31m-if ($catalogIncluded)[m
[31m-{[m
[31m-	$arSort = array_merge($arSort, CCatalogIBlockParameters::GetCatalogSortFields());[m
[31m-	$arPrice = CCatalogIBlockParameters::getPriceTypesList();[m
[31m-}[m
[31m-else[m
[31m-{[m
[31m-	$arPrice = $arProperty_N;[m
[31m-}[m
[31m-[m
[31m-$arIBlock_LINK = array();[m
[31m-$iblockFilter = ([m
[31m-	!empty($arCurrentValues['LINK_IBLOCK_TYPE'])[m
[31m-	? array('TYPE' => $arCurrentValues['LINK_IBLOCK_TYPE'], 'ACTIVE' => 'Y')[m
[31m-	: array('ACTIVE' => 'Y')[m
[31m-);[m
[31m-$rsIblock = CIBlock::GetList(array('SORT' => 'ASC'), $iblockFilter);[m
[31m-while ($arr = $rsIblock->Fetch())[m
[31m-	$arIBlock_LINK[$arr['ID']] = '['.$arr['ID'].'] '.$arr['NAME'];[m
[31m-unset($iblockFilter);[m
[31m-[m
[31m-$arProperty_LINK = array();[m
[31m-if (!empty($arCurrentValues['LINK_IBLOCK_ID']) && (int)$arCurrentValues['LINK_IBLOCK_ID'] > 0)[m
[31m-{[m
[31m-	$propertyIterator = Iblock\PropertyTable::getList(array([m
[31m-		'select' => array('ID', 'IBLOCK_ID', 'NAME', 'CODE', 'PROPERTY_TYPE', 'MULTIPLE', 'LINK_IBLOCK_ID', 'USER_TYPE'),[m
[31m-		'filter' => array('=IBLOCK_ID' => $arCurrentValues['LINK_IBLOCK_ID'], '=PROPERTY_TYPE' => Iblock\PropertyTable::TYPE_ELEMENT, '=ACTIVE' => 'Y'),[m
[31m-		'order' => array('SORT' => 'ASC', 'NAME' => 'ASC')[m
[31m-	));[m
[31m-	while ($property = $propertyIterator->fetch())[m
[31m-	{[m
[31m-		$propertyCode = (string)$property['CODE'];[m
[31m-		if ($propertyCode == '')[m
[31m-			$propertyCode = $property['ID'];[m
[31m-		$arProperty_LINK[$propertyCode] = '['.$propertyCode.'] '.$property['NAME'];[m
[31m-	}[m
[31m-	unset($propertyCode, $property, $propertyIterator);[m
[31m-}[m
[31m-[m
[31m-$arAscDesc = array([m
[31m-	"asc" => GetMessage("IBLOCK_SORT_ASC"),[m
[31m-	"desc" => GetMessage("IBLOCK_SORT_DESC"),[m
[31m-);[m
[31m-$arComponentParameters = array([m
[31m-	"GROUPS" => array([m
[31m-		"ACTION_SETTINGS" => array([m
[31m-			"NAME" => GetMessage('IBLOCK_ACTIONS')[m
[31m-		),[m
[31m-		"COMPARE" => array([m
[31m-			"NAME" => GetMessage("IBLOCK_COMPARE")[m
[31m-		),[m
[31m-		"PRICES" => array([m
[31m-			"NAME" => GetMessage("IBLOCK_PRICES"),[m
[31m-		),[m
[31m-		"BASKET" => array([m
[31m-			"NAME" => GetMessage("IBLOCK_BASKET"),[m
[31m-		),[m
[31m-		"LINK" => array([m
[31m-			"NAME" => GetMessage("IBLOCK_LINK"),[m
[31m-		)[m
[31m-	),[m
[31m-	"PARAMETERS" => array([m
[31m-		"SEF_MODE" => array(),[m
[31m-		"SEF_RULE" => array([m
[31m-			"VALUES" => array([m
[31m-				"SECTION_ID" => array([m
[31m-					"TEXT" => GetMessage("IBLOCK_SECTION_ID"),[m
[31m-					"TEMPLATE" => "#SECTION_ID#",[m
[31m-					"PARAMETER_LINK" => "SECTION_ID",[m
[31m-					"PARAMETER_VALUE" => '={$_REQUEST["SECTION_ID"]}',[m
[31m-				),[m
[31m-				"SECTION_CODE" => array([m
[31m-					"TEXT" => GetMessage("IBLOCK_SECTION_CODE"),[m
[31m-					"TEMPLATE" => "#SECTION_CODE#",[m
[31m-					"PARAMETER_LINK" => "SECTION_CODE",[m
[31m-					"PARAMETER_VALUE" => '={$_REQUEST["SECTION_CODE"]}',[m
[31m-				),[m
[31m-				"SECTION_CODE_PATH" => array([m
[31m-					"TEXT" => GetMessage("CP_BCE_SECTION_CODE_PATH"),[m
[31m-					"TEMPLATE" => "#SECTION_CODE_PATH#",[m
[31m-					"PARAMETER_LINK" => "SECTION_CODE_PATH",[m
[31m-					"PARAMETER_VALUE" => '={$_REQUEST["SECTION_CODE_PATH"]}',[m
[31m-				),[m
[31m-				"ELEMENT_ID" => array([m
[31m-					"TEXT" => GetMessage("IBLOCK_ELEMENT_ID"),[m
[31m-					"TEMPLATE" => "#ELEMENT_ID#",[m
[31m-					"PARAMETER_LINK" => "ELEMENT_ID",[m
[31m-					"PARAMETER_VALUE" => '={$_REQUEST["ELEMENT_ID"]}',[m
[31m-				),[m
[31m-				"ELEMENT_CODE" => array([m
[31m-					"TEXT" => GetMessage("IBLOCK_ELEMENT_CODE"),[m
[31m-					"TEMPLATE" => "#ELEMENT_CODE#",[m
[31m-					"PARAMETER_LINK" => "ELEMENT_CODE",[m
[31m-					"PARAMETER_VALUE" => '={$_REQUEST["ELEMENT_CODE"]}',[m
[31m-				),[m
[31m-			),[m
[31m-		),[m
[31m-		"IBLOCK_TYPE" => array([m
[31m-			"PARENT" => "BASE",[m
[31m-			"NAME" => GetMessage("IBLOCK_TYPE"),[m
[31m-			"TYPE" => "LIST",[m
[31m-			"VALUES" => $arIBlockType,[m
[31m-			"REFRESH" => "Y",[m
[31m-		),[m
[31m-		"IBLOCK_ID" => array([m
[31m-			"PARENT" => "BASE",[m
[31m-			"NAME" => GetMessage("IBLOCK_IBLOCK"),[m
[31m-			"TYPE" => "LIST",[m
[31m-			"ADDITIONAL_VALUES" => "Y",[m
[31m-			"VALUES" => $arIBlock,[m
[31m-			"REFRESH" => "Y",[m
[31m-		),[m
[31m-		"ELEMENT_ID" => array([m
[31m-			"PARENT" => "BASE",[m
[31m-			"NAME" => GetMessage("IBLOCK_ELEMENT_ID"),[m
[31m-			"TYPE" => "STRING",[m
[31m-			"DEFAULT" => '={$_REQUEST["ELEMENT_ID"]}',[m
[31m-		),[m
[31m-		"ELEMENT_CODE" => array([m
[31m-			"PARENT" => "BASE",[m
[31m-			"NAME" => GetMessage("IBLOCK_ELEMENT_CODE"),[m
[31m-			"TYPE" => "STRING",[m
[31m-			"DEFAULT" => '',[m
[31m-		),[m
[31m-		"SECTION_ID" => array([m
[31m-			"PARENT" => "BASE",[m
[31m-			"NAME" => GetMessage("IBLOCK_SECTION_ID"),[m
[31m-			"TYPE" => "STRING",[m
[31m-			"DEFAULT" => '={$_REQUEST["SECTION_ID"]}',[m
[31m-		),[m
[31m-		"SECTION_CODE" => array([m
[31m-			"PARENT" => "BASE",[m
[31m-			"NAME" => GetMessage("IBLOCK_SECTION_CODE"),[m
[31m-			"TYPE" => "STRING",[m
[31m-			"DEFAULT" => '',[m
[31m-		),[m
[31m-		"SECTION_URL" => CIBlockParameters::GetPathTemplateParam([m
[31m-			"SECTION",[m
[31m-			"SECTION_URL",[m
[31m-			GetMessage("IBLOCK_SECTION_URL"),[m
[31m-			"",[m
[31m-			"URL_TEMPLATES"[m
[31m-		),[m
[31m-		"DETAIL_URL" => CIBlockParameters::GetPathTemplateParam([m
[31m-			"DETAIL",[m
[31m-			"DETAIL_URL",[m
[31m-			GetMessage("IBLOCK_DETAIL_URL"),[m
[31m-			"",[m
[31m-			"URL_TEMPLATES"[m
[31m-		),[m
[31m-		"SECTION_ID_VARIABLE" => array([m
[31m-			"PARENT" => "URL_TEMPLATES",[m
[31m-			"NAME" => GetMessage("IBLOCK_SECTION_ID_VARIABLE"),[m
[31m-			"TYPE" => "STRING",[m
[31m-			"DEFAULT" => "SECTION_ID",[m
[31m-		),[m
[31m-		"CHECK_SECTION_ID_VARIABLE" => array([m
[31m-			"PARENT" => "URL_TEMPLATES",[m
[31m-			"NAME" => GetMessage("CP_BCE_CHECK_SECTION_ID_VARIABLE"),[m
[31m-			"TYPE" => "CHECKBOX",[m
[31m-			"DEFAULT" => "N"[m
[31m-		),[m
[31m-		"SET_TITLE" => array(),[m
[31m-		"SET_CANONICAL_URL" => array([m
[31m-			"PARENT" => "ADDITIONAL_SETTINGS",[m
[31m-			"NAME" => GetMessage("CP_BCE_SET_CANONICAL_URL"),[m
[31m-			"TYPE" => "CHECKBOX",[m
[31m-			"DEFAULT" => "N",[m
[31m-		),[m
[31m-		"SET_BROWSER_TITLE" => array([m
[31m-			"PARENT" => "ADDITIONAL_SETTINGS",[m
[31m-			"NAME" => GetMessage("CP_BCE_SET_BROWSER_TITLE"),[m
[31m-			"TYPE" => "CHECKBOX",[m
[31m-			"DEFAULT" => "Y",[m
[31m-			"REFRESH" => "Y"[m
[31m-		),[m
[31m-		"BROWSER_TITLE" => array([m
[31m-			"PARENT" => "ADDITIONAL_SETTINGS",[m
[31m-			"NAME" => GetMessage("CP_BCE_BROWSER_TITLE"),[m
[31m-			"TYPE" => "LIST",[m
[31m-			"MULTIPLE" => "N",[m
[31m-			"DEFAULT" => "-",[m
[31m-			"VALUES" => array_merge(array("-"=>" ", "NAME" => GetMessage("IBLOCK_FIELD_NAME")), $arProperty_LS),[m
[31m-			"HIDDEN" => (isset($arCurrentValues['SET_BROWSER_TITLE']) && $arCurrentValues['SET_BROWSER_TITLE'] == 'N' ? 'Y' : 'N')[m
[31m-		),[m
[31m-		"SET_META_KEYWORDS" => array([m
[31m-			"PARENT" => "ADDITIONAL_SETTINGS",[m
[31m-			"NAME" => GetMessage("CP_BCE_SET_META_KEYWORDS"),[m
[31m-			"TYPE" => "CHECKBOX",[m
[31m-			"DEFAULT" => "Y",[m
[31m-			"REFRESH" => "Y",[m
[31m-		),[m
[31m-		"META_KEYWORDS" =>array([m
[31m-			"PARENT" => "ADDITIONAL_SETTINGS",[m
[31m-			"NAME" => GetMessage("T_IBLOCK_DESC_KEYWORDS"),[m
[31m-			"TYPE" => "LIST",[m
[31m-			"MULTIPLE" => "N",[m
[31m-			"DEFAULT" => "-",[m
[31m-			"VALUES" => array_merge(array("-"=>" "),$arProperty_LS),[m
[31m-			"HIDDEN" => (isset($arCurrentValues['SET_META_KEYWORDS']) && $arCurrentValues['SET_META_KEYWORDS'] == 'N' ? 'Y' : 'N')[m
[31m-		),[m
[31m-		"SET_META_DESCRIPTION" => array([m
[31m-			"PARENT" => "ADDITIONAL_SETTINGS",[m
[31m-			"NAME" => GetMessage("CP_BCE_SET_META_DESCRIPTION"),[m
[31m-			"TYPE" => "CHECKBOX",[m
[31m-			"DEFAULT" => "Y",[m
[31m-			"REFRESH" => "Y"[m
[31m-		),[m
[31m-		"META_DESCRIPTION" =>array([m
[31m-			"PARENT" => "ADDITIONAL_SETTINGS",[m
[31m-			"NAME" => GetMessage("T_IBLOCK_DESC_DESCRIPTION"),[m
[31m-			"TYPE" => "LIST",[m
[31m-			"MULTIPLE" => "N",[m
[31m-			"DEFAULT" => "-",[m
[31m-			"VALUES" => array_merge(array("-"=>" "),$arProperty_LS),[m
[31m-			"HIDDEN" => (isset($arCurrentValues['SET_META_DESCRIPTION']) && $arCurrentValues['SET_META_DESCRIPTION'] == 'N' ? 'Y' : 'N')[m
[31m-		),[m
[31m-		"SET_LAST_MODIFIED" => array([m
[31m-			"PARENT" => "ADDITIONAL_SETTINGS",[m
[31m-			"NAME" => GetMessage("CP_BCE_SET_LAST_MODIFIED"),[m
[31m-			"TYPE" => "CHECKBOX",[m
[31m-			"DEFAULT" => "N",[m
[31m-		),[m
[31m-		"USE_MAIN_ELEMENT_SECTION" => array([m
[31m-			"PARENT" => "ADDITIONAL_SETTINGS",[m
[31m-			"NAME" => GetMessage("CP_BCE_USE_MAIN_ELEMENT_SECTION"),[m
[31m-			"TYPE" => "CHECKBOX",[m
[31m-			"DEFAULT" => "N",[m
[31m-		),[m
[31m-		"ADD_SECTIONS_CHAIN" => array([m
[31m-			"PARENT" => "ADDITIONAL_SETTINGS",[m
[31m-			"NAME" => GetMessage("CP_BCE_ADD_SECTIONS_CHAIN"),[m
[31m-			"TYPE" => "CHECKBOX",[m
[31m-			"DEFAULT" => "Y",[m
[31m-		),[m
[31m-		"ADD_ELEMENT_CHAIN" => array([m
[31m-			"PARENT" => "ADDITIONAL_SETTINGS",[m
[31m-			"NAME" => GetMessage("CP_BCE_ADD_ELEMENT_CHAIN"),[m
[31m-			"TYPE" => "CHECKBOX",[m
[31m-			"DEFAULT" => "N"[m
[31m-		),[m
[31m-		"PROPERTY_CODE" => array([m
[31m-			"PARENT" => "VISUAL",[m
[31m-			"NAME" => GetMessage("IBLOCK_PROPERTY"),[m
[31m-			"TYPE" => "LIST",[m
[31m-			"MULTIPLE" => "Y",[m
[31m-			"VALUES" => $arProperty,[m
[31m-			"SIZE" => (count($arProperty) > 5 ? 8 : 3),[m
[31m-			"ADDITIONAL_VALUES" => "Y",[m
[31m-		),[m
[31m-		"OFFERS_FIELD_CODE" => CIBlockParameters::GetFieldCode(GetMessage("CP_BCE_OFFERS_FIELD_CODE"), "VISUAL"),[m
[31m-		"OFFERS_PROPERTY_CODE" => array([m
[31m-			"PARENT" => "VISUAL",[m
[31m-			"NAME" => GetMessage("CP_BCE_OFFERS_PROPERTY_CODE"),[m
[31m-			"TYPE" => "LIST",[m
[31m-			"MULTIPLE" => "Y",[m
[31m-			"VALUES" => $arProperty_Offers,[m
[31m-			"SIZE" => (count($arProperty_Offers) > 5 ? 8 : 3),[m
[31m-			"ADDITIONAL_VALUES" => "Y",[m
[31m-		),[m
[31m-		"OFFERS_SORT_FIELD" => array([m
[31m-			"PARENT" => "VISUAL",[m
[31m-			"NAME" => GetMessage("CP_BCE_OFFERS_SORT_FIELD"),[m
[31m-			"TYPE" => "LIST",[m
[31m-			"VALUES" => $arSort,[m
[31m-			"ADDITIONAL_VALUES" => "Y",[m
[31m-			"DEFAULT" => "sort",[m
[31m-		),[m
[31m-		"OFFERS_SORT_ORDER" => array([m
[31m-			"PARENT" => "VISUAL",[m
[31m-			"NAME" => GetMessage("CP_BCE_OFFERS_SORT_ORDER"),[m
[31m-			"TYPE" => "LIST",[m
[31m-			"VALUES" => $arAscDesc,[m
[31m-			"DEFAULT" => "asc",[m
[31m-			"ADDITIONAL_VALUES" => "Y",[m
[31m-		),[m
[31m-		"OFFERS_SORT_FIELD2" => array([m
[31m-			"PARENT" => "VISUAL",[m
[31m-			"NAME" => GetMessage("CP_BCE_OFFERS_SORT_FIELD2"),[m
[31m-			"TYPE" => "LIST",[m
[31m-			"VALUES" => $arSort,[m
[31m-			"ADDITIONAL_VALUES" => "Y",[m
[31m-			"DEFAULT" => "id",[m
[31m-		),[m
[31m-		"OFFERS_SORT_ORDER2" => array([m
[31m-			"PARENT" => "VISUAL",[m
[31m-			"NAME" => GetMessage("CP_BCE_OFFERS_SORT_ORDER2"),[m
[31m-			"TYPE" => "LIST",[m
[31m-			"VALUES" => $arAscDesc,[m
[31m-			"DEFAULT" => "desc",[m
[31m-			"ADDITIONAL_VALUES" => "Y",[m
[31m-		),[m
[31m-		"OFFERS_LIMIT" => array([m
[31m-			"PARENT" => "VISUAL",[m
[31m-			"NAME" => GetMessage('CP_BCE_OFFERS_LIMIT'),[m
[31m-			"TYPE" => "STRING",[m
[31m-			"DEFAULT" => 0,[m
[31m-		),[m
[31m-		"PRICE_CODE" => array([m
[31m-			"PARENT" => "PRICES",[m
[31m-			"NAME" => GetMessage("IBLOCK_PRICE_CODE"),[m
[31m-			"TYPE" => "LIST",[m
[31m-			"MULTIPLE" => "Y",[m
[31m-			"SIZE" => (count($arPrice) > 5 ? 8 : 3),[m
[31m-			"VALUES" => $arPrice,[m
[31m-		),[m
[31m-		"USE_PRICE_COUNT" => array([m
[31m-			"PARENT" => "PRICES",[m
[31m-			"NAME" => GetMessage("IBLOCK_USE_PRICE_COUNT"),[m
[31m-			"TYPE" => "CHECKBOX",[m
[31m-			"DEFAULT" => "N",[m
[31m-			),[m
[31m-		"SHOW_PRICE_COUNT" => array([m
[31m-			"PARENT" => "PRICES",[m
[31m-			"NAME" => GetMessage("IBLOCK_SHOW_PRICE_COUNT"),[m
[31m-			"TYPE" => "STRING",[m
[31m-			"DEFAULT" => "1",[m
[31m-		),[m
[31m-		"PRICE_VAT_INCLUDE" => array([m
[31m-			"PARENT" => "PRICES",[m
[31m-			"NAME" => GetMessage("IBLOCK_VAT_INCLUDE"),[m
[31m-			"TYPE" => "CHECKBOX",[m
[31m-			"DEFAULT" => "Y",[m
[31m-		),[m
[31m-		"PRICE_VAT_SHOW_VALUE" => array([m
[31m-			"PARENT" => "PRICES",[m
[31m-			"NAME" => GetMessage("IBLOCK_VAT_SHOW_VALUE"),[m
[31m-			"TYPE" => "CHECKBOX",[m
[31m-			"DEFAULT" => "N",[m
[31m-		),[m
[31m-		"BASKET_URL" => array([m
[31m-			"PARENT" => "BASKET",[m
[31m-			"NAME" => GetMessage("IBLOCK_BASKET_URL"),[m
[31m-			"TYPE" => "STRING",[m
[31m-			"DEFAULT" => "/personal/basket.php",[m
[31m-		),[m
[31m-		"ACTION_VARIABLE" => array([m
[31m-			"PARENT" => "ACTION_SETTINGS",[m
[31m-			"NAME" => GetMessage("IBLOCK_ACTION_VARIABLE"),[m
[31m-			"TYPE" => "STRING",[m
[31m-			"DEFAULT" => "action",[m
[31m-		),[m
[31m-		"PRODUCT_ID_VARIABLE" => array([m
[31m-			"PARENT" => "ACTION_SETTINGS",[m
[31m-			"NAME" => GetMessage("IBLOCK_PRODUCT_ID_VARIABLE"),[m
[31m-			"TYPE" => "STRING",[m
[31m-			"DEFAULT" => "id",[m
[31m-		),[m
[31m-		"USE_PRODUCT_QUANTITY" => array([m
[31m-			"PARENT" => "BASKET",[m
[31m-			"NAME" => GetMessage("CP_BCE_USE_PRODUCT_QUANTITY"),[m
[31m-			"TYPE" => "CHECKBOX",[m
[31m-			"DEFAULT" => "N",[m
[31m-			"REFRESH" => "Y",[m
[31m-		),[m
[31m-		"PRODUCT_QUANTITY_VARIABLE" => array([m
[31m-			"PARENT" => "BASKET",[m
[31m-			"NAME" => GetMessage("CP_BCE_PRODUCT_QUANTITY_VARIABLE"),[m
[31m-			"TYPE" => "STRING",[m
[31m-			"DEFAULT" => "quantity",[m
[31m-			"HIDDEN" => (isset($arCurrentValues['USE_PRODUCT_QUANTITY']) && $arCurrentValues['USE_PRODUCT_QUANTITY'] == 'Y' ? 'N' : 'Y')[m
[31m-		),[m
[31m-		"ADD_PROPERTIES_TO_BASKET" => array([m
[31m-			"PARENT" => "BASKET",[m
[31m-			"NAME" => GetMessage("CP_BCE_ADD_PROPERTIES_TO_BASKET"),[m
[31m-			"TYPE" => "CHECKBOX",[m
[31m-			"DEFAULT" => "Y",[m
[31m-			"REFRESH" => "Y"[m
[31m-		),[m
[31m-		"PRODUCT_PROPS_VARIABLE" => array([m
[31m-			"PARENT" => "BASKET",[m
[31m-			"NAME" => GetMessage("CP_BCE_PRODUCT_PROPS_VARIABLE"),[m
[31m-			"TYPE" => "STRING",[m
[31m-			"DEFAULT" => "prop",[m
[31m-			"HIDDEN" => (isset($arCurrentValues['ADD_PROPERTIES_TO_BASKET']) && $arCurrentValues['ADD_PROPERTIES_TO_BASKET'] == 'N' ? 'Y' : 'N')[m
[31m-		),[m
[31m-		"PARTIAL_PRODUCT_PROPERTIES" => array([m
[31m-			"PARENT" => "BASKET",[m
[31m-			"NAME" => GetMessage("CP_BCE_PARTIAL_PRODUCT_PROPERTIES"),[m
[31m-			"TYPE" => "CHECKBOX",[m
[31m-			"DEFAULT" => "N",[m
[31m-			"HIDDEN" => (isset($arCurrentValues['ADD_PROPERTIES_TO_BASKET']) && $arCurrentValues['ADD_PROPERTIES_TO_BASKET'] == 'N' ? 'Y' : 'N')[m
[31m-		),[m
[31m-		"PRODUCT_PROPERTIES" => array([m
[31m-			"PARENT" => "BASKET",[m
[31m-			"NAME" => GetMessage("CP_BCE_PRODUCT_PROPERTIES"),[m
[31m-			"TYPE" => "LIST",[m
[31m-			"MULTIPLE" => "Y",[m
[31m-			"VALUES" => $arProperty_X,[m
[31m-			"SIZE" => (count($arProperty_X) > 5 ? 8 : 3),[m
[31m-			"HIDDEN" => (isset($arCurrentValues['ADD_PROPERTIES_TO_BASKET']) && $arCurrentValues['ADD_PROPERTIES_TO_BASKET'] == 'N' ? 'Y' : 'N')[m
[31m-		),[m
[31m-		"DISPLAY_COMPARE" => array([m
[31m-			"PARENT" => "COMPARE",[m
[31m-			"NAME" => GetMessage('CP_BCE_DISPLAY_COMPARE'),[m
[31m-			"TYPE" => "CHECKBOX",[m
[31m-			"DEFAULT" => "N",[m
[31m-			"REFRESH" => "Y"[m
[31m-		),[m
[31m-		"LINK_IBLOCK_TYPE" => array([m
[31m-			"PARENT" => "LINK",[m
[31m-			"NAME" => GetMessage("IBLOCK_LINK_IBLOCK_TYPE"),[m
[31m-			"TYPE" => "LIST",[m
[31m-			"ADDITIONAL_VALUES" => "Y",[m
[31m-			"VALUES" => $arIBlockType,[m
[31m-			"REFRESH" => "Y",[m
[31m-		),[m
[31m-		"LINK_IBLOCK_ID" => array([m
[31m-			"PARENT" => "LINK",[m
[31m-			"NAME" => GetMessage("IBLOCK_LINK_IBLOCK_ID"),[m
[31m-			"TYPE" => "LIST",[m
[31m-			"ADDITIONAL_VALUES" => "Y",[m
[31m-			"VALUES" => $arIBlock_LINK,[m
[31m-			"REFRESH" => "Y",[m
[31m-		),[m
[31m-		"LINK_PROPERTY_SID" => array([m
[31m-			"PARENT" => "LINK",[m
[31m-			"NAME" => GetMessage("IBLOCK_LINK_PROPERTY_SID"),[m
[31m-			"TYPE" => "LIST",[m
[31m-			"ADDITIONAL_VALUES" => "Y",[m
[31m-			"VALUES" => $arProperty_LINK,[m
[31m-		),[m
[31m-		"LINK_ELEMENTS_URL" => array([m
[31m-			"PARENT" => "LINK",[m
[31m-			"NAME" => GetMessage("IBLOCK_LINK_ELEMENTS_URL"),[m
[31m-			"TYPE" => "STRING",[m
[31m-			"DEFAULT" => "link.php?PARENT_ELEMENT_ID=#ELEMENT_ID#",[m
[31m-		),[m
[31m-		"CACHE_TIME"  =>  array("DEFAULT"=>36000000),[m
[31m-		"CACHE_GROUPS" => array([m
[31m-			"PARENT" => "CACHE_SETTINGS",[m
[31m-			"NAME" => GetMessage("CP_BCE_CACHE_GROUPS"),[m
[31m-			"TYPE" => "CHECKBOX",[m
[31m-			"DEFAULT" => "Y",[m
[31m-		),[m
[31m-		"USE_ELEMENT_COUNTER" => array([m
[31m-			"PARENT" => "ADDITIONAL_SETTINGS",[m
[31m-			"NAME" => GetMessage('CP_BCE_USE_ELEMENT_COUNTER'),[m
[31m-			"TYPE" => "CHECKBOX",[m
[31m-			"DEFAULT" => "Y"[m
[31m-		),[m
[31m-		"SHOW_DEACTIVATED" => array([m
[31m-			"PARENT" => "ADDITIONAL_SETTINGS",[m
[31m-			"NAME" => GetMessage('CP_BCE_SHOW_DEACTIVATED'),[m
[31m-			"TYPE" => "CHECKBOX",[m
[31m-			"DEFAULT" => "N"[m
[31m-		),[m
[31m-	),[m
[31m-);[m
[31m-[m
[31m-if ($arCurrentValues["SEF_MODE"] == "Y")[m
[31m-{[m
[31m-	$arComponentParameters["PARAMETERS"]["SECTION_CODE_PATH"] = array([m
[31m-		"NAME" => GetMessage("CP_BCE_SECTION_CODE_PATH"),[m
[31m-		"TYPE" => "STRING",[m
[31m-		"DEFAULT" => "",[m
[31m-	);[m
[31m-}[m
[31m-[m
[31m-if ($catalogIncluded)[m
[31m-{[m
[31m-	$arComponentParameters["PARAMETERS"]['HIDE_NOT_AVAILABLE'] = array([m
[31m-		'PARENT' => 'DATA_SOURCE',[m
[31m-		'NAME' => GetMessage('CP_BCE_HIDE_NOT_AVAILABLE'),[m
[31m-		'TYPE' => 'CHECKBOX',[m
[31m-		'DEFAULT' => 'N',[m
[31m-	);[m
[31m-[m
[31m-	$arComponentParameters["PARAMETERS"]['CONVERT_CURRENCY'] = array([m
[31m-		'PARENT' => 'PRICES',[m
[31m-		'NAME' => GetMessage('CP_BCE_CONVERT_CURRENCY'),[m
[31m-		'TYPE' => 'CHECKBOX',[m
[31m-		'DEFAULT' => 'N',[m
[31m-		'REFRESH' => 'Y',[m
[31m-	);[m
[31m-[m
[31m-	if (isset($arCurrentValues['CONVERT_CURRENCY']) && $arCurrentValues['CONVERT_CURRENCY'] == 'Y')[m
[31m-	{[m
[31m-		$arComponentParameters['PARAMETERS']['CURRENCY_ID'] = array([m
[31m-			'PARENT' => 'PRICES',[m
[31m-			'NAME' => GetMessage('CP_BCE_CURRENCY_ID'),[m
[31m-			'TYPE' => 'LIST',[m
[31m-			'VALUES' => Currency\CurrencyManager::getCurrencyList(),[m
[31m-			'DEFAULT' => Currency\CurrencyManager::getBaseCurrency(),[m
[31m-			"ADDITIONAL_VALUES" => "Y",[m
[31m-		);[m
[31m-	}[m
[31m-}[m
[31m-[m
[31m-if (empty($offers))[m
[31m-{[m
[31m-	unset($arComponentParameters["PARAMETERS"]["OFFERS_FIELD_CODE"]);[m
[31m-	unset($arComponentParameters["PARAMETERS"]["OFFERS_PROPERTY_CODE"]);[m
[31m-	unset($arComponentParameters["PARAMETERS"]["OFFERS_SORT_FIELD"]);[m
[31m-	unset($arComponentParameters["PARAMETERS"]["OFFERS_SORT_ORDER"]);[m
[31m-	unset($arComponentParameters["PARAMETERS"]["OFFERS_SORT_FIELD2"]);[m
[31m-	unset($arComponentParameters["PARAMETERS"]["OFFERS_SORT_ORDER2"]);[m
[31m-}[m
[31m-else[m
[31m-{[m
[31m-	$arComponentParameters["PARAMETERS"]["OFFERS_CART_PROPERTIES"] = array([m
[31m-		"PARENT" => "BASKET",[m
[31m-		"NAME" => GetMessage("CP_BCE_OFFERS_CART_PROPERTIES"),[m
[31m-		"TYPE" => "LIST",[m
[31m-		"MULTIPLE" => "Y",[m
[31m-		"VALUES" => $arProperty_OffersWithoutFile,[m
[31m-		"SIZE" => (count($arProperty_OffersWithoutFile) > 5 ? 8 : 3),[m
[31m-		"HIDDEN" => (isset($arCurrentValues['ADD_PROPERTIES_TO_BASKET']) && $arCurrentValues['ADD_PROPERTIES_TO_BASKET'] == 'N' ? 'Y' : 'N')[m
[31m-	);[m
[31m-}[m
[31m-[m
[31m-if (isset($arCurrentValues['DISPLAY_COMPARE']) && $arCurrentValues['DISPLAY_COMPARE'] == 'Y')[m
[31m-{[m
[31m-	$arComponentParameters['PARAMETERS']['COMPARE_PATH'] = array([m
[31m-		'PARENT' => 'COMPARE',[m
[31m-		'NAME' => GetMessage('CP_BCE_COMPARE_PATH'),[m
[31m-		'TYPE' => 'STRING',[m
[31m-		'DEFAULT' => ''[m
[31m-	);[m
[31m-}[m
[31m-[m
[31m-CIBlockParameters::Add404Settings($arComponentParameters, $arCurrentValues);[m
[1mdiff --git a/local/components/zakrepi/catalog.element/ajax.php b/local/components/zakrepi/catalog.element/ajax.php[m
[1mdeleted file mode 100644[m
[1mindex d20704a..0000000[m
[1m--- a/local/components/zakrepi/catalog.element/ajax.php[m
[1m+++ /dev/null[m
[36m@@ -1,53 +0,0 @@[m
[31m-<?[m
[31m-/** @global CMain $APPLICATION */[m
[31m-define('NO_AGENT_CHECK', true);[m
[31m-[m
[31m-use Bitrix\Main;[m
[31m-use Bitrix\Catalog;[m
[31m-[m
[31m-require($_SERVER['DOCUMENT_ROOT'].'/bitrix/modules/main/include/prolog_before.php');[m
[31m-if (isset($_POST['AJAX']) && $_POST['AJAX'] == 'Y')[m
[31m-{[m
[31m-	if (Main\Loader::includeModule('statictic') && isset($_SESSION['SESS_SEARCHER_ID']) && (int)$_SESSION['SESS_SEARCHER_ID'] > 0)[m
[31m-	{[m
[31m-		echo CUtil::PhpToJSObject(array("STATUS" => "ERROR", "TEXT" => "SEARCHER"));[m
[31m-		die();[m
[31m-	}[m
[31m-	if (isset($_POST['PRODUCT_ID']) && isset($_POST['SITE_ID']))[m
[31m-	{[m
[31m-		$productID = (int)$_POST['PRODUCT_ID'];[m
[31m-		$parentID = (isset($_POST['PARENT_ID']) ? (int)$_POST['PARENT_ID'] : 0);[m
[31m-		$siteID = '';[m
[31m-		if (preg_match('/^[a-z0-9_]{2}$/i', (string)$_POST['SITE_ID']) === 1)[m
[31m-			$siteID = (string)$_POST['SITE_ID'];[m
[31m-		if ($productID > 0 && $siteID !== '' && Main\Loader::includeModule('catalog') && Main\Loader::includeModule('sale'))[m
[31m-		{[m
[31m-			// check if there was a recommendation[m
[31m-			$recommendationId = '';[m
[31m-			$recommendationCookie = $APPLICATION->get_cookie(Bitrix\Main\Analytics\Catalog::getCookieLogName());[m
[31m-[m
[31m-			if (!empty($recommendationCookie))[m
[31m-			{[m
[31m-				$recommendations = \Bitrix\Main\Analytics\Catalog::decodeProductLog($recommendationCookie);[m
[31m-[m
[31m-				if (is_array($recommendations) && isset($recommendations[$parentID]))[m
[31m-					$recommendationId = $recommendations[$parentID][0];[m
[31m-			}[m
[31m-[m
[31m-			// add record[m
[31m-			Catalog\CatalogViewedProductTable::refresh([m
[31m-				$productID,[m
[31m-				CSaleBasket::GetBasketUserID(),[m
[31m-				$siteID,[m
[31m-				$parentID,[m
[31m-				$recommendationId[m
[31m-			);[m
[31m-			echo CUtil::PhpToJSObject(array("STATUS" => "SUCCESS"));[m
[31m-		}[m
[31m-		else[m
[31m-		{[m
[31m-			echo CUtil::PhpToJSObject(array("STATUS" => "ERROR", "TEXT" => "UNDEFINED PRODUCT"));[m
[31m-		}[m
[31m-	}[m
[31m-	die();[m
[31m-}[m
\ No newline at end of file[m
[1mdiff --git a/local/components/zakrepi/catalog.element/component.php b/local/components/zakrepi/catalog.element/component.php[m
[1mdeleted file mode 100644[m
[1mindex 325c839..0000000[m
[1m--- a/local/components/zakrepi/catalog.element/component.php[m
[1m+++ /dev/null[m
[36m@@ -1,1270 +0,0 @@[m
[31m-<?[m
[31m-use Bitrix\Main\Context;[m
[31m-use Bitrix\Main\Loader;[m
[31m-use Bitrix\Main\Type\Collection;[m
[31m-use Bitrix\Main\Type\DateTime;[m
[31m-use Bitrix\Currency\CurrencyTable;[m
[31m-[m
[31m-if(!defined("B_PROLOG_INCLUDED") || B_PROLOG_INCLUDED!==true) die();[m
[31m-/** @var CBitrixComponent $this */[m
[31m-/** @var array $arParams */[m
[31m-/** @var array $arResult */[m
[31m-/** @var string $componentPath */[m
[31m-/** @var string $componentName */[m
[31m-/** @var string $componentTemplate */[m
[31m-/** @global CDatabase $DB */[m
[31m-/** @global CUser $USER */[m
[31m-/** @global CMain $APPLICATION */[m
[31m-/** @global CCacheManager $CACHE_MANAGER */[m
[31m-global $CACHE_MANAGER;[m
[31m-[m
[31m-CJSCore::Init(array('popup'));[m
[31m-[m
[31m-/*************************************************************************[m
[31m-	Processing of received parameters[m
[31m-*************************************************************************/[m
[31m-if(!isset($arParams["CACHE_TIME"]))[m
[31m-	$arParams["CACHE_TIME"] = 36000000;[m
[31m-[m
[31m-$arParams["IBLOCK_TYPE"] = trim($arParams["IBLOCK_TYPE"]);[m
[31m-$arParams["IBLOCK_ID"] = intval($arParams["IBLOCK_ID"]);[m
[31m-$arParams["SECTION_ID"] = intval($arParams["SECTION_ID"]);[m
[31m-$arParams['SECTION_CODE'] = trim($arParams['SECTION_CODE']);[m
[31m-[m
[31m-$arParams["ELEMENT_ID"] = intval($arParams["~ELEMENT_ID"]);[m
[31m-if($arParams["ELEMENT_ID"] > 0 && $arParams["ELEMENT_ID"]."" != $arParams["~ELEMENT_ID"])[m
[31m-{[m
[31m-	if (CModule::IncludeModule("iblock"))[m
[31m-	{[m
[31m-		\Bitrix\Iblock\Component\Tools::process404([m
[31m-			trim($arParams["MESSAGE_404"]) ?: GetMessage("CATALOG_ELEMENT_NOT_FOUND")[m
[31m-			,true[m
[31m-			,$arParams["SET_STATUS_404"] === "Y"[m
[31m-			,$arParams["SHOW_404"] === "Y"[m
[31m-			,$arParams["FILE_404"][m
[31m-		);[m
[31m-	}[m
[31m-	return;[m
[31m-}[m
[31m-[m
[31m-$arParams["SECTION_URL"]=trim($arParams["SECTION_URL"]);[m
[31m-$arParams["DETAIL_URL"]=trim($arParams["DETAIL_URL"]);[m
[31m-$arParams["BASKET_URL"]=trim($arParams["BASKET_URL"]);[m
[31m-if($arParams["BASKET_URL"] === '')[m
[31m-	$arParams["BASKET_URL"] = "/personal/basket.php";[m
[31m-[m
[31m-$arParams["ACTION_VARIABLE"]=trim($arParams["ACTION_VARIABLE"]);[m
[31m-if($arParams["ACTION_VARIABLE"] === '' || !preg_match("/^[A-Za-z_][A-Za-z01-9_]*$/", $arParams["ACTION_VARIABLE"]))[m
[31m-	$arParams["ACTION_VARIABLE"] = "action";[m
[31m-[m
[31m-$arParams["PRODUCT_ID_VARIABLE"]=trim($arParams["PRODUCT_ID_VARIABLE"]);[m
[31m-if($arParams["PRODUCT_ID_VARIABLE"] === '' || !preg_match("/^[A-Za-z_][A-Za-z01-9_]*$/", $arParams["PRODUCT_ID_VARIABLE"]))[m
[31m-	$arParams["PRODUCT_ID_VARIABLE"] = "id";[m
[31m-[m
[31m-$arParams["PRODUCT_QUANTITY_VARIABLE"]=trim($arParams["PRODUCT_QUANTITY_VARIABLE"]);[m
[31m-if($arParams["PRODUCT_QUANTITY_VARIABLE"] === '' || !preg_match("/^[A-Za-z_][A-Za-z01-9_]*$/", $arParams["PRODUCT_QUANTITY_VARIABLE"]))[m
[31m-	$arParams["PRODUCT_QUANTITY_VARIABLE"] = "quantity";[m
[31m-[m
[31m-$arParams["PRODUCT_PROPS_VARIABLE"]=trim($arParams["PRODUCT_PROPS_VARIABLE"]);[m
[31m-if($arParams["PRODUCT_PROPS_VARIABLE"] === '' || !preg_match("/^[A-Za-z_][A-Za-z01-9_]*$/", $arParams["PRODUCT_PROPS_VARIABLE"]))[m
[31m-	$arParams["PRODUCT_PROPS_VARIABLE"] = "prop";[m
[31m-[m
[31m-$arParams["SECTION_ID_VARIABLE"]=trim($arParams["SECTION_ID_VARIABLE"]);[m
[31m-if($arParams["SECTION_ID_VARIABLE"] === '' || !preg_match("/^[A-Za-z_][A-Za-z01-9_]*$/", $arParams["SECTION_ID_VARIABLE"]))[m
[31m-	$arParams["SECTION_ID_VARIABLE"] = "SECTION_ID";[m
[31m-$arParams["CHECK_SECTION_ID_VARIABLE"] = (isset($arParams["CHECK_SECTION_ID_VARIABLE"]) && $arParams["CHECK_SECTION_ID_VARIABLE"] === 'Y' ? 'Y' : 'N');[m
[31m-$arParams['FROM_SECTION'] = '';[m
[31m-if ($arParams["CHECK_SECTION_ID_VARIABLE"] === 'Y')[m
[31m-	$arParams['FROM_SECTION'] = (isset($_REQUEST[$arParams["SECTION_ID_VARIABLE"]]) ? trim($_REQUEST[$arParams["SECTION_ID_VARIABLE"]]) : '');[m
[31m-[m
[31m-$arParams["META_KEYWORDS"] = trim($arParams["META_KEYWORDS"]);[m
[31m-$arParams["META_DESCRIPTION"] = trim($arParams["META_DESCRIPTION"]);[m
[31m-$arParams["BROWSER_TITLE"] = trim($arParams["BROWSER_TITLE"]);[m
[31m-[m
[31m-$arParams["SET_TITLE"] = $arParams["SET_TITLE"]!="N";[m
[31m-$arParams["SET_BROWSER_TITLE"] = (isset($arParams["SET_BROWSER_TITLE"]) && $arParams["SET_BROWSER_TITLE"] === 'N' ? 'N' : 'Y');[m
[31m-$arParams["SET_META_KEYWORDS"] = (isset($arParams["SET_META_KEYWORDS"]) && $arParams["SET_META_KEYWORDS"] === 'N' ? 'N' : 'Y');[m
[31m-$arParams["SET_META_DESCRIPTION"] = (isset($arParams["SET_META_DESCRIPTION"]) && $arParams["SET_META_DESCRIPTION"] === 'N' ? 'N' : 'Y');[m
[31m-$arParams["ADD_SECTIONS_CHAIN"] = $arParams["ADD_SECTIONS_CHAIN"]!="N"; //Turn on by default[m
[31m-$arParams["SET_LAST_MODIFIED"] = $arParams["SET_LAST_MODIFIED"]==="Y";[m
[31m-$arParams["USE_MAIN_ELEMENT_SECTION"] = $arParams["USE_MAIN_ELEMENT_SECTION"]==="Y";[m
[31m-$arParams["ADD_ELEMENT_CHAIN"] = (isset($arParams["ADD_ELEMENT_CHAIN"]) && $arParams["ADD_ELEMENT_CHAIN"] == "Y");[m
[31m-[m
[31m-if(!isset($arParams["PROPERTY_CODE"]) || !is_array($arParams["PROPERTY_CODE"]))[m
[31m-	$arParams["PROPERTY_CODE"] = array();[m
[31m-foreach($arParams["PROPERTY_CODE"] as $k=>$v)[m
[31m-	if($v==="")[m
[31m-		unset($arParams["PROPERTY_CODE"][$k]);[m
[31m-[m
[31m-if(!isset($arParams["PRICE_CODE"]) || !is_array($arParams["PRICE_CODE"]))[m
[31m-	$arParams["PRICE_CODE"] = array();[m
[31m-$arParams["USE_PRICE_COUNT"] = $arParams["USE_PRICE_COUNT"]=="Y";[m
[31m-$arParams["SHOW_PRICE_COUNT"] = (isset($arParams["SHOW_PRICE_COUNT"]) ? (int)$arParams["SHOW_PRICE_COUNT"] : 1);[m
[31m-if ($arParams["SHOW_PRICE_COUNT"] <= 0)[m
[31m-	$arParams["SHOW_PRICE_COUNT"] = 1;[m
[31m-$arParams["USE_PRODUCT_QUANTITY"] = $arParams["USE_PRODUCT_QUANTITY"]==="Y";[m
[31m-[m
[31m-$arParams['ADD_PROPERTIES_TO_BASKET'] = (isset($arParams['ADD_PROPERTIES_TO_BASKET']) && $arParams['ADD_PROPERTIES_TO_BASKET'] === 'N' ? 'N' : 'Y');[m
[31m-if ('N' == $arParams['ADD_PROPERTIES_TO_BASKET'])[m
[31m-{[m
[31m-	$arParams["PRODUCT_PROPERTIES"] = array();[m
[31m-	$arParams["OFFERS_CART_PROPERTIES"] = array();[m
[31m-}[m
[31m-$arParams['PARTIAL_PRODUCT_PROPERTIES'] = (isset($arParams['PARTIAL_PRODUCT_PROPERTIES']) && $arParams['PARTIAL_PRODUCT_PROPERTIES'] === 'Y' ? 'Y' : 'N');[m
[31m-if(!isset($arParams["PRODUCT_PROPERTIES"]) || !is_array($arParams["PRODUCT_PROPERTIES"]))[m
[31m-	$arParams["PRODUCT_PROPERTIES"] = array();[m
[31m-foreach($arParams["PRODUCT_PROPERTIES"] as $k=>$v)[m
[31m-	if($v==="")[m
[31m-		unset($arParams["PRODUCT_PROPERTIES"][$k]);[m
[31m-[m
[31m-if (!isset($arParams["OFFERS_CART_PROPERTIES"]) || !is_array($arParams["OFFERS_CART_PROPERTIES"]))[m
[31m-	$arParams["OFFERS_CART_PROPERTIES"] = array();[m
[31m-foreach($arParams["OFFERS_CART_PROPERTIES"] as $i => $pid)[m
[31m-	if ($pid === "")[m
[31m-		unset($arParams["OFFERS_CART_PROPERTIES"][$i]);[m
[31m-[m
[31m-if (empty($arParams["OFFERS_SORT_FIELD"]))[m
[31m-	$arParams["OFFERS_SORT_FIELD"] = "sort";[m
[31m-if (!preg_match('/^(asc|desc|nulls)(,asc|,desc|,nulls){0,1}$/i', $arParams["OFFERS_SORT_ORDER"]))[m
[31m-	$arParams["OFFERS_SORT_ORDER"] = "asc";[m
[31m-if (empty($arParams["OFFERS_SORT_FIELD2"]))[m
[31m-	$arParams["OFFERS_SORT_FIELD2"] = "id";[m
[31m-if (!preg_match('/^(asc|desc|nulls)(,asc|,desc|,nulls){0,1}$/i', $arParams["OFFERS_SORT_ORDER2"]))[m
[31m-	$arParams["OFFERS_SORT_ORDER2"] = "desc";[m
[31m-[m
[31m-$arParams['DISPLAY_COMPARE'] = (isset($arParams['DISPLAY_COMPARE']) && $arParams['DISPLAY_COMPARE'] == 'Y');[m
[31m-$arParams['COMPARE_PATH'] = (isset($arParams['COMPARE_PATH']) ? trim($arParams['COMPARE_PATH']) : '');[m
[31m-[m
[31m-$arParams["LINK_IBLOCK_TYPE"] = trim($arParams["LINK_IBLOCK_TYPE"]);[m
[31m-$arParams["LINK_IBLOCK_ID"] = intval($arParams["LINK_IBLOCK_ID"]);[m
[31m-$arParams["LINK_PROPERTY_SID"] = trim($arParams["LINK_PROPERTY_SID"]);[m
[31m-$arParams["LINK_ELEMENTS_URL"]=trim($arParams["LINK_ELEMENTS_URL"]);[m
[31m-if($arParams["LINK_ELEMENTS_URL"] === '')[m
[31m-	$arParams["LINK_ELEMENTS_URL"] = "link.php?PARENT_ELEMENT_ID=#ELEMENT_ID#";[m
[31m-[m
[31m-$arParams["SHOW_WORKFLOW"] = $_REQUEST["show_workflow"]=="Y";[m
[31m-if($arParams["SHOW_WORKFLOW"])[m
[31m-	$arParams["CACHE_TIME"] = 0;[m
[31m-[m
[31m-$arParams['CACHE_GROUPS'] = trim($arParams['CACHE_GROUPS']);[m
[31m-if ('N' != $arParams['CACHE_GROUPS'])[m
[31m-	$arParams['CACHE_GROUPS'] = 'Y';[m
[31m-[m
[31m-$arParams["PRICE_VAT_INCLUDE"] = $arParams["PRICE_VAT_INCLUDE"] !== "N";[m
[31m-$arParams["PRICE_VAT_SHOW_VALUE"] = $arParams["PRICE_VAT_SHOW_VALUE"] === "Y";[m
[31m-[m
[31m-$arParams['CONVERT_CURRENCY'] = (isset($arParams['CONVERT_CURRENCY']) && 'Y' == $arParams['CONVERT_CURRENCY'] ? 'Y' : 'N');[m
[31m-$arParams['CURRENCY_ID'] = trim(strval($arParams['CURRENCY_ID']));[m
[31m-if ('' == $arParams['CURRENCY_ID'])[m
[31m-{[m
[31m-	$arParams['CONVERT_CURRENCY'] = 'N';[m
[31m-}[m
[31m-elseif ('N' == $arParams['CONVERT_CURRENCY'])[m
[31m-{[m
[31m-	$arParams['CURRENCY_ID'] = '';[m
[31m-}[m
[31m-$arParams['HIDE_NOT_AVAILABLE'] = (!isset($arParams['HIDE_NOT_AVAILABLE']) || 'Y' != $arParams['HIDE_NOT_AVAILABLE'] ? 'N' : 'Y');[m
[31m-[m
[31m-$arParams["OFFERS_LIMIT"] = intval($arParams["OFFERS_LIMIT"]);[m
[31m-if (0 > $arParams["OFFERS_LIMIT"])[m
[31m-	$arParams["OFFERS_LIMIT"] = 0;[m
[31m-[m
[31m-$arParams['USE_ELEMENT_COUNTER'] = (isset($arParams['USE_ELEMENT_COUNTER']) && 'N' == $arParams['USE_ELEMENT_COUNTER'] ? 'N' : 'Y');[m
[31m-$arParams["SHOW_DEACTIVATED"] = (isset($arParams['SHOW_DEACTIVATED']) && 'Y' == $arParams['SHOW_DEACTIVATED'] ? 'Y' : 'N');[m
[31m-[m
[31m-/*************************************************************************[m
[31m-			Processing of the Buy link[m
[31m-*************************************************************************/[m
[31m-$strError = '';[m
[31m-$successfulAdd = true;[m
[31m-[m
[31m-if (isset($_REQUEST[$arParams["ACTION_VARIABLE"]]) && isset($_REQUEST[$arParams["PRODUCT_ID_VARIABLE"]]))[m
[31m-{[m
[31m-	if(isset($_REQUEST[$arParams["ACTION_VARIABLE"]."BUY"]))[m
[31m-		$action = "BUY";[m
[31m-	elseif(isset($_REQUEST[$arParams["ACTION_VARIABLE"]."ADD2BASKET"]))[m
[31m-		$action = "ADD2BASKET";[m
[31m-	else[m
[31m-		$action = strtoupper($_REQUEST[$arParams["ACTION_VARIABLE"]]);[m
[31m-[m
[31m-	$productID = (int)$_REQUEST[$arParams["PRODUCT_ID_VARIABLE"]];[m
[31m-	if (($action == "ADD2BASKET" || $action == "BUY" || $action == "SUBSCRIBE_PRODUCT") && $productID > 0)[m
[31m-	{[m
[31m-		if (Loader::includeModule("sale") && Loader::includeModule("catalog"))[m
[31m-		{[m
[31m-			$addByAjax = isset($_REQUEST['ajax_basket']) && $_REQUEST['ajax_basket'] === 'Y';[m
[31m-			$QUANTITY = 0;[m
[31m-			$product_properties = array();[m
[31m-			$intProductIBlockID = (int)CIBlockElement::GetIBlockByID($productID);[m
[31m-			if (0 < $intProductIBlockID)[m
[31m-			{[m
[31m-				if ($arParams['ADD_PROPERTIES_TO_BASKET'] == 'Y')[m
[31m-				{[m
[31m-					if ($intProductIBlockID == $arParams["IBLOCK_ID"])[m
[31m-					{[m
[31m-						if (!empty($arParams["PRODUCT_PROPERTIES"]))[m
[31m-						{[m
[31m-							if ([m
[31m-								isset($_REQUEST[$arParams["PRODUCT_PROPS_VARIABLE"]])[m
[31m-								&& is_array($_REQUEST[$arParams["PRODUCT_PROPS_VARIABLE"]])[m
[31m-							)[m
[31m-							{[m
[31m-								$product_properties = CIBlockPriceTools::CheckProductProperties([m
[31m-									$arParams["IBLOCK_ID"],[m
[31m-									$productID,[m
[31m-									$arParams["PRODUCT_PROPERTIES"],[m
[31m-									$_REQUEST[$arParams["PRODUCT_PROPS_VARIABLE"]],[m
[31m-									$arParams['PARTIAL_PRODUCT_PROPERTIES'] == 'Y'[m
[31m-								);[m
[31m-								if (!is_array($product_properties))[m
[31m-								{[m
[31m-									$strError = GetMessage("CATALOG_PARTIAL_BASKET_PROPERTIES_ERROR");[m
[31m-									$successfulAdd = false;[m
[31m-								}[m
[31m-							}[m
[31m-							else[m
[31m-							{[m
[31m-								$strError = GetMessage("CATALOG_EMPTY_BASKET_PROPERTIES_ERROR");[m
[31m-								$successfulAdd  = false;[m
[31m-							}[m
[31m-						}[m
[31m-					}[m
[31m-					else[m
[31m-					{[m
[31m-						$skuAddProps = (isset($_REQUEST['basket_props']) && !empty($_REQUEST['basket_props']) ? $_REQUEST['basket_props'] : '');[m
[31m-						if (!empty($arParams["OFFERS_CART_PROPERTIES"]) || !empty($skuAddProps))[m
[31m-						{[m
[31m-							$product_properties = CIBlockPriceTools::GetOfferProperties([m
[31m-								$productID,[m
[31m-								$arParams["IBLOCK_ID"],[m
[31m-								$arParams["OFFERS_CART_PROPERTIES"],[m
[31m-								$skuAddProps[m
[31m-							);[m
[31m-						}[m
[31m-					}[m
[31m-				}[m
[31m-				if ($arParams["USE_PRODUCT_QUANTITY"])[m
[31m-				{[m
[31m-					if (isset($_REQUEST[$arParams["PRODUCT_QUANTITY_VARIABLE"]]))[m
[31m-					{[m
[31m-						$QUANTITY = doubleval($_REQUEST[$arParams["PRODUCT_QUANTITY_VARIABLE"]]);[m
[31m-					}[m
[31m-				}[m
[31m-				if (0 >= $QUANTITY)[m
[31m-				{[m
[31m-					$rsRatios = CCatalogMeasureRatio::getList([m
[31m-						array(),[m
[31m-						array('PRODUCT_ID' => $productID),[m
[31m-						false,[m
[31m-						false,[m
[31m-						array('PRODUCT_ID', 'RATIO')[m
[31m-					);[m
[31m-					if ($arRatio = $rsRatios->Fetch())[m
[31m-					{[m
[31m-						$intRatio = (int)$arRatio['RATIO'];[m
[31m-						$dblRatio = doubleval($arRatio['RATIO']);[m
[31m-						$QUANTITY = ($dblRatio > $intRatio ? $dblRatio : $intRatio);[m
[31m-					}[m
[31m-				}[m
[31m-				if (0 >= $QUANTITY)[m
[31m-					$QUANTITY = 1;[m
[31m-			}[m
[31m-			else[m
[31m-			{[m
[31m-				$strError = GetMessage('CATALOG_ELEMENT_NOT_FOUND');[m
[31m-				$successfulAdd = false;[m
[31m-			}[m
[31m-[m
[31m-			if ($successfulAdd)[m
[31m-			{[m
[31m-				$notifyOption = COption::GetOptionString("sale", "subscribe_prod", "");[m
[31m-				$arNotify = unserialize($notifyOption);[m
[31m-				$arRewriteFields = array();[m
[31m-				if ($action == "SUBSCRIBE_PRODUCT" && $arNotify[SITE_ID]['use'] == 'Y')[m
[31m-				{[m
[31m-					$arRewriteFields["SUBSCRIBE"] = "Y";[m
[31m-					$arRewriteFields["CAN_BUY"] = "N";[m
[31m-				}[m
[31m-			}[m
[31m-[m
[31m-			if ($successfulAdd)[m
[31m-			{[m
[31m-				if(!Add2BasketByProductID($productID, $QUANTITY, $arRewriteFields, $product_properties))[m
[31m-				{[m
[31m-					if ($ex = $APPLICATION->GetException())[m
[31m-						$strError = $ex->GetString();[m
[31m-					else[m
[31m-						$strError = GetMessage("CATALOG_ERROR2BASKET");[m
[31m-					$successfulAdd = false;[m
[31m-				}[m
[31m-			}[m
[31m-[m
[31m-			if ($addByAjax)[m
[31m-			{[m
[31m-				if ($successfulAdd)[m
[31m-				{[m
[31m-					$addResult = array('STATUS' => 'OK', 'MESSAGE' => GetMessage('CATALOG_SUCCESSFUL_ADD_TO_BASKET'));[m
[31m-				}[m
[31m-				else[m
[31m-				{[m
[31m-					$addResult = array('STATUS' => 'ERROR', 'MESSAGE' => $strError);[m
[31m-				}[m
[31m-				$APPLICATION->RestartBuffer();[m
[31m-				echo CUtil::PhpToJSObject($addResult);[m
[31m-				die();[m
[31m-			}[m
[31m-			else[m
[31m-			{[m
[31m-				if ($successfulAdd)[m
[31m-				{[m
[31m-					$pathRedirect = ([m
[31m-						$action == "BUY"[m
[31m-						? $arParams["BASKET_URL"][m
[31m-						: $APPLICATION->GetCurPageParam("", array([m
[31m-							$arParams["PRODUCT_ID_VARIABLE"],[m
[31m-							$arParams["ACTION_VARIABLE"],[m
[31m-							$arParams['PRODUCT_QUANTITY_VARIABLE'],[m
[31m-							$arParams['PRODUCT_PROPS_VARIABLE'][m
[31m-						))[m
[31m-					);[m
[31m-					LocalRedirect($pathRedirect);[m
[31m-				}[m
[31m-			}[m
[31m-		}[m
[31m-	}[m
[31m-}[m
[31m-[m
[31m-if (!$successfulAdd)[m
[31m-{[m
[31m-	ShowError($strError);[m
[31m-	return 0;[m
[31m-}[m
[31m-[m
[31m-/*************************************************************************[m
[31m-			Work with cache[m
[31m-*************************************************************************/[m
[31m-if($this->StartResultCache(false, ($arParams["CACHE_GROUPS"]==="N"? false: $USER->GetGroups())))[m
[31m-{[m
[31m-	if (!Loader::includeModule("iblock"))[m
[31m-	{[m
[31m-		$this->AbortResultCache();[m
[31m-		ShowError(GetMessage("IBLOCK_MODULE_NOT_INSTALLED"));[m
[31m-		return 0;[m
[31m-	}[m
[31m-[m
[31m-	$arResultModules = array([m
[31m-		'iblock' => true,[m
[31m-		'catalog' => false,[m
[31m-		'currency' => false,[m
[31m-		'workflow' => false[m
[31m-	);[m
[31m-[m
[31m-	$arConvertParams = array();[m
[31m-	if ($arParams['CONVERT_CURRENCY'] == 'Y')[m
[31m-	{[m
[31m-		if (!Loader::includeModule('currency'))[m
[31m-		{[m
[31m-			$arParams['CONVERT_CURRENCY'] = 'N';[m
[31m-			$arParams['CURRENCY_ID'] = '';[m
[31m-		}[m
[31m-		else[m
[31m-		{[m
[31m-			$arResultModules['currency'] = true;[m
[31m-			$currencyIterator = CurrencyTable::getList(array([m
[31m-				'select' => array('CURRENCY'),[m
[31m-				'filter' => array('=CURRENCY' => $arParams['CURRENCY_ID'])[m
[31m-			));[m
[31m-			if ($currency = $currencyIterator->fetch())[m
[31m-			{[m
[31m-				$arParams['CURRENCY_ID'] = $currency['CURRENCY'];[m
[31m-				$arConvertParams['CURRENCY_ID'] = $currency['CURRENCY'];[m
[31m-			}[m
[31m-			else[m
[31m-			{[m
[31m-				$arParams['CONVERT_CURRENCY'] = 'N';[m
[31m-				$arParams['CURRENCY_ID'] = '';[m
[31m-			}[m
[31m-			unset($currency, $currencyIterator);[m
[31m-		}[m
[31m-	}[m
[31m-[m
[31m-	//Handle case when ELEMENT_CODE used[m
[31m-	if($arParams["ELEMENT_ID"] <= 0)[m
[31m-	{[m
[31m-		$findFilter = array([m
[31m-			"IBLOCK_ID" => $arParams["IBLOCK_ID"],[m
[31m-			"IBLOCK_LID" => SITE_ID,[m
[31m-			"IBLOCK_ACTIVE" => "Y",[m
[31m-			"ACTIVE_DATE" => "Y",[m
[31m-			"CHECK_PERMISSIONS" => "Y",[m
[31m-			"MIN_PERMISSION" => 'R',[m
[31m-		);[m
[31m-		if ($arParams["SHOW_DEACTIVATED"] !== "Y")[m
[31m-			$findFilter["ACTIVE"] = "Y";[m
[31m-[m
[31m-		$arParams["ELEMENT_ID"] = CIBlockFindTools::GetElementID([m
[31m-			$arParams["ELEMENT_ID"],[m
[31m-			$arParams["ELEMENT_CODE"],[m
[31m-			false,[m
[31m-			false,[m
[31m-			$findFilter[m
[31m-		);[m
[31m-	}[m
[31m-[m
[31m-	if($arParams["ELEMENT_ID"] > 0)[m
[31m-	{[m
[31m-		$currentPath = CHTTP::urlDeleteParams([m
[31m-			$APPLICATION->GetCurPageParam(),[m
[31m-			array($arParams['PRODUCT_ID_VARIABLE'], $arParams['ACTION_VARIABLE']),[m
[31m-			array("delete_system_params" => true)[m
[31m-		);[m
[31m-		$currentPath .= (stripos($currentPath, '?') === false ? '?' : '&');[m
[31m-		if ($arParams['COMPARE_PATH'] == '')[m
[31m-		{[m
[31m-			$comparePath = $currentPath;[m
[31m-		}[m
[31m-		else[m
[31m-		{[m
[31m-			$comparePath = $arParams['COMPARE_PATH'];[m
[31m-			$comparePath .= (stripos($comparePath, '?') === false ? '?' : '&');[m
[31m-		}[m
[31m-[m
[31m-		$arUrlTemplates = array();[m
[31m-		$arUrlTemplates['~BUY_URL_TEMPLATE'] = $currentPath.$arParams["ACTION_VARIABLE"]."=BUY&".$arParams["PRODUCT_ID_VARIABLE"]."=#ID#";[m
[31m-		$arUrlTemplates['BUY_URL_TEMPLATE'] = htmlspecialcharsbx($arUrlTemplates['~BUY_URL_TEMPLATE']);[m
[31m-		$arUrlTemplates['~ADD_URL_TEMPLATE'] = $currentPath.$arParams["ACTION_VARIABLE"]."=ADD2BASKET&".$arParams["PRODUCT_ID_VARIABLE"]."=#ID#";[m
[31m-		$arUrlTemplates['ADD_URL_TEMPLATE'] = htmlspecialcharsbx($arUrlTemplates['~ADD_URL_TEMPLATE']);[m
[31m-		$arUrlTemplates['~SUBSCRIBE_URL_TEMPLATE'] = $currentPath.$arParams["ACTION_VARIABLE"]."=SUBSCRIBE_PRODUCT&".$arParams["PRODUCT_ID_VARIABLE"]."=#ID#";[m
[31m-		$arUrlTemplates['SUBSCRIBE_URL_TEMPLATE'] = htmlspecialcharsbx($arUrlTemplates['~SUBSCRIBE_URL_TEMPLATE']);[m
[31m-		$arUrlTemplates['~COMPARE_URL_TEMPLATE'] = $comparePath.$arParams["ACTION_VARIABLE"]."=ADD_TO_COMPARE_LIST&".$arParams["PRODUCT_ID_VARIABLE"]."=#ID#";[m
[31m-		$arUrlTemplates['COMPARE_URL_TEMPLATE'] = htmlspecialcharsbx($arUrlTemplates['~COMPARE_URL_TEMPLATE']);[m
[31m-		unset($comparePath, $currentPath);[m
[31m-[m
[31m-		$bIBlockCatalog = false;[m
[31m-		$arCatalog = false;[m
[31m-		$boolNeedCatalogCache = false;[m
[31m-		$bCatalog = Loader::includeModule('catalog');[m
[31m-		if ($bCatalog)[m
[31m-		{[m
[31m-			$arResultModules['catalog'] = true;[m
[31m-			$arResultModules['currency'] = true;[m
[31m-			$arCatalog = CCatalogSKU::GetInfoByIBlock($arParams["IBLOCK_ID"]);[m
[31m-			if (!empty($arCatalog) && is_array($arCatalog))[m
[31m-			{[m
[31m-				$bIBlockCatalog = $arCatalog['CATALOG_TYPE'] != CCatalogSKU::TYPE_PRODUCT;[m
[31m-				$boolNeedCatalogCache = true;[m
[31m-			}[m
[31m-		}[m
[31m-		$arResult['CATALOG'] = $arCatalog;[m
[31m-[m
[31m-		//This function returns array with prices description and access rights[m
[31m-		//in case catalog module n/a prices get values from element properties[m
[31m-		$arResultPrices = CIBlockPriceTools::GetCatalogPrices($arParams["IBLOCK_ID"], $arParams["PRICE_CODE"]);[m
[31m-		$arResultPricesAllow = CIBlockPriceTools::GetAllowCatalogPrices($arResultPrices);[m
[31m-[m
[31m-		if ($bCatalog && $boolNeedCatalogCache && !empty($arResultPricesAllow))[m
[31m-		{[m
[31m-			$boolNeedCatalogCache = CIBlockPriceTools::SetCatalogDiscountCache($arResultPricesAllow, $USER->GetUserGroupArray());[m
[31m-		}[m
[31m-[m
[31m-		$WF_SHOW_HISTORY = "N";[m
[31m-		if ($arParams["SHOW_WORKFLOW"] && CModule::IncludeModule("workflow"))[m
[31m-		{[m
[31m-			$arResultModules['workflow'] = true;[m
[31m-			$WF_ELEMENT_ID = CIBlockElement::WF_GetLast($arParams["ELEMENT_ID"]);[m
[31m-[m
[31m-			$WF_STATUS_ID = CIBlockElement::WF_GetCurrentStatus($WF_ELEMENT_ID, $WF_STATUS_TITLE);[m
[31m-			$WF_STATUS_PERMISSION = CIBlockElement::WF_GetStatusPermission($WF_STATUS_ID);[m
[31m-[m
[31m-			if ($WF_STATUS_ID == 1 || $WF_STATUS_PERMISSION < 1)[m
[31m-				$WF_ELEMENT_ID = $arParams["ELEMENT_ID"];[m
[31m-			else[m
[31m-				$WF_SHOW_HISTORY = "Y";[m
[31m-[m
[31m-			$arParams["ELEMENT_ID"] = $WF_ELEMENT_ID;[m
[31m-		}[m
[31m-		//SELECT[m
[31m-		$arSelect = array([m
[31m-			"ID",[m
[31m-			"IBLOCK_ID",[m
[31m-			"CODE",[m
[31m-			"XML_ID",[m
[31m-			"NAME",[m
[31m-			"ACTIVE",[m
[31m-			"DATE_ACTIVE_FROM",[m
[31m-			"DATE_ACTIVE_TO",[m
[31m-			"SORT",[m
[31m-			"PREVIEW_TEXT",[m
[31m-			"PREVIEW_TEXT_TYPE",[m
[31m-			"DETAIL_TEXT",[m
[31m-			"DETAIL_TEXT_TYPE",[m
[31m-			"DATE_CREATE",[m
[31m-			"CREATED_BY",[m
[31m-			"TIMESTAMP_X",[m
[31m-			"MODIFIED_BY",[m
[31m-			"TAGS",[m
[31m-			"IBLOCK_SECTION_ID",[m
[31m-			"DETAIL_PAGE_URL",[m
[31m-			"LIST_PAGE_URL",[m
[31m-			"DETAIL_PICTURE",[m
[31m-			"PREVIEW_PICTURE",[m
[31m-			"PROPERTY_*",[m
[31m-		);[m
[31m-		if ($bIBlockCatalog)[m
[31m-			$arSelect[] = 'CATALOG_QUANTITY';[m
[31m-		if ($arParams['SET_CANONICAL_URL'] === 'Y')[m
[31m-			$arSelect[] = 'CANONICAL_PAGE_URL';[m
[31m-		//WHERE[m
[31m-		$arFilter = array([m
[31m-			"ID" => $arParams["ELEMENT_ID"],[m
[31m-			"IBLOCK_ID" => $arParams["IBLOCK_ID"],[m
[31m-			"IBLOCK_LID" => SITE_ID,[m
[31m-			"IBLOCK_ACTIVE" => "Y",[m
[31m-			"ACTIVE_DATE" => "Y",[m
[31m-			"CHECK_PERMISSIONS" => "Y",[m
[31m-			"MIN_PERMISSION" => 'R',[m
[31m-			"SHOW_HISTORY" => $WF_SHOW_HISTORY,[m
[31m-		);[m
[31m-		if ($arParams["SHOW_DEACTIVATED"] !== "Y")[m
[31m-			$arFilter["ACTIVE"] = "Y";[m
[31m-[m
[31m-		//ORDER BY[m
[31m-		$arSort = array([m
[31m-		);[m
[31m-[m
[31m-		//PRICES[m
[31m-		$arPriceTypeID = array();[m
[31m-		if(!$arParams["USE_PRICE_COUNT"])[m
[31m-		{[m
[31m-			foreach($arResultPrices as &$value)[m
[31m-			{[m
[31m-				if (!$value['CAN_VIEW'] && !$value['CAN_BUY'])[m
[31m-					continue;[m
[31m-				$arSelect[] = $value["SELECT"];[m
[31m-				$arFilter["CATALOG_SHOP_QUANTITY_".$value["ID"]] = $arParams["SHOW_PRICE_COUNT"];[m
[31m-			}[m
[31m-			if (isset($value))[m
[31m-				unset($value);[m
[31m-		}[m
[31m-		else[m
[31m-		{[m
[31m-			foreach ($arResultPrices as &$value)[m
[31m-			{[m
[31m-				if (!$value['CAN_VIEW'] && !$value['CAN_BUY'])[m
[31m-					continue;[m
[31m-				$arPriceTypeID[] = $value["ID"];[m
[31m-			}[m
[31m-			if (isset($value))[m
[31m-				unset($value);[m
[31m-		}[m
[31m-[m
[31m-		$arSection = false;[m
[31m-		$arSectionFilter = array([m
[31m-			"IBLOCK_ID"=>$arParams["IBLOCK_ID"],[m
[31m-			"ACTIVE" => "Y",[m
[31m-		);[m
[31m-		if ($arParams["SECTION_ID"] > 0 || $arParams["SECTION_CODE"] !== '')[m
[31m-		{[m
[31m-			if($arParams["SECTION_ID"] > 0)[m
[31m-			{[m
[31m-				$arSectionFilter["ID"] = $arParams["SECTION_ID"];[m
[31m-			}[m
[31m-			else[m
[31m-			{[m
[31m-				$arSectionFilter["HAS_ELEMENT"] = $arParams["ELEMENT_ID"];[m
[31m-				$arSectionFilter["=CODE"] = $arParams["SECTION_CODE"];[m
[31m-			}[m
[31m-[m
[31m-			$rsSection = CIBlockSection::GetList(array(), $arSectionFilter);[m
[31m-			$rsSection->SetUrlTemplates("", $arParams["SECTION_URL"]);[m
[31m-			$arSection = $rsSection->GetNext();[m
[31m-		}[m
[31m-		elseif ($arParams['CHECK_SECTION_ID_VARIABLE'] === 'Y' && $arParams['FROM_SECTION'] !== '')[m
[31m-		{[m
[31m-			if (((int)$arParams['FROM_SECTION']).'|' == $arParams['FROM_SECTION'].'|')[m
[31m-			{[m
[31m-				$arSectionFilter["ID"] = $arParams['FROM_SECTION'];[m
[31m-			}[m
[31m-			else[m
[31m-			{[m
[31m-				$arSectionFilter["HAS_ELEMENT"] = $arParams["ELEMENT_ID"];[m
[31m-				$arSectionFilter["=CODE"] = $arParams['FROM_SECTION'];[m
[31m-			}[m
[31m-			$rsSection = CIBlockSection::GetList(array(), $arSectionFilter);[m
[31m-			$rsSection->SetUrlTemplates("", $arParams["SECTION_URL"]);[m
[31m-			$arSection = $rsSection->GetNext();[m
[31m-		}[m
[31m-[m
[31m-		$rsElement = CIBlockElement::GetList($arSort, $arFilter, false, false, $arSelect);[m
[31m-		$rsElement->SetUrlTemplates($arParams["DETAIL_URL"]);[m
[31m-		if(!$arParams["USE_MAIN_ELEMENT_SECTION"])[m
[31m-			$rsElement->SetSectionContext($arSection);[m
[31m-[m
[31m-		if($obElement = $rsElement->GetNextElement())[m
[31m-		{[m
[31m-			$arResult = $obElement->GetFields();[m
[31m-			$arResult = array_merge($arResult, $arUrlTemplates);[m
[31m-[m
[31m-			$arResult['ACTIVE_FROM'] = $arResult['DATE_ACTIVE_FROM'];[m
[31m-			$arResult['ACTIVE_TO'] = $arResult['DATE_ACTIVE_TO'];[m
[31m-[m
[31m-			$arResult['CONVERT_CURRENCY'] = $arConvertParams;[m
[31m-			$arResult['MODULES'] = $arResultModules;[m
[31m-[m
[31m-			$arResult["CAT_PRICES"] = $arResultPrices;[m
[31m-			$arResult['PRICES_ALLOW'] = $arResultPricesAllow;[m
[31m-[m
[31m-			$ipropValues = new \Bitrix\Iblock\InheritedProperty\ElementValues($arResult["IBLOCK_ID"], $arResult["ID"]);[m
[31m-			$arResult["IPROPERTY_VALUES"] = $ipropValues->getValues();[m
[31m-[m
[31m-			$arResult["PREVIEW_PICTURE"] = (0 < $arResult["PREVIEW_PICTURE"] ? CFile::GetFileArray($arResult["PREVIEW_PICTURE"]) : false);[m
[31m-			if ($arResult["PREVIEW_PICTURE"])[m
[31m-			{[m
[31m-				$arResult["PREVIEW_PICTURE"]["ALT"] = $arResult["IPROPERTY_VALUES"]["ELEMENT_PREVIEW_PICTURE_FILE_ALT"];[m
[31m-				if ($arResult["PREVIEW_PICTURE"]["ALT"] == "")[m
[31m-					$arResult["PREVIEW_PICTURE"]["ALT"] = $arResult["NAME"];[m
[31m-				$arResult["PREVIEW_PICTURE"]["TITLE"] = $arResult["IPROPERTY_VALUES"]["ELEMENT_PREVIEW_PICTURE_FILE_TITLE"];[m
[31m-				if ($arResult["PREVIEW_PICTURE"]["TITLE"] == "")[m
[31m-					$arResult["PREVIEW_PICTURE"]["TITLE"] = $arResult["NAME"];[m
[31m-			}[m
[31m-			$arResult["DETAIL_PICTURE"] = (0 < $arResult["DETAIL_PICTURE"] ? CFile::GetFileArray($arResult["DETAIL_PICTURE"]) : false);[m
[31m-			if ($arResult["DETAIL_PICTURE"])[m
[31m-			{[m
[31m-				$arResult["DETAIL_PICTURE"]["ALT"] = $arResult["IPROPERTY_VALUES"]["ELEMENT_DETAIL_PICTURE_FILE_ALT"];[m
[31m-				if ($arResult["DETAIL_PICTURE"]["ALT"] == "")[m
[31m-					$arResult["DETAIL_PICTURE"]["ALT"] = $arResult["NAME"];[m
[31m-				$arResult["DETAIL_PICTURE"]["TITLE"] = $arResult["IPROPERTY_VALUES"]["ELEMENT_DETAIL_PICTURE_FILE_TITLE"];[m
[31m-				if ($arResult["DETAIL_PICTURE"]["TITLE"] == "")[m
[31m-					$arResult["DETAIL_PICTURE"]["TITLE"] = $arResult["NAME"];[m
[31m-			}[m
[31m-[m
[31m-			$arResult["PROPERTIES"] = $obElement->GetProperties();[m
[31m-			if ($bCatalog && $boolNeedCatalogCache)[m
[31m-			{[m
[31m-				CCatalogDiscount::SetProductPropertiesCache($arResult['ID'], $arResult["PROPERTIES"]);[m
[31m-			}[m
[31m-[m
[31m-			$arResult["DISPLAY_PROPERTIES"] = array();[m
[31m-			foreach($arParams["PROPERTY_CODE"] as $pid)[m
[31m-			{[m
[31m-				if (!isset($arResult["PROPERTIES"][$pid]))[m
[31m-					continue;[m
[31m-				$prop = &$arResult["PROPERTIES"][$pid];[m
[31m-				$boolArr = is_array($prop["VALUE"]);[m
[31m-				if([m
[31m-					($boolArr && !empty($prop["VALUE"]))[m
[31m-					|| (!$boolArr && strlen($prop["VALUE"])>0)[m
[31m-				)[m
[31m-				{[m
[31m-					$arResult["DISPLAY_PROPERTIES"][$pid] = CIBlockFormatProperties::GetDisplayValue($arResult, $prop, "catalog_out");[m
[31m-				}[m
[31m-			}[m
[31m-[m
[31m-			$arResult["PRODUCT_PROPERTIES"] = array();[m
[31m-			$arResult['PRODUCT_PROPERTIES_FILL'] = array();[m
[31m-			if ($arParams['ADD_PROPERTIES_TO_BASKET'] == 'Y' && !empty($arParams["PRODUCT_PROPERTIES"]))[m
[31m-			{[m
[31m-				$arResult["PRODUCT_PROPERTIES"] = CIBlockPriceTools::GetProductProperties([m
[31m-					$arParams["IBLOCK_ID"],[m
[31m-					$arResult["ID"],[m
[31m-					$arParams["PRODUCT_PROPERTIES"],[m
[31m-					$arResult["PROPERTIES"][m
[31m-				);[m
[31m-				if (!empty($arResult['PRODUCT_PROPERTIES']))[m
[31m-				{[m
[31m-					$arResult['PRODUCT_PROPERTIES_FILL'] = CIBlockPriceTools::getFillProductProperties($arResult['PRODUCT_PROPERTIES']);[m
[31m-				}[m
[31m-			}[m
[31m-[m
[31m-			$arResult["MORE_PHOTO"] = array();[m
[31m-			if(isset($arResult["PROPERTIES"]["MORE_PHOTO"]["VALUE"]) && is_array($arResult["PROPERTIES"]["MORE_PHOTO"]["VALUE"]))[m
[31m-			{[m
[31m-				foreach($arResult["PROPERTIES"]["MORE_PHOTO"]["VALUE"] as $FILE)[m
[31m-				{[m
[31m-					$FILE = CFile::GetFileArray($FILE);[m
[31m-					if(is_array($FILE))[m
[31m-						$arResult["MORE_PHOTO"][]=$FILE;[m
[31m-				}[m
[31m-			}[m
[31m-[m
[31m-			$arResult["LINKED_ELEMENTS"] = array();[m
[31m-			if(strlen($arParams["LINK_PROPERTY_SID"])>0 && strlen($arParams["LINK_IBLOCK_TYPE"])>0 && $arParams["LINK_IBLOCK_ID"]>0)[m
[31m-			{[m
[31m-				$rsLinkElements = CIBlockElement::GetList([m
[31m-					array("SORT" => "ASC"),[m
[31m-					array([m
[31m-						"IBLOCK_ID" => $arParams["LINK_IBLOCK_ID"],[m
[31m-						"IBLOCK_ACTIVE" => "Y",[m
[31m-						"ACTIVE_DATE" => "Y",[m
[31m-						"ACTIVE" => "Y",[m
[31m-						"CHECK_PERMISSIONS" => "Y",[m
[31m-						"IBLOCK_TYPE" => $arParams["LINK_IBLOCK_TYPE"],[m
[31m-						"PROPERTY_".$arParams["LINK_PROPERTY_SID"] => $arResult["ID"],[m
[31m-					),[m
[31m-					false,[m
[31m-					false,[m
[31m-					Array("ID","IBLOCK_ID","NAME","DETAIL_PAGE_URL","IBLOCK_NAME")[m
[31m-				);[m
[31m-				while($ar = $rsLinkElements->GetNext())[m
[31m-					$arResult["LINKED_ELEMENTS"][]=$ar;[m
[31m-			}[m
[31m-[m
[31m-			if(!$arSection && $arResult["IBLOCK_SECTION_ID"] > 0)[m
[31m-			{[m
[31m-				$arSectionFilter = array([m
[31m-					"ID" => $arResult["IBLOCK_SECTION_ID"],[m
[31m-					"IBLOCK_ID" => $arResult["IBLOCK_ID"],[m
[31m-					"ACTIVE" => "Y",[m
[31m-				);[m
[31m-				$rsSection = CIBlockSection::GetList(Array(),$arSectionFilter);[m
[31m-				$rsSection->SetUrlTemplates("", $arParams["SECTION_URL"]);[m
[31m-				$arSection = $rsSection->GetNext();[m
[31m-			}[m
[31m-[m
[31m-			if($arSection)[m
[31m-			{[m
[31m-				$arSection["PATH"] = array();[m
[31m-				$rsPath = CIBlockSection::GetNavChain($arResult["IBLOCK_ID"], $arSection["ID"]);[m
[31m-				$rsPath->SetUrlTemplates("", $arParams["SECTION_URL"]);[m
[31m-				while($arPath = $rsPath->GetNext())[m
[31m-				{[m
[31m-					$ipropValues = new \Bitrix\Iblock\InheritedProperty\SectionValues($arParams["IBLOCK_ID"], $arPath["ID"]);[m
[31m-					$arPath["IPROPERTY_VALUES"] = $ipropValues->getValues();[m
[31m-					$arSection["PATH"][] = $arPath;[m
[31m-				}[m
[31m-				$arResult["SECTION"] = $arSection;[m
[31m-			}[m
[31m-[m
[31m-			if ($bCatalog && $bIBlockCatalog)[m
[31m-			{[m
[31m-				if (!isset($arResult["CATALOG_MEASURE_RATIO"]))[m
[31m-					$arResult["CATALOG_MEASURE_RATIO"] = 1;[m
[31m-				if (!isset($arResult['CATALOG_MEASURE']))[m
[31m-					$arResult['CATALOG_MEASURE'] = 0;[m
[31m-				$arResult['CATALOG_MEASURE'] = (int)$arResult['CATALOG_MEASURE'];[m
[31m-				if (0 > $arResult['CATALOG_MEASURE'])[m
[31m-					$arResult['CATALOG_MEASURE'] = 0;[m
[31m-				if (!isset($arResult['CATALOG_MEASURE_NAME']))[m
[31m-					$arResult['CATALOG_MEASURE_NAME'] = '';[m
[31m-				$rsRatios = CCatalogMeasureRatio::getList([m
[31m-					array(),[m
[31m-					array('PRODUCT_ID' => $arResult['ID']),[m
[31m-					false,[m
[31m-					false,[m
[31m-					array('PRODUCT_ID', 'RATIO')[m
[31m-				);[m
[31m-				if ($arRatio = $rsRatios->Fetch())[m
[31m-				{[m
[31m-					$intRatio = (int)$arRatio['RATIO'];[m
[31m-					$dblRatio = doubleval($arRatio['RATIO']);[m
[31m-					$mxRatio = ($dblRatio > $intRatio ? $dblRatio : $intRatio);[m
[31m-					if (CATALOG_VALUE_EPSILON > abs($mxRatio))[m
[31m-						$mxRatio = 1;[m
[31m-					elseif (0 > $mxRatio)[m
[31m-						$mxRatio = 1;[m
[31m-					$arResult["CATALOG_MEASURE_RATIO"] = $mxRatio;[m
[31m-				}[m
[31m-				if (0 < $arResult['CATALOG_MEASURE'])[m
[31m-				{[m
[31m-					$rsMeasures = CCatalogMeasure::getList([m
[31m-						array(),[m
[31m-						array('ID' => $arResult['CATALOG_MEASURE']),[m
[31m-						false,[m
[31m-						false,[m
[31m-						array('ID', 'SYMBOL_RUS')[m
[31m-					);[m
[31m-					if ($arMeasure = $rsMeasures->GetNext())[m
[31m-					{[m
[31m-						$arResult['CATALOG_MEASURE_NAME'] = $arMeasure['SYMBOL_RUS'];[m
[31m-						$arResult['~CATALOG_MEASURE_NAME'] = $arMeasure['~SYMBOL_RUS'];[m
[31m-					}[m
[31m-				}[m
[31m-				if ('' == $arResult['CATALOG_MEASURE_NAME'])[m
[31m-				{[m
[31m-					$arDefaultMeasure = CCatalogMeasure::getDefaultMeasure(true, true);[m
[31m-					$arResult['CATALOG_MEASURE_NAME'] = $arDefaultMeasure['SYMBOL_RUS'];[m
[31m-					$arResult['~CATALOG_MEASURE_NAME'] = $arDefaultMeasure['~SYMBOL_RUS'];[m
[31m-				}[m
[31m-			}[m
[31m-			$arResult["PRICE_MATRIX"] = false;[m
[31m-			$arResult["PRICES"] = array();[m
[31m-			$arResult['MIN_PRICE'] = false;[m
[31m-			if($arParams["USE_PRICE_COUNT"])[m
[31m-			{[m
[31m-				if($bCatalog)[m
[31m-				{[m
[31m-					$arResult["PRICE_MATRIX"] = CatalogGetPriceTableEx($arResult["ID"], 0, $arPriceTypeID, 'Y', $arConvertParams);[m
[31m-					if (isset($arResult["PRICE_MATRIX"]["COLS"]) && is_array($arResult["PRICE_MATRIX"]["COLS"]))[m
[31m-					{[m
[31m-						foreach($arResult["PRICE_MATRIX"]["COLS"] as $keyColumn=>$arColumn)[m
[31m-							$arResult["PRICE_MATRIX"]["COLS"][$keyColumn]["NAME_LANG"] = htmlspecialcharsbx($arColumn["NAME_LANG"]);[m
[31m-					}[m
[31m-				}[m
[31m-			}[m
[31m-			else[m
[31m-			{[m
[31m-				$arResult["PRICES"] = CIBlockPriceTools::GetItemPrices($arParams["IBLOCK_ID"], $arResult["CAT_PRICES"], $arResult, $arParams['PRICE_VAT_INCLUDE'], $arConvertParams);[m
[31m-				if (!empty($arResult["PRICES"]))[m
[31m-				{[m
[31m-					foreach ($arResult['PRICES'] as &$arOnePrice)[m
[31m-					{[m
[31m-						if ('Y' == $arOnePrice['MIN_PRICE'])[m
[31m-						{[m
[31m-							$arResult['MIN_PRICE'] = $arOnePrice;[m
[31m-							break;[m
[31m-						}[m
[31m-					}[m
[31m-					unset($arOnePrice);[m
[31m-				}[m
[31m-			}[m
[31m-[m
[31m-			$arResult["CAN_BUY"] = CIBlockPriceTools::CanBuy($arParams["IBLOCK_ID"], $arResult["CAT_PRICES"], $arResult);[m
[31m-[m
[31m-			$arResult['~BUY_URL'] = str_replace('#ID#', $arResult["ID"], $arResult['~BUY_URL_TEMPLATE']);[m
[31m-			$arResult['BUY_URL'] = str_replace('#ID#', $arResult["ID"], $arResult['BUY_URL_TEMPLATE']);[m
[31m-			$arResult['~ADD_URL'] = str_replace('#ID#', $arResult["ID"], $arResult['~ADD_URL_TEMPLATE']);[m
[31m-			$arResult['ADD_URL'] = str_replace('#ID#', $arResult["ID"], $arResult['ADD_URL_TEMPLATE']);[m
[31m-			$arResult['LINK_URL'] = str_replace([m
[31m-						array("#ELEMENT_ID#","#SECTION_ID#"),[m
[31m-						array($arResult["ID"],$arResult["SECTION"]["ID"]),[m
[31m-						$arParams["LINK_ELEMENTS_URL"][m
[31m-					);[m
[31m-			$arResult['~SUBSCRIBE_URL'] = str_replace('#ID#', $arResult["ID"], $arResult['~SUBSCRIBE_URL_TEMPLATE']);[m
[31m-			$arResult['SUBSCRIBE_URL'] = str_replace('#ID#', $arResult["ID"], $arResult['SUBSCRIBE_URL_TEMPLATE']);[m
[31m-			if ($arParams['DISPLAY_COMPARE'])[m
[31m-			{[m
[31m-				$arResult['~COMPARE_URL'] = str_replace('#ID#', $arResult["ID"], $arResult['~COMPARE_URL_TEMPLATE']);[m
[31m-				$arResult['COMPARE_URL'] = str_replace('#ID#', $arResult["ID"], $arResult['COMPARE_URL_TEMPLATE']);[m
[31m-			}[m
[31m-[m
[31m-			if(!isset($arParams["OFFERS_FIELD_CODE"]))[m
[31m-				$arParams["OFFERS_FIELD_CODE"] = array();[m
[31m-			elseif (!is_array($arParams["OFFERS_FIELD_CODE"]))[m
[31m-				$arParams["OFFERS_FIELD_CODE"] = array($arParams["OFFERS_FIELD_CODE"]);[m
[31m-			foreach($arParams["OFFERS_FIELD_CODE"] as $key => $value)[m
[31m-				if($value === "")[m
[31m-					unset($arParams["OFFERS_FIELD_CODE"][$key]);[m
[31m-[m
[31m-			if(!isset($arParams["OFFERS_PROPERTY_CODE"]))[m
[31m-				$arParams["OFFERS_PROPERTY_CODE"] = array();[m
[31m-			elseif (!is_array($arParams["OFFERS_PROPERTY_CODE"]))[m
[31m-				$arParams["OFFERS_PROPERTY_CODE"] = array($arParams["OFFERS_PROPERTY_CODE"]);[m
[31m-			if (!in_array('PREVIEW_PICTURE', $arParams["OFFERS_PROPERTY_CODE"]))[m
[31m-				$arParams["OFFERS_PROPERTY_CODE"][] = 'PREVIEW_PICTURE';[m
[31m-			if (!in_array('DETAIL_PICTURE', $arParams["OFFERS_PROPERTY_CODE"]))[m
[31m-				$arParams["OFFERS_PROPERTY_CODE"][] = 'DETAIL_PICTURE';[m
[31m-			foreach($arParams["OFFERS_PROPERTY_CODE"] as $key => $value)[m
[31m-				if($value === "")[m
[31m-					unset($arParams["OFFERS_PROPERTY_CODE"][$key]);[m
[31m-[m
[31m-			$arResult["OFFERS"] = array();[m
[31m-			if([m
[31m-				$bCatalog[m
[31m-				&& ([m
[31m-					!empty($arParams["OFFERS_FIELD_CODE"])[m
[31m-					|| !empty($arParams["OFFERS_PROPERTY_CODE"])[m
[31m-				)[m
[31m-			)[m
[31m-			{[m
[31m-				$offersFilter = array([m
[31m-					'IBLOCK_ID' => $arParams['IBLOCK_ID'],[m
[31m-					'HIDE_NOT_AVAILABLE' => $arParams['HIDE_NOT_AVAILABLE'][m
[31m-				);[m
[31m-				if (!$arParams["USE_PRICE_COUNT"])[m
[31m-				{[m
[31m-					$offersFilter['SHOW_PRICE_COUNT'] = $arParams['SHOW_PRICE_COUNT'];[m
[31m-				}[m
[31m-				$arOffers = CIBlockPriceTools::GetOffersArray([m
[31m-					$offersFilter,[m
[31m-					array($arResult["ID"]),[m
[31m-					array([m
[31m-						$arParams["OFFERS_SORT_FIELD"] => $arParams["OFFERS_SORT_ORDER"],[m
[31m-						$arParams["OFFERS_SORT_FIELD2"] => $arParams["OFFERS_SORT_ORDER2"],[m
[31m-					),[m
[31m-					$arParams["OFFERS_FIELD_CODE"],[m
[31m-					$arParams["OFFERS_PROPERTY_CODE"],[m
[31m-					$arParams["OFFERS_LIMIT"],[m
[31m-					$arResult["CAT_PRICES"],[m
[31m-					$arParams['PRICE_VAT_INCLUDE'],[m
[31m-					$arConvertParams[m
[31m-				);[m
[31m-				foreach($arOffers as $arOffer)[m
[31m-				{[m
[31m-					$arOffer['~BUY_URL'] = str_replace('#ID#', $arOffer["ID"], $arResult['~BUY_URL_TEMPLATE']);[m
[31m-					$arOffer['BUY_URL'] = str_replace('#ID#', $arOffer["ID"], $arResult['BUY_URL_TEMPLATE']);[m
[31m-					$arOffer['~ADD_URL'] = str_replace('#ID#', $arOffer["ID"], $arResult['~ADD_URL_TEMPLATE']);[m
[31m-					$arOffer['ADD_URL'] = str_replace('#ID#', $arOffer["ID"], $arResult['ADD_URL_TEMPLATE']);[m
[31m-					if ($arParams['DISPLAY_COMPARE'])[m
[31m-					{[m
[31m-						$arOffer['~COMPARE_URL'] = str_replace('#ID#', $arOffer["ID"], $arResult['~COMPARE_URL_TEMPLATE']);[m
[31m-						$arOffer['COMPARE_URL'] = str_replace('#ID#', $arOffer["ID"], $arResult['COMPARE_URL_TEMPLATE']);[m
[31m-					}[m
[31m-					$arOffer['~SUBSCRIBE_URL'] = str_replace('#ID#', $arOffer["ID"], $arResult['~SUBSCRIBE_URL_TEMPLATE']);[m
[31m-					$arOffer['SUBSCRIBE_URL'] = str_replace('#ID#', $arOffer["ID"], $arResult['SUBSCRIBE_URL_TEMPLATE']);[m
[31m-[m
[31m-					$arResult["OFFERS"][] = $arOffer;[m
[31m-				}[m
[31m-			}[m
[31m-[m
[31m-			if ('Y' == $arParams['CONVERT_CURRENCY'])[m
[31m-			{[m
[31m-				$arCurrencyList = array();[m
[31m-				if ($arParams["USE_PRICE_COUNT"])[m
[31m-				{[m
[31m-					if (!empty($arResult["PRICE_MATRIX"]) && is_array($arResult["PRICE_MATRIX"]))[m
[31m-					{[m
[31m-						if (isset($arResult["PRICE_MATRIX"]['CURRENCY_LIST']) && is_array($arResult["PRICE_MATRIX"]['CURRENCY_LIST']))[m
[31m-							$arCurrencyList = $arResult["PRICE_MATRIX"]['CURRENCY_LIST'];[m
[31m-					}[m
[31m-				}[m
[31m-				else[m
[31m-				{[m
[31m-					if (!empty($arResult["PRICES"]))[m
[31m-					{[m
[31m-						foreach ($arResult["PRICES"] as &$arOnePrices)[m
[31m-						{[m
[31m-							if (isset($arOnePrices['ORIG_CURRENCY']))[m
[31m-								$arCurrencyList[] = $arOnePrices['ORIG_CURRENCY'];[m
[31m-						}[m
[31m-						if (isset($arOnePrices))[m
[31m-							unset($arOnePrices);[m
[31m-					}[m
[31m-				}[m
[31m-				if (!empty($arResult["OFFERS"]))[m
[31m-				{[m
[31m-					foreach ($arResult["OFFERS"] as &$arOneOffer)[m
[31m-					{[m
[31m-						if (!empty($arOneOffer['PRICES']))[m
[31m-						{[m
[31m-							foreach ($arOneOffer['PRICES'] as &$arOnePrices)[m
[31m-							{[m
[31m-								if (isset($arOnePrices['ORIG_CURRENCY']))[m
[31m-									$arCurrencyList[] = $arOnePrices['ORIG_CURRENCY'];[m
[31m-							}[m
[31m-							if (isset($arOnePrices))[m
[31m-								unset($arOnePrices);[m
[31m-						}[m
[31m-					}[m
[31m-					if (isset($arOneOffer))[m
[31m-						unset($arOneOffer);[m
[31m-				}[m
[31m-				if (!empty($arCurrencyList) && defined("BX_COMP_MANAGED_CACHE"))[m
[31m-				{[m
[31m-					$arCurrencyList[] = $arConvertParams['CURRENCY_ID'];[m
[31m-					$arCurrencyList = array_unique($arCurrencyList);[m
[31m-					$CACHE_MANAGER->StartTagCache($this->GetCachePath());[m
[31m-					foreach ($arCurrencyList as &$strOneCurrency)[m
[31m-					{[m
[31m-						$CACHE_MANAGER->RegisterTag("currency_id_".$strOneCurrency);[m
[31m-					}[m
[31m-					if (isset($strOneCurrency))[m
[31m-						unset($strOneCurrency);[m
[31m-					$CACHE_MANAGER->EndTagCache();[m
[31m-				}[m
[31m-			}[m
[31m-[m
[31m-			$resultCacheKeys = array([m
[31m-				"IBLOCK_ID",[m
[31m-				"ID",[m
[31m-				"IBLOCK_SECTION_ID",[m
[31m-				"NAME",[m
[31m-				"LIST_PAGE_URL",[m
[31m-				"CANONICAL_PAGE_URL",[m
[31m-				"PROPERTIES",[m
[31m-				"SECTION",[m
[31m-				"IPROPERTY_VALUES",[m
[31m-				"TIMESTAMP_X",[m
[31m-			);[m
[31m-[m
[31m-			if ($bCatalog)[m
[31m-			{[m
[31m-				// catalog hit stats[m
[31m-				$productTitle = !empty($arResult["IPROPERTY_VALUES"]["ELEMENT_PAGE_TITLE"])[m
[31m-					? $arResult["IPROPERTY_VALUES"]["ELEMENT_PAGE_TITLE"][m
[31m-					: $arResult["NAME"];[m
[31m-[m
[31m-				$categoryId = '';[m
[31m-				$categoryPath = array();[m
[31m-[m
[31m-				if (isset($arResult['SECTION']['ID']))[m
[31m-				{[m
[31m-					$categoryId = $arResult['SECTION']['ID'];[m
[31m-				}[m
[31m-[m
[31m-				if (isset($arResult['SECTION']['PATH']))[m
[31m-				{[m
[31m-					foreach ($arResult['SECTION']['PATH'] as $cat)[m
[31m-					{[m
[31m-						$categoryPath[$cat['ID']] = $cat['NAME'];[m
[31m-					}[m
[31m-				}[m
[31m-[m
[31m-				$counterData = array([m
[31m-					'product_id' => $arResult["ID"],[m
[31m-					'iblock_id' => $arParams['IBLOCK_ID'],[m
[31m-					'product_title' => $productTitle,[m
[31m-					'category_id' => $categoryId,[m
[31m-					'category' => $categoryPath,[m
[31m-				);[m
[31m-[m
[31m-				if (empty($arResult["OFFERS"]))[m
[31m-				{[m
[31m-					$counterData['price'] = (isset($arResult['MIN_PRICE']) ? $arResult['MIN_PRICE']['DISCOUNT_VALUE'] : '');[m
[31m-					$counterData['currency'] = (isset($arResult['MIN_PRICE']) ? $arResult['MIN_PRICE']['CURRENCY'] : '');[m
[31m-				}[m
[31m-				else[m
[31m-				{[m
[31m-					$offer = current($arResult["OFFERS"]);[m
[31m-					$counterData['price'] = (isset($offer['MIN_PRICE']) ? $offer['MIN_PRICE']['DISCOUNT_VALUE'] : '');[m
[31m-					$counterData['currency'] = (isset($offer['MIN_PRICE']) ? $offer['MIN_PRICE']['CURRENCY'] : '');[m
[31m-					unset($offer);[m
[31m-				}[m
[31m-[m
[31m-				// make sure it is in utf8[m
[31m-				$counterData = \Bitrix\Main\Text\Encoding::convertEncodingArray($counterData, SITE_CHARSET, 'UTF-8');[m
[31m-[m
[31m-				// pack value and protocol version[m
[31m-				$rcmLogCookieName = COption::GetOptionString("main", "cookie_name", "BITRIX_SM")."_".\Bitrix\Main\Analytics\Catalog::getCookieLogName();[m
[31m-[m
[31m-				$arResult['counterData'] = array([m
[31m-					'item' => base64_encode(json_encode($counterData)),[m
[31m-					'user_id' => new \Bitrix\Main\Text\JsExpression([m
[31m-						"function() {[m
[31m-							return BX.message(\"USER_ID\") ? BX.message(\"USER_ID\") : 0;[m
[31m-						}"[m
[31m-					),[m
[31m-					'recommendation' => new \Bitrix\Main\Text\JsExpression([m
[31m-						"function() {[m
[31m-[m
[31m-							var rcmId = \"\";[m
[31m-[m
[31m-							var cookieValue = BX.getCookie(\"{$rcmLogCookieName}\");[m
[31m-							var productId = {$arResult["ID"]};[m
[31m-[m
[31m-							var cItems = [],[m
[31m-								cItem;[m
[31m-[m
[31m-							if (cookieValue)[m
[31m-							{[m
[31m-								cItems = cookieValue.split('.');[m
[31m-							}[m
[31m-[m
[31m-							var i = cItems.length;[m
[31m-[m
[31m-							while (i--)[m
[31m-							{[m
[31m-								cItem = cItems[i].split('-');[m
[31m-[m
[31m-								if (cItem[0] == productId)[m
[31m-								{[m
[31m-									rcmId = cItem[1];[m
[31m-									break;[m
[31m-								}[m
[31m-							}[m
[31m-[m
[31m-							return rcmId;[m
[31m-						}"[m
[31m-					),[m
[31m-					'v' => '2'[m
[31m-				);[m
[31m-				$resultCacheKeys[] = 'counterData';[m
[31m-			}[m
[31m-[m
[31m-			$this->SetResultCacheKeys($resultCacheKeys);[m
[31m-[m
[31m-			// standard output[m
[31m-			$this->IncludeComponentTemplate();[m
[31m-[m
[31m-			if ($bCatalog && $boolNeedCatalogCache)[m
[31m-			{[m
[31m-				CCatalogDiscount::ClearDiscountCache(array([m
[31m-					'PRODUCT' => true,[m
[31m-					'SECTIONS' => true,[m
[31m-					'PROPERTIES' => true[m
[31m-				));[m
[31m-			}[m
[31m-		}[m
[31m-		else[m
[31m-		{[m
[31m-			$this->AbortResultCache();[m
[31m-			\Bitrix\Iblock\Component\Tools::process404([m
[31m-				trim($arParams["MESSAGE_404"]) ?: GetMessage("CATALOG_ELEMENT_NOT_FOUND")[m
[31m-				,true[m
[31m-				,$arParams["SET_STATUS_404"] === "Y"[m
[31m-				,$arParams["SHOW_404"] === "Y"[m
[31m-				,$arParams["FILE_404"][m
[31m-			);[m
[31m-		}[m
[31m-	}[m
[31m-	else[m
[31m-	{[m
[31m-		$this->AbortResultCache();[m
[31m-		\Bitrix\Iblock\Component\Tools::process404([m
[31m-			trim($arParams["MESSAGE_404"]) ?: GetMessage("CATALOG_ELEMENT_NOT_FOUND")[m
[31m-			,true[m
[31m-			,$arParams["SET_STATUS_404"] === "Y"[m
[31m-			,$arParams["SHOW_404"] === "Y"[m
[31m-			,$arParams["FILE_404"][m
[31m-		);[m
[31m-	}[m
[31m-}[m
[31m-[m
[31m-if(isset($arResult["ID"]))[m
[31m-{[m
[31m-	if (isset($arResult['counterData']))[m
[31m-	{[m
[31m-		// send counter data[m
[31m-		if (\Bitrix\Main\Analytics\Catalog::isOn())[m
[31m-		{[m
[31m-			\Bitrix\Main\Analytics\Counter::sendData('ct', $arResult['counterData']);[m
[31m-		}[m
[31m-	}[m
[31m-[m
[31m-	if ('N' != $arParams['USE_ELEMENT_COUNTER'])[m
[31m-	{[m
[31m-		if (Loader::includeModule('iblock'))[m
[31m-		{[m
[31m-			CIBlockElement::CounterInc($arResult["ID"]);[m
[31m-		}[m
[31m-	}[m
[31m-[m
[31m-	if ($arParams['SET_CANONICAL_URL'] === 'Y' && $arResult["CANONICAL_PAGE_URL"])[m
[31m-	{[m
[31m-		$APPLICATION->SetPageProperty('canonical', $arResult["CANONICAL_PAGE_URL"]);[m
[31m-	}[m
[31m-[m
[31m-	if (!isset($_SESSION["VIEWED_ENABLE"]) && isset($_SESSION["VIEWED_PRODUCT"]) && $_SESSION["VIEWED_PRODUCT"] != $arResult["ID"] && Loader::includeModule("sale"))[m
[31m-	{[m
[31m-		$_SESSION["VIEWED_ENABLE"] = "Y";[m
[31m-		$arFields = array([m
[31m-			"PRODUCT_ID" => (int)$_SESSION["VIEWED_PRODUCT"],[m
[31m-			"MODULE" => "catalog",[m
[31m-			"LID" => SITE_ID[m
[31m-		);[m
[31m-		CSaleViewedProduct::Add($arFields);[m
[31m-	}[m
[31m-[m
[31m-	if (isset($_SESSION["VIEWED_ENABLE"]) && $_SESSION["VIEWED_ENABLE"] == "Y" && $_SESSION["VIEWED_PRODUCT"] != $arResult["ID"] && Loader::includeModule("sale"))[m
[31m-	{[m
[31m-		$arFields = array([m
[31m-			"PRODUCT_ID" => $arResult["ID"],[m
[31m-			"MODULE" => "catalog",[m
[31m-			"LID" => SITE_ID,[m
[31m-			"IBLOCK_ID" => $arResult["IBLOCK_ID"][m
[31m-		);[m
[31m-		CSaleViewedProduct::Add($arFields);[m
[31m-	}[m
[31m-[m
[31m-	$_SESSION["VIEWED_PRODUCT"] = $arResult["ID"];[m
[31m-[m
[31m-	$arTitleOptions = null;[m
[31m-	if($USER->IsAuthorized())[m
[31m-	{[m
[31m-		if([m
[31m-			$APPLICATION->GetShowIncludeAreas()[m
[31m-			|| $arParams["SET_TITLE"][m
[31m-			|| isset($arResult[$arParams["BROWSER_TITLE"]])[m
[31m-		)[m
[31m-		{[m
[31m-			if (Loader::includeModule('iblock'))[m
[31m-			{[m
[31m-				$arReturnUrl = array([m
[31m-					"add_element" => CIBlock::GetArrayByID($arParams["IBLOCK_ID"], "DETAIL_PAGE_URL"),[m
[31m-					"delete_element" => ([m
[31m-						isset($arResult["SECTION"])?[m
[31m-						$arResult["SECTION"]["SECTION_PAGE_URL"]:[m
[31m-						$arResult["LIST_PAGE_URL"][m
[31m-					),[m
[31m-				);[m
[31m-				$arButtons = CIBlock::GetPanelButtons($arResult["IBLOCK_ID"], $arResult["ID"], $arResult["IBLOCK_SECTION_ID"], Array("RETURN_URL" =>  $arReturnUrl, "CATALOG"=>true));[m
[31m-[m
[31m-				if($APPLICATION->GetShowIncludeAreas())[m
[31m-					$this->AddIncludeAreaIcons(CIBlock::GetComponentMenu($APPLICATION->GetPublicShowMode(), $arButtons));[m
[31m-[m
[31m-				if($arParams["SET_TITLE"] || isset($arResult[$arParams["BROWSER_TITLE"]]))[m
[31m-				{[m
[31m-					$arTitleOptions = array([m
[31m-						'ADMIN_EDIT_LINK' => $arButtons["submenu"]["edit_element"]["ACTION"],[m
[31m-						'PUBLIC_EDIT_LINK' => $arButtons["edit"]["edit_element"]["ACTION"],[m
[31m-						'COMPONENT_NAME' => $this->GetName(),[m
[31m-					);[m
[31m-				}[m
[31m-			}[m
[31m-		}[m
[31m-	}[m
[31m-[m
[31m-	if($arParams["SET_TITLE"])[m
[31m-	{[m
[31m-		if ($arResult["IPROPERTY_VALUES"]["ELEMENT_PAGE_TITLE"] != "")[m
[31m-			$APPLICATION->SetTitle($arResult["IPROPERTY_VALUES"]["ELEMENT_PAGE_TITLE"], $arTitleOptions);[m
[31m-		else[m
[31m-			$APPLICATION->SetTitle($arResult["NAME"], $arTitleOptions);[m
[31m-	}[m
[31m-[m
[31m-	if ($arParams["SET_BROWSER_TITLE"] === 'Y')[m
[31m-	{[m
[31m-		$browserTitle = Collection::firstNotEmpty([m
[31m-			$arResult["PROPERTIES"], array($arParams["BROWSER_TITLE"], "VALUE")[m
[31m-			,$arResult, $arParams["BROWSER_TITLE"][m
[31m-			,$arResult["IPROPERTY_VALUES"], "ELEMENT_META_TITLE"[m
[31m-		);[m
[31m-		if (is_array($browserTitle))[m
[31m-			$APPLICATION->SetPageProperty("title", implode(" ", $browserTitle), $arTitleOptions);[m
[31m-		elseif ($browserTitle != "")[m
[31m-			$APPLICATION->SetPageProperty("title", $browserTitle, $arTitleOptions);[m
[31m-	}[m
[31m-[m
[31m-	if ($arParams["SET_META_KEYWORDS"] === 'Y')[m
[31m-	{[m
[31m-		$metaKeywords = Collection::firstNotEmpty([m
[31m-			$arResult["PROPERTIES"], array($arParams["META_KEYWORDS"], "VALUE")[m
[31m-			,$arResult["IPROPERTY_VALUES"], "ELEMENT_META_KEYWORDS"[m
[31m-		);[m
[31m-		if (is_array($metaKeywords))[m
[31m-			$APPLICATION->SetPageProperty("keywords", implode(" ", $metaKeywords), $arTitleOptions);[m
[31m-		elseif ($metaKeywords != "")[m
[31m-			$APPLICATION->SetPageProperty("keywords", $metaKeywords, $arTitleOptions);[m
[31m-	}[m
[31m-[m
[31m-	if ($arParams["SET_META_DESCRIPTION"] === 'Y')[m
[31m-	{[m
[31m-		$metaDescription = Collection::firstNotEmpty([m
[31m-			$arResult["PROPERTIES"], array($arParams["META_DESCRIPTION"], "VALUE")[m
[31m-			,$arResult["IPROPERTY_VALUES"], "ELEMENT_META_DESCRIPTION"[m
[31m-		);[m
[31m-		if (is_array($metaDescription))[m
[31m-			$APPLICATION->SetPageProperty("description", implode(" ", $metaDescription), $arTitleOptions);[m
[31m-		elseif ($metaDescription != "")[m
[31m-			$APPLICATION->SetPageProperty("description", $metaDescription, $arTitleOptions);[m
[31m-	}[m
[31m-[m
[31m-	if ($arParams["ADD_SECTIONS_CHAIN"] && !empty($arResult["SECTION"]["PATH"]) && is_array($arResult["SECTION"]["PATH"]))[m
[31m-	{[m
[31m-		foreach($arResult["SECTION"]["PATH"] as $arPath)[m
[31m-		{[m
[31m-			if ($arPath["IPROPERTY_VALUES"]["SECTION_PAGE_TITLE"] != "")[m
[31m-				$APPLICATION->AddChainItem($arPath["IPROPERTY_VALUES"]["SECTION_PAGE_TITLE"], $arPath["~SECTION_PAGE_URL"]);[m
[31m-			else[m
[31m-				$APPLICATION->AddChainItem($arPath["NAME"], $arPath["~SECTION_PAGE_URL"]);[m
[31m-		}[m
[31m-	}[m
[31m-	if ($arParams["ADD_ELEMENT_CHAIN"])[m
[31m-	{[m
[31m-		if ($arResult["IPROPERTY_VALUES"]["ELEMENT_PAGE_TITLE"] != "")[m
[31m-			$APPLICATION->AddChainItem($arResult["IPROPERTY_VALUES"]["ELEMENT_PAGE_TITLE"]);[m
[31m-		else[m
[31m-			$APPLICATION->AddChainItem($arResult["NAME"]);[m
[31m-	}[m
[31m-[m
[31m-	if ($arParams["SET_LAST_MODIFIED"] && $arResult["TIMESTAMP_X"])[m
[31m-	{[m
[31m-		Context::getCurrent()->getResponse()->setLastModified(DateTime::createFromUserTime($arResult["TIMESTAMP_X"]));[m
[31m-	}[m
[31m-[m
[31m-	return $arResult["ID"];[m
[31m-}[m
[31m-else[m
[31m-{[m
[31m-	return 0;[m
[31m-}[m
[31m-?>[m
\ No newline at end of file[m
[1mdiff --git a/local/components/zakrepi/catalog.element/images/cat_detail.gif b/local/components/zakrepi/catalog.element/images/cat_detail.gif[m
[1mdeleted file mode 100644[m
[1mindex c901515..0000000[m
Binary files a/local/components/zakrepi/catalog.element/images/cat_detail.gif and /dev/null differ
[1mdiff --git a/local/components/zakrepi/catalog.element/lang/en/.description.php b/local/components/zakrepi/catalog.element/lang/en/.description.php[m
[1mdeleted file mode 100644[m
[1mindex a1bc83b..0000000[m
[1m--- a/local/components/zakrepi/catalog.element/lang/en/.description.php[m
[1m+++ /dev/null[m
[36m@@ -1,5 +0,0 @@[m
[31m-<?[m
[31m-$MESS ['T_IBLOCK_DESC_CATALOG'] = "Catalog";[m
[31m-$MESS ['IBLOCK_ELEMENT_TEMPLATE_NAME'] = "Catalog element details";[m
[31m-$MESS ['IBLOCK_ELEMENT_TEMPLATE_DESCRIPTION'] = "Displays the detailed information on the catalog element";[m
[31m-?>[m
\ No newline at end of file[m
[1mdiff --git a/local/components/zakrepi/catalog.element/lang/en/.parameters.php b/local/components/zakrepi/catalog.element/lang/en/.parameters.php[m
[1mdeleted file mode 100644[m
[1mindex d069747..0000000[m
[1m--- a/local/components/zakrepi/catalog.element/lang/en/.parameters.php[m
[1m+++ /dev/null[m
[36m@@ -1,102 +0,0 @@[m
[31m-<?[m
[31m-$MESS["IBLOCK_ACTIONS"] = "Action settings";[m
[31m-$MESS["IBLOCK_PRICES"] = "Prices";[m
[31m-$MESS["IBLOCK_BASKET"] = "Items in shopping cart";[m
[31m-$MESS["IBLOCK_COMPARE"] = "Product comparison";[m
[31m-$MESS["IBLOCK_LINK"] = "Linked elements settings";[m
[31m-$MESS["IBLOCK_TYPE"] = "Infoblock type";[m
[31m-$MESS["IBLOCK_IBLOCK"] = "Infoblock";[m
[31m-$MESS["IBLOCK_PROPERTY"] = "Properties";[m
[31m-$MESS["IBLOCK_SECTION_URL"] = "URL of the page with the section contents";[m
[31m-$MESS["IBLOCK_PRICE_CODE"] = "Price type";[m
[31m-$MESS["IBLOCK_VAT_INCLUDE"] = "Include tax rate in price";[m
[31m-$MESS["IBLOCK_VAT_SHOW_VALUE"] = "Display tax rate";[m
[31m-$MESS["IBLOCK_BASKET_URL"] = "URL of the page with the customer cart";[m
[31m-$MESS["IBLOCK_ELEMENT_ID"] = "Element ID";[m
[31m-$MESS["IBLOCK_ELEMENT_CODE"] = "Element code";[m
[31m-$MESS["IBLOCK_SECTION_ID"] = "Section ID";[m
[31m-$MESS["IBLOCK_SECTION_CODE"] = "Section code";[m
[31m-$MESS["IBLOCK_LINK_IBLOCK_TYPE"] = "Type of information block with elements linked to the current element";[m
[31m-$MESS["IBLOCK_LINK_IBLOCK_ID"] = "Information block ID with elements to the current element";[m
[31m-$MESS["IBLOCK_LINK_ELEMENTS_URL"] = "URL of the page with a list of linked elements";[m
[31m-$MESS["IBLOCK_LINK_PROPERTY_SID"] = "Property to store the link";[m
[31m-$MESS["IBLOCK_ACTION_VARIABLE"] = "\"Actions\" parameter name";[m
[31m-$MESS["IBLOCK_PRODUCT_ID_VARIABLE"] = "\"Product code\" parameter name";[m
[31m-$MESS["IBLOCK_SECTION_ID_VARIABLE"] = "\"Section code\" parameter name";[m
[31m-$MESS["CP_BCE_CHECK_SECTION_ID_VARIABLE"] = "Use group ID on variable if element section is missing";[m
[31m-$MESS["IBLOCK_USE_PRICE_COUNT"] = "Show quantity range prices";[m
[31m-$MESS["IBLOCK_SHOW_PRICE_COUNT"] = "Show price for quantity";[m
[31m-$MESS["IBLOCK_DETAIL_URL"] = "URL of the page with the detail contents";[m
[31m-$MESS["T_IBLOCK_DESC_KEYWORDS"] = "Set page keywords from property";[m
[31m-$MESS["T_IBLOCK_DESC_DESCRIPTION"] = "Set page description from property";[m
[31m-$MESS["CP_BCE_ADD_SECTIONS_CHAIN"] = "Add Section name to breadcrumb navigation";[m
[31m-$MESS["CP_BCE_ADD_ELEMENT_CHAIN"] = "Add element name to breadcrumbs";[m
[31m-$MESS["CP_BCE_SET_BROWSER_TITLE"] = "Set browser window title";[m
[31m-$MESS["CP_BCE_BROWSER_TITLE"] = "Set browser window title from property value";[m
[31m-$MESS["CP_BCE_SET_META_KEYWORDS"] = "Set page keywords";[m
[31m-$MESS["CP_BCE_SET_META_DESCRIPTION"] = "Set page description";[m
[31m-$MESS["CP_BCE_CACHE_GROUPS"] = "Respect Access Permissions";[m
[31m-$MESS["CP_BCE_PRODUCT_QUANTITY_VARIABLE"] = "Product Quantity Parameter Name";[m
[31m-$MESS["CP_BCE_PRODUCT_PROPS_VARIABLE"] = "Product Properties Parameter Name";[m
[31m-$MESS["CP_BCE_USE_PRODUCT_QUANTITY"] = "Enable Product Quantity Field";[m
[31m-$MESS["CP_BCE_ADD_PROPERTIES_TO_BASKET"] = "Pass item and SKU properties to shipping cart";[m
[31m-$MESS["CP_BCE_PRODUCT_PROPERTIES"] = "Product Properties";[m
[31m-$MESS["CP_BCE_PARTIAL_PRODUCT_PROPERTIES"] = "Shopping cart can contain items with partially specified properties";[m
[31m-$MESS["CP_BCE_OFFERS_FIELD_CODE"] = "SKU Fields";[m
[31m-$MESS["CP_BCE_OFFERS_PROPERTY_CODE"] = "SKU Properties";[m
[31m-$MESS["CP_BCE_OFFERS_SORT_FIELD"] = "Sort SKU By Field";[m
[31m-$MESS["CP_BCE_OFFERS_SORT_ORDER"] = "SKU Sort Order";[m
[31m-$MESS["CP_BCE_OFFERS_SORT_ORDER2"] = "Second sort field for SKU's";[m
[31m-$MESS["CP_BCE_OFFERS_SORT_FIELD2"] = "Second sort order for SKU's";[m
[31m-$MESS["CP_BCE_OFFERS_CART_PROPERTIES"] = "SKU Properties In Shopping Cart";[m
[31m-$MESS["IBLOCK_SORT_ASC"] = "ascending";[m
[31m-$MESS["IBLOCK_SORT_DESC"] = "descending";[m
[31m-$MESS["CP_BCE_CONVERT_CURRENCY"] = "Use only one currency to show prices";[m
[31m-$MESS["CP_BCE_CURRENCY_ID"] = "Convert all prices to currency";[m
[31m-$MESS["CP_BCE_OFFERS_LIMIT"] = "Maximum SKU's to Show (use 0 to show all)";[m
[31m-$MESS["CP_BCE_USE_ELEMENT_COUNTER"] = "Use view counter";[m
[31m-$MESS["CP_BCE_HIDE_NOT_AVAILABLE"] = "Hide items not in stock";[m
[31m-$MESS["CP_BCE_DISPLAY_COMPARE"] = "Enable product comparison";[m
[31m-$MESS["CP_BCE_COMPARE_PATH"] = "Product comparison page";[m
[31m-$MESS["CP_BCE_SHOW_DEACTIVATED"] = "Show deactivated products";[m
[31m-$MESS["CP_BCE_SET_CANONICAL_URL"] = "Set canonical URL";[m
[31m-$MESS["CP_BCE_USE_MAIN_ELEMENT_SECTION"] = "Use main section to show element";[m
[31m-$MESS["CP_BCE_SECTION_CODE_PATH"] = "Mnemonic codes of nested sections";[m
[31m-$MESS["IBLOCK_TYPE_TIP"] = "Select one of existing information block types in the list and click <b>OK</b>. This will load information blocks of the selected type.";[m
[31m-$MESS["IBLOCK_ID_TIP"] = "Select one of information blocks of the chosen type. If you select <b>(other)-&gt;</b>, specify the information block ID in the field beside.";[m
[31m-$MESS["ELEMENT_ID_TIP"] = "The expression that evaluates to the element ID. The default value is <b>={\$_REQUEST[\"ELEMENT_ID\"]}</b>.";[m
[31m-$MESS["SECTION_ID_TIP"] = "The expression that evaluates to the section ID. The default value is <b>={\$_REQUEST[\"SECTION_ID\"]}</b>.";[m
[31m-$MESS["SECTION_URL_TIP"] = "Specify here the path to an information block section description.";[m
[31m-$MESS["DETAIL_URL_TIP"] = "Specify here the path to an information block element details page.";[m
[31m-$MESS["BASKET_URL_TIP"] = "Specify here the path to a customer's shopping cart page.";[m
[31m-$MESS["ACTION_VARIABLE_TIP"] = "The name of a variable in which the required action will be passed: ADD_TO_COMPARE_LIST, ADD2BASKET etc. The default value is <i>action</i>.";[m
[31m-$MESS["PRODUCT_ID_VARIABLE_TIP"] = "The name of a variable in which the product ID will be passed.";[m
[31m-$MESS["SECTION_ID_VARIABLE_TIP"] = "The name of a variable in which the information block section ID will be passed.";[m
[31m-$MESS["CHECK_SECTION_ID_VARIABLE_TIP"] = "If section ID or symbolic code is missing, the value of the variable specified in the \"Variable containing the group ID\" parameter will be used instead.";[m
[31m-$MESS["META_KEYWORDS_TIP"] = "This drop-down list shows properties available for this information block. Choose the one that contains keywords.";[m
[31m-$MESS["META_DESCRIPTION_TIP"] = "This drop-down list shows properties available for this information block. Choose the one that contains the description.";[m
[31m-$MESS["DISPLAY_PANEL_TIP"] = "If checked, the tool buttons will be shown on the administration toolbar and the component edit area toolbar in the site edit mode.";[m
[31m-$MESS["SET_TITLE_TIP"] = "Check this option if you want to set the page title to the element name.";[m
[31m-$MESS["SET_BROWSER_TITLE_TIP"] = "If selected, an information block element title (or SEO title if active) will be used as the browser window title.";[m
[31m-$MESS["ADD_SECTIONS_CHAIN_TIP"] = "If the option is active and the current information block contains sections, their names will be shown in the navigation chain.";[m
[31m-$MESS["ADD_ELEMENT_CHAIN_TIP"] = "If selected, the item name will be added to navigation breadcrumbs.";[m
[31m-$MESS["PROPERTY_CODE_TIP"] = "Select here the information block properties which you want to be shown with elements. If you select <b>(none)-&gt;</b> and do not specify the property ID's in the field beside, no properties will be displayed.";[m
[31m-$MESS["PRICE_CODE_TIP"] = "Specify the price type to be used in the catalog. If you omit the price type, prices and buttons <b>Buy</b> and<b>Add to basket</b> will not be displayed.";[m
[31m-$MESS["USE_PRICE_COUNT_TIP"] = "If checked, all existing price ranges will be selected.";[m
[31m-$MESS["SHOW_PRICE_COUNT_TIP"] = "If the \"Use price ranges\" option is unchecked (meaning only one price is shown for the product) but there are quantity based pricing products, specify the quantity to pick a correct price. This option has no effect for products with fixed price.";[m
[31m-$MESS["ADD_PROPERTIES_TO_BASKET_TIP"] = "Select the properties you want to pass to shopping cart and order. The required properties are those that may affect the customer choice or can be changed in shopping cart (for SKU's). The properties that will affect order fulfillment (e.g. item color) are also required.";[m
[31m-$MESS["PARTIAL_PRODUCT_PROPERTIES_TIP"] = "If unchecked, the product will be added to shopping cart only if all the item properties set to pass to shopping cart have values. This option is irrelevant to SKU's.";[m
[31m-$MESS["LINK_IBLOCK_TYPE_TIP"] = "If elements of one of information blocks are bound to elements of a current information block, specify here the type of bound information block.";[m
[31m-$MESS["LINK_IBLOCK_ID_TIP"] = "An information block whose elements are bound to the information block that is to be displayed.";[m
[31m-$MESS["LINK_PROPERTY_SID_TIP"] = "Select here the element binding property, or specify it as a code in the next field.";[m
[31m-$MESS["LINK_ELEMENTS_URL_TIP"] = "The path to a page where the bound elements are to be displayed.";[m
[31m-$MESS["CACHE_TYPE_TIP"] = "<i>Auto</i>: the cache is valid during the time predefined in the cache settings;<br /><i>Cache</i>: always cache for the period specified in the next field;<br /><i>Do not cache</i>: no caching is performed.";[m
[31m-$MESS["CACHE_TIME_TIP"] = "Specify here the period of time during which the cache is valid.";[m
[31m-$MESS["PRICE_VAT_INCLUDE_TIP"] = "Checking this option specifies to include tax in the display prices.";[m
[31m-$MESS["PRICE_VAT_SHOW_VALUE_TIP"] = "Specifies to show the tax value.";[m
[31m-$MESS["HIDE_NOT_AVAILABLE_TIP"] = "If checked: the products whose stock at all the warehouses is zero or less will be hidden; stock control will be enabled; out-of-stock items will be available for purchase.";[m
[31m-$MESS["DISPLAY_COMPARE_TIP"] = "Check this option to show <b>Compare</b> button enabling a customer to add a product to the comparison chart.";[m
[31m-$MESS["COMPARE_PATH_TIP"] = "Specifies the path to a page that includes the product comparison component. If empty, a current page will be used.";[m
[31m-$MESS["SHOW_DEACTIVATED_TIP"] = "If checked, the component will also show inactive products.";[m
[31m-$MESS["CP_BCE_SET_LAST_MODIFIED"] = "Set page last modified date to response header";[m
[31m-?>[m
\ No newline at end of file[m
[1mdiff --git a/local/components/zakrepi/catalog.element/lang/en/component.php b/local/components/zakrepi/catalog.element/lang/en/component.php[m
[1mdeleted file mode 100644[m
[1mindex 41081f9..0000000[m
[1m--- a/local/components/zakrepi/catalog.element/lang/en/component.php[m
[1m+++ /dev/null[m
[36m@@ -1,8 +0,0 @@[m
[31m-<?[m
[31m-$MESS["IBLOCK_MODULE_NOT_INSTALLED"] = "Information blocks module is not installed";[m
[31m-$MESS["CATALOG_ERROR2BASKET"] = "Could not add product to cart";[m
[31m-$MESS["CATALOG_ELEMENT_NOT_FOUND"] = "Element has not been found.";[m
[31m-$MESS["CATALOG_SUCCESSFUL_ADD_TO_BASKET"] = "Product successfully added to cart";[m
[31m-$MESS["CATALOG_PARTIAL_BASKET_PROPERTIES_ERROR"] = "Not all properties of products added to the cart are filled in";[m
[31m-$MESS["CATALOG_EMPTY_BASKET_PROPERTIES_ERROR"] = "Properties of products added to cart are not filled in ";[m
[31m-?>[m
\ No newline at end of file[m
[1mdiff --git a/local/components/zakrepi/catalog.element/lang/ru/.description.php b/local/components/zakrepi/catalog.element/lang/ru/.description.php[m
[1mdeleted file mode 100644[m
[1mindex 53bbeeb..0000000[m
[1m--- a/local/components/zakrepi/catalog.element/lang/ru/.description.php[m
[1m+++ /dev/null[m
[36m@@ -1,5 +0,0 @@[m
[31m-<?[m
[31m-$MESS ['T_IBLOCK_DESC_CATALOG'] = "Каталог";[m
[31m-$MESS ['IBLOCK_ELEMENT_TEMPLATE_NAME'] = "Элемент каталога детально";[m
[31m-$MESS ['IBLOCK_ELEMENT_TEMPLATE_DESCRIPTION'] = "Выводит детальную информацию по элементу каталога";[m
[31m-?>[m
\ No newline at end of file[m
[1mdiff --git a/local/components/zakrepi/catalog.element/lang/ru/.parameters.php b/local/components/zakrepi/catalog.element/lang/ru/.parameters.php[m
[1mdeleted file mode 100644[m
[1mindex ffd68e7..0000000[m
[1m--- a/local/components/zakrepi/catalog.element/lang/ru/.parameters.php[m
[1m+++ /dev/null[m
[36m@@ -1,102 +0,0 @@[m
[31m-<?[m
[31m-$MESS["IBLOCK_ACTIONS"] = "Настройки действий";[m
[31m-$MESS["IBLOCK_PRICES"] = "Цены";[m
[31m-$MESS["IBLOCK_BASKET"] = "Добавление в корзину";[m
[31m-$MESS["IBLOCK_COMPARE"] = "Сравнение товаров";[m
[31m-$MESS["IBLOCK_LINK"] = "Настройки связанных элементов";[m
[31m-$MESS["IBLOCK_TYPE"] = "Тип инфоблока";[m
[31m-$MESS["IBLOCK_IBLOCK"] = "Инфоблок";[m
[31m-$MESS["IBLOCK_PROPERTY"] = "Свойства";[m
[31m-$MESS["IBLOCK_SECTION_URL"] = "URL, ведущий на страницу с содержимым раздела";[m
[31m-$MESS["IBLOCK_PRICE_CODE"] = "Тип цены";[m
[31m-$MESS["IBLOCK_VAT_INCLUDE"] = "Включать НДС в цену";[m
[31m-$MESS["IBLOCK_VAT_SHOW_VALUE"] = "Отображать значение НДС";[m
[31m-$MESS["IBLOCK_BASKET_URL"] = "URL, ведущий на страницу с корзиной покупателя";[m
[31m-$MESS["IBLOCK_ELEMENT_ID"] = "ID элемента";[m
[31m-$MESS["IBLOCK_ELEMENT_CODE"] = "Код элемента";[m
[31m-$MESS["IBLOCK_SECTION_ID"] = "ID раздела";[m
[31m-$MESS["IBLOCK_SECTION_CODE"] = "Код раздела";[m
[31m-$MESS["IBLOCK_LINK_IBLOCK_TYPE"] = "Тип инфоблока, элементы которого связаны с текущим элементом";[m
[31m-$MESS["IBLOCK_LINK_IBLOCK_ID"] = "ID инфоблока, элементы которого связаны с текущим элементом";[m
[31m-$MESS["IBLOCK_LINK_ELEMENTS_URL"] = "URL на страницу, где будет показан список связанных элементов";[m
[31m-$MESS["IBLOCK_LINK_PROPERTY_SID"] = "Свойство, в котором хранится связь";[m
[31m-$MESS["IBLOCK_ACTION_VARIABLE"] = "Название переменной, в которой передается действие";[m
[31m-$MESS["IBLOCK_PRODUCT_ID_VARIABLE"] = "Название переменной, в которой передается код товара для покупки";[m
[31m-$MESS["IBLOCK_SECTION_ID_VARIABLE"] = "Название переменной, в которой передается код группы";[m
[31m-$MESS["CP_BCE_CHECK_SECTION_ID_VARIABLE"] = "Использовать код группы из переменной, если не задан раздел элемента";[m
[31m-$MESS["IBLOCK_USE_PRICE_COUNT"] = "Использовать вывод цен с диапазонами";[m
[31m-$MESS["IBLOCK_SHOW_PRICE_COUNT"] = "Выводить цены для количества";[m
[31m-$MESS["IBLOCK_DETAIL_URL"] = "URL, ведущий на страницу с содержимым элемента раздела";[m
[31m-$MESS["T_IBLOCK_DESC_KEYWORDS"] = "Установить ключевые слова страницы из свойства";[m
[31m-$MESS["T_IBLOCK_DESC_DESCRIPTION"] = "Установить описание страницы из свойства";[m
[31m-$MESS["CP_BCE_ADD_SECTIONS_CHAIN"] = "Включать раздел в цепочку навигации";[m
[31m-$MESS["CP_BCE_ADD_ELEMENT_CHAIN"] = "Включать название элемента в цепочку навигации";[m
[31m-$MESS["CP_BCE_SET_BROWSER_TITLE"] = "Устанавливать заголовок окна браузера";[m
[31m-$MESS["CP_BCE_BROWSER_TITLE"] = "Установить заголовок окна браузера из свойства";[m
[31m-$MESS["CP_BCE_SET_META_KEYWORDS"] = "Устанавливать ключевые слова страницы";[m
[31m-$MESS["CP_BCE_SET_META_DESCRIPTION"] = "Устанавливать описание страницы";[m
[31m-$MESS["CP_BCE_CACHE_GROUPS"] = "Учитывать права доступа";[m
[31m-$MESS["CP_BCE_PRODUCT_QUANTITY_VARIABLE"] = "Название переменной, в которой передается количество товара";[m
[31m-$MESS["CP_BCE_PRODUCT_PROPS_VARIABLE"] = "Название переменной, в которой передаются характеристики товара";[m
[31m-$MESS["CP_BCE_USE_PRODUCT_QUANTITY"] = "Разрешить указание количества товара";[m
[31m-$MESS["CP_BCE_ADD_PROPERTIES_TO_BASKET"] = "Добавлять в корзину свойства товаров и предложений";[m
[31m-$MESS["CP_BCE_PRODUCT_PROPERTIES"] = "Характеристики товара";[m
[31m-$MESS["CP_BCE_PARTIAL_PRODUCT_PROPERTIES"] = "Разрешить добавлять в корзину товары, у которых заполнены не все характеристики";[m
[31m-$MESS["CP_BCE_OFFERS_FIELD_CODE"] = "Поля предложений";[m
[31m-$MESS["CP_BCE_OFFERS_PROPERTY_CODE"] = "Свойства предложений";[m
[31m-$MESS["CP_BCE_OFFERS_SORT_FIELD"] = "По какому полю сортируем предложения товара";[m
[31m-$MESS["CP_BCE_OFFERS_SORT_ORDER"] = "Порядок сортировки предложений товара";[m
[31m-$MESS["CP_BCE_OFFERS_SORT_ORDER2"] = "Поле для второй сортировки предложений товара";[m
[31m-$MESS["CP_BCE_OFFERS_SORT_FIELD2"] = "Порядок второй сортировки предложений товара";[m
[31m-$MESS["CP_BCE_OFFERS_CART_PROPERTIES"] = "Свойства предложений, добавляемые в корзину";[m
[31m-$MESS["IBLOCK_SORT_ASC"] = "по возрастанию";[m
[31m-$MESS["IBLOCK_SORT_DESC"] = "по убыванию";[m
[31m-$MESS["CP_BCE_CONVERT_CURRENCY"] = "Показывать цены в одной валюте";[m
[31m-$MESS["CP_BCE_CURRENCY_ID"] = "Валюта, в которую будут сконвертированы цены";[m
[31m-$MESS["CP_BCE_OFFERS_LIMIT"] = "Максимальное количество предложений для показа (0 - все)";[m
[31m-$MESS["CP_BCE_USE_ELEMENT_COUNTER"] = "Использовать счетчик просмотров";[m
[31m-$MESS["CP_BCE_HIDE_NOT_AVAILABLE"] = "Не отображать товары, которых нет на складах";[m
[31m-$MESS["CP_BCE_DISPLAY_COMPARE"] = "Разрешить сравнение товаров";[m
[31m-$MESS["CP_BCE_COMPARE_PATH"] = "Путь к странице сравнения";[m
[31m-$MESS["CP_BCE_SHOW_DEACTIVATED"] = "Показывать деактивированные товары";[m
[31m-$MESS["CP_BCE_SET_CANONICAL_URL"] = "Устанавливать канонический URL";[m
[31m-$MESS["CP_BCE_USE_MAIN_ELEMENT_SECTION"] = "Использовать основной раздел для показа элемента";[m
[31m-$MESS["CP_BCE_SET_LAST_MODIFIED"] = "Устанавливать в заголовках ответа время модификации страницы";[m
[31m-$MESS["CP_BCE_SECTION_CODE_PATH"] = "Путь из символьных кодов раздела";[m
[31m-$MESS["IBLOCK_TYPE_TIP"] = "Из выпадающего списка выбирается один из созданных в системе типов инфоблоков. После нажатия кнопки <b><i>ок</i></b> будут подгружены инфоблоки, созданные для выбранного типа.";[m
[31m-$MESS["IBLOCK_ID_TIP"] = "Выбирается один из инфоблоков установленного типа. Если пункт (другое)->, то необходимо указать ID инфоблока в поле рядом.";[m
[31m-$MESS["ELEMENT_ID_TIP"] = "Поле содержит код, в котором передается ID элемента. По умолчанию поле содержит ={\$_REQUEST[\"ELEMENT_ID\"]}.";[m
[31m-$MESS["SECTION_ID_TIP"] = "Поле содержит код, в котором передается ID раздела. По умолчанию поле содержит ={\$_REQUEST[\"SECTION_ID\"]}.";[m
[31m-$MESS["SECTION_URL_TIP"] = "Указывается путь к странице с описанием раздела инфоблока.";[m
[31m-$MESS["DETAIL_URL_TIP"] = "Указывается путь к странице с детальным описанием элемента инфоблока.";[m
[31m-$MESS["BASKET_URL_TIP"] = "Указывается путь к странице с корзиной покупателя.";[m
[31m-$MESS["ACTION_VARIABLE_TIP"] = "В данном поле указывается имя переменной, в которой передается действие: ADD_TO_COMPARE_LIST, ADD2BASKET и т.д. Значение поля по умолчанию <i>action</i>.";[m
[31m-$MESS["PRODUCT_ID_VARIABLE_TIP"] = "Имя переменной, в которой будет передаваться ID товара.";[m
[31m-$MESS["SECTION_ID_VARIABLE_TIP"] = "Имя переменной, в которой будет передаваться ID раздела инфоблока.";[m
[31m-$MESS["CHECK_SECTION_ID_VARIABLE_TIP"] = "Если не задан ID или символьный код раздела, можно использовать в качестве идентификатора раздела значение переменной, заданной в параметре \"Название переменной, в которой передается код группы\"";[m
[31m-$MESS["META_KEYWORDS_TIP"] = "В выпадающем списке перечислены все свойства, определенные для данного инфоблока. Среди них выбирается то, в котором содержатся ключевые слова.";[m
[31m-$MESS["META_DESCRIPTION_TIP"] = "В выпадающем списке перечислены все свойства, определенные для данного инфоблока. Среди них выбирается то, в котором содержится описание.";[m
[31m-$MESS["DISPLAY_PANEL_TIP"] = "При установленной опции кнопки будут отображены в режиме редактирования сайта на административной панели и в наборе кнопок области редактирования данного компонента.";[m
[31m-$MESS["SET_TITLE_TIP"] = "При установленной опции в качестве заголовка страницы будет установлено название элемента.";[m
[31m-$MESS["SET_BROWSER_TITLE_TIP"] = "При установленной опции в качестве заголовка окна браузера будет установлено название элемента или SEO названия элемента (если используется SEO)";[m
[31m-$MESS["ADD_SECTIONS_CHAIN_TIP"] = "Если опция установлена и в инфоблоке созданы разделы, то при переходе по разделам их названия будут добавлены в цепочку навигации.";[m
[31m-$MESS["ADD_ELEMENT_CHAIN_TIP"] = "Если опция установлена, то название элемента будет добавлено в цепочку навигации";[m
[31m-$MESS["PROPERTY_CODE_TIP"] = "Среди свойств инфоблока можно выбрать те, которые будут отображены при показе элементов. При выборе пункта (не выбрано)->  и без указания кодов свойств в строках ниже, свойства выведены не будут.";[m
[31m-$MESS["PRICE_CODE_TIP"] = "Устанавливается, какой из типов цен будут выведен в каталоге. Если ни один из типов не выбран, то цена и кнопки <i>Купить</i> и <i>В корзину</i> не будет показаны.";[m
[31m-$MESS["USE_PRICE_COUNT_TIP"] = "При установленной опции для каждого товара выбираются все диапазоны цен, существующие у товара";[m
[31m-$MESS["SHOW_PRICE_COUNT_TIP"] = "Если снята опция \"Использовать вывод цен с диапазонами\", т.е. для каждого товара выводится только одна цена, но в каталоге есть товары с расширенным управлением ценами (зависимость цены от количества), необходимо указать - для какого количества товара искать цену. На товары, чья цена не зависит от количества, эта опция не влияет.";[m
[31m-$MESS["ADD_PROPERTIES_TO_BASKET_TIP"] = "Выберите нужные свойства для передачи в корзину и заказ. Свойства должны быть перечислены, если они влияют на выбор товара или включена возможность управлять свойствами в корзине (для торговых предложений), либо несут дополнительную информацию о товаре, которая необходима в заказе (например: клиент может сменить цвет в корзине, или цвет это другое торговое предложение и данное свойство показывает на этот выбор).";[m
[31m-$MESS["PARTIAL_PRODUCT_PROPERTIES_TIP"] = "Если этот параметр не установлен, товар будет добавлен в корзину только при условии, что все характеристики, добавляемые в корзину, заполнены. На торговые предложения этот параметр не влияет.";[m
[31m-$MESS["LINK_IBLOCK_TYPE_TIP"] = "Если элементы одного из инфоблоков связаны с элементами выводимого инфоблока, то здесь указывается тип связанного инфоблока.";[m
[31m-$MESS["LINK_IBLOCK_ID_TIP"] = "Указывается сам инфоблок, элементы которого связаны с выводимым инфоблоком.";[m
[31m-$MESS["LINK_PROPERTY_SID_TIP"] = "Свойство, по которому элементы связаны, выбирается из списка или указывается в виде кода в поле рядом.";[m
[31m-$MESS["LINK_ELEMENTS_URL_TIP"] = "Указывается путь на страницу, где будет показан список связанных элементов.";[m
[31m-$MESS["CACHE_TYPE_TIP"] = "<i>Авто</i>: действует при включенном кешировании в течение заданного времени;<br /><i>Кешировать</i>: для кеширования необходимо определить только время кеширования;<br /><i>Не кешировать</i>: кеширования нет в любом случае.";[m
[31m-$MESS["CACHE_TIME_TIP"] = "Поле служит для указания времени кеширования в секундах.";[m
[31m-$MESS["PRICE_VAT_INCLUDE_TIP"] = "При отмеченной опции цены будут показаны с учетом НДС.";[m
[31m-$MESS["PRICE_VAT_SHOW_VALUE_TIP"] = "Опция служит для показа величины НДС.";[m
[31m-$MESS["HIDE_NOT_AVAILABLE_TIP"] = "При отмеченной опции будут скрыты товары, для которых общее количество на складах меньше либо равно нулю, включен количественный учет и не разрешена покупка при отсутствии товара";[m
[31m-$MESS["DISPLAY_COMPARE_TIP"] = "Если опция отмечена, то будет выведена кнопка <i>Сравнить</i>, с помощью которой элемент добавляется в список сравнения.";[m
[31m-$MESS["COMPARE_PATH_TIP"] = "Путь к странице с компонентом сравнения товаров. Если значение параметра пустое, будет использована текущая страница";[m
[31m-$MESS["SHOW_DEACTIVATED_TIP"] = "При отмеченной опции компонент будет показывать так же и деактивированные товары.";[m
[31m-?>[m
\ No newline at end of file[m
[1mdiff --git a/local/components/zakrepi/catalog.element/lang/ru/component.php b/local/components/zakrepi/catalog.element/lang/ru/component.php[m
[1mdeleted file mode 100644[m
[1mindex cdbbd5b..0000000[m
[1m--- a/local/components/zakrepi/catalog.element/lang/ru/component.php[m
[1m+++ /dev/null[m
[36m@@ -1,8 +0,0 @@[m
[31m-<?[m
[31m-$MESS["IBLOCK_MODULE_NOT_INSTALLED"] = "Модуль Информационных блоков не установлен";[m
[31m-$MESS["CATALOG_ERROR2BASKET"] = "Ошибка добавления товара в корзину";[m
[31m-$MESS["CATALOG_ELEMENT_NOT_FOUND"] = "Элемент не найден";[m
[31m-$MESS["CATALOG_SUCCESSFUL_ADD_TO_BASKET"] = "Товар успешно добавлен в корзину";[m
[31m-$MESS["CATALOG_PARTIAL_BASKET_PROPERTIES_ERROR"] = "Не все свойства товара, добавляемые в корзину, заполнены";[m
[31m-$MESS["CATALOG_EMPTY_BASKET_PROPERTIES_ERROR"] = "Не заполнены свойства товара, добавляемые в корзину";[m
[31m-?>[m
\ No newline at end of file[m
[1mdiff --git a/local/components/zakrepi/catalog.element/templates/.default/.parameters.php b/local/components/zakrepi/catalog.element/templates/.default/.parameters.php[m
[1mdeleted file mode 100644[m
[1mindex d96affb..0000000[m
[1m--- a/local/components/zakrepi/catalog.element/templates/.default/.parameters.php[m
[1m+++ /dev/null[m
[36m@@ -1,422 +0,0 @@[m
[31m-<?[m
[31m-if (!defined('B_PROLOG_INCLUDED') || B_PROLOG_INCLUDED!==true) die();[m
[31m-[m
[31m-use Bitrix\Main\Loader;[m
[31m-use Bitrix\Main\ModuleManager;[m
[31m-[m
[31m-if (!Loader::includeModule('iblock'))[m
[31m-	return;[m
[31m-$boolCatalog = Loader::includeModule('catalog');[m
[31m-[m
[31m-$arSKU = false;[m
[31m-$boolSKU = false;[m
[31m-if ($boolCatalog && (isset($arCurrentValues['IBLOCK_ID']) && 0 < intval($arCurrentValues['IBLOCK_ID'])))[m
[31m-{[m
[31m-	$arSKU = CCatalogSKU::GetInfoByProductIBlock($arCurrentValues['IBLOCK_ID']);[m
[31m-	$boolSKU = !empty($arSKU) && is_array($arSKU);[m
[31m-}[m
[31m-[m
[31m-$arThemes = array();[m
[31m-if (ModuleManager::isModuleInstalled('bitrix.eshop'))[m
[31m-{[m
[31m-	$arThemes['site'] = GetMessage('CP_BCE_TPL_THEME_SITE');[m
[31m-}[m
[31m-[m
[31m-$arThemesList = array([m
[31m-	'blue' => GetMessage('CP_BCE_TPL_THEME_BLUE'),[m
[31m-	'green' => GetMessage('CP_BCE_TPL_THEME_GREEN'),[m
[31m-	'red' => GetMessage('CP_BCE_TPL_THEME_RED'),[m
[31m-	'wood' => GetMessage('CP_BCE_TPL_THEME_WOOD'),[m
[31m-	'yellow' => GetMessage('CP_BCE_TPL_THEME_YELLOW'),[m
[31m-	'black' => GetMessage('CP_BCE_TPL_THEME_BLACK')[m
[31m-);[m
[31m-$dir = trim(preg_replace("'[\\\\/]+'", "/", dirname(__FILE__)."/themes/"));[m
[31m-if (is_dir($dir))[m
[31m-{[m
[31m-	foreach ($arThemesList as $themeID => $themeName)[m
[31m-	{[m
[31m-		if (!is_file($dir.$themeID.'/style.css'))[m
[31m-			continue;[m
[31m-		$arThemes[$themeID] = $themeName;[m
[31m-	}[m
[31m-}[m
[31m-[m
[31m-$arTemplateParameters['TEMPLATE_THEME'] = array([m
[31m-	'PARENT' => 'VISUAL',[m
[31m-	'NAME' => GetMessage("CP_BCE_TPL_TEMPLATE_THEME"),[m
[31m-	'TYPE' => 'LIST',[m
[31m-	'VALUES' => $arThemes,[m
[31m-	'DEFAULT' => 'blue',[m
[31m-	'ADDITIONAL_VALUES' => 'Y'[m
[31m-);[m
[31m-[m
[31m-if (isset($arCurrentValues['IBLOCK_ID']) && 0 < intval($arCurrentValues['IBLOCK_ID']))[m
[31m-{[m
[31m-	$arAllPropList = array();[m
[31m-	$arFilePropList = array([m
[31m-		'-' => GetMessage('CP_BCE_TPL_PROP_EMPTY')[m
[31m-	);[m
[31m-	$arListPropList = array([m
[31m-		'-' => GetMessage('CP_BCE_TPL_PROP_EMPTY')[m
[31m-	);[m
[31m-	$arHighloadPropList = array([m
[31m-		'-' => GetMessage('CP_BCE_TPL_PROP_EMPTY')[m
[31m-	);[m
[31m-	$rsProps = CIBlockProperty::GetList([m
[31m-		array('SORT' => 'ASC', 'ID' => 'ASC'),[m
[31m-		array('IBLOCK_ID' => $arCurrentValues['IBLOCK_ID'], 'ACTIVE' => 'Y')[m
[31m-	);[m
[31m-	while ($arProp = $rsProps->Fetch())[m
[31m-	{[m
[31m-		$strPropName = '['.$arProp['ID'].']'.('' != $arProp['CODE'] ? '['.$arProp['CODE'].']' : '').' '.$arProp['NAME'];[m
[31m-		if ('' == $arProp['CODE'])[m
[31m-			$arProp['CODE'] = $arProp['ID'];[m
[31m-		$arAllPropList[$arProp['CODE']] = $strPropName;[m
[31m-		if ('F' == $arProp['PROPERTY_TYPE'])[m
[31m-			$arFilePropList[$arProp['CODE']] = $strPropName;[m
[31m-		if ('L' == $arProp['PROPERTY_TYPE'])[m
[31m-			$arListPropList[$arProp['CODE']] = $strPropName;[m
[31m-		if ('S' == $arProp['PROPERTY_TYPE'] && 'directory' == $arProp['USER_TYPE'] && CIBlockPriceTools::checkPropDirectory($arProp))[m
[31m-			$arHighloadPropList[$arProp['CODE']] = $strPropName;[m
[31m-	}[m
[31m-[m
[31m-	$arTemplateParameters['ADD_PICT_PROP'] = array([m
[31m-		'PARENT' => 'VISUAL',[m
[31m-		'NAME' => GetMessage('CP_BCE_TPL_ADD_PICT_PROP'),[m
[31m-		'TYPE' => 'LIST',[m
[31m-		'MULTIPLE' => 'N',[m
[31m-		'ADDITIONAL_VALUES' => 'N',[m
[31m-		'REFRESH' => 'N',[m
[31m-		'DEFAULT' => '-',[m
[31m-		'VALUES' => $arFilePropList[m
[31m-	);[m
[31m-[m
[31m-	$arTemplateParameters['LABEL_PROP'] = array([m
[31m-		'PARENT' => 'VISUAL',[m
[31m-		'NAME' => GetMessage('CP_BCE_TPL_LABEL_PROP'),[m
[31m-		'TYPE' => 'LIST',[m
[31m-		'MULTIPLE' => 'N',[m
[31m-		'ADDITIONAL_VALUES' => 'N',[m
[31m-		'REFRESH' => 'N',[m
[31m-		'DEFAULT' => '-',[m
[31m-		'VALUES' => $arListPropList[m
[31m-	);[m
[31m-[m
[31m-	if ($boolSKU)[m
[31m-	{[m
[31m-		$arAllOfferPropList = array();[m
[31m-		$arFileOfferPropList = array([m
[31m-			'-' => GetMessage('CP_BCE_TPL_PROP_EMPTY')[m
[31m-		);[m
[31m-		$arTreeOfferPropList = array([m
[31m-			'-' => GetMessage('CP_BCE_TPL_PROP_EMPTY')[m
[31m-		);[m
[31m-		$rsProps = CIBlockProperty::GetList([m
[31m-			array('SORT' => 'ASC', 'ID' => 'ASC'),[m
[31m-			array('IBLOCK_ID' => $arSKU['IBLOCK_ID'], 'ACTIVE' => 'Y')[m
[31m-		);[m
[31m-		while ($arProp = $rsProps->Fetch())[m
[31m-		{[m
[31m-			if ($arProp['ID'] == $arSKU['SKU_PROPERTY_ID'])[m
[31m-				continue;[m
[31m-			$arProp['USER_TYPE'] = (string)$arProp['USER_TYPE'];[m
[31m-			$strPropName = '['.$arProp['ID'].']'.('' != $arProp['CODE'] ? '['.$arProp['CODE'].']' : '').' '.$arProp['NAME'];[m
[31m-			if ('' == $arProp['CODE'])[m
[31m-				$arProp['CODE'] = $arProp['ID'];[m
[31m-			$arAllOfferPropList[$arProp['CODE']] = $strPropName;[m
[31m-			if ('F' == $arProp['PROPERTY_TYPE'])[m
[31m-				$arFileOfferPropList[$arProp['CODE']] = $strPropName;[m
[31m-			if ('N' != $arProp['MULTIPLE'])[m
[31m-				continue;[m
[31m-			if ([m
[31m-				'L' == $arProp['PROPERTY_TYPE'][m
[31m-				|| 'E' == $arProp['PROPERTY_TYPE'][m
[31m-				|| ('S' == $arProp['PROPERTY_TYPE'] && 'directory' == $arProp['USER_TYPE'] && CIBlockPriceTools::checkPropDirectory($arProp))[m
[31m-			)[m
[31m-				$arTreeOfferPropList[$arProp['CODE']] = $strPropName;[m
[31m-		}[m
[31m-		$arTemplateParameters['OFFER_ADD_PICT_PROP'] = array([m
[31m-			'PARENT' => 'VISUAL',[m
[31m-			'NAME' => GetMessage('CP_BCE_TPL_OFFER_ADD_PICT_PROP'),[m
[31m-			'TYPE' => 'LIST',[m
[31m-			'MULTIPLE' => 'N',[m
[31m-			'ADDITIONAL_VALUES' => 'N',[m
[31m-			'REFRESH' => 'N',[m
[31m-			'DEFAULT' => '-',[m
[31m-			'VALUES' => $arFileOfferPropList[m
[31m-		);[m
[31m-		$arTemplateParameters['OFFER_TREE_PROPS'] = array([m
[31m-			'PARENT' => 'VISUAL',[m
[31m-			'NAME' => GetMessage('CP_BCE_TPL_OFFER_TREE_PROPS'),[m
[31m-			'TYPE' => 'LIST',[m
[31m-			'MULTIPLE' => 'Y',[m
[31m-			'ADDITIONAL_VALUES' => 'N',[m
[31m-			'REFRESH' => 'N',[m
[31m-			'DEFAULT' => '-',[m
[31m-			'VALUES' => $arTreeOfferPropList[m
[31m-		);[m
[31m-	}[m
[31m-}[m
[31m-[m
[31m-$arTemplateParameters['DISPLAY_NAME'] = array([m
[31m-	'PARENT' => 'VISUAL',[m
[31m-	'NAME' => GetMessage('CP_BCE_TPL_DISPLAY_NAME'),[m
[31m-	'TYPE' => 'CHECKBOX',[m
[31m-	'DEFAULT' => 'Y'[m
[31m-);[m
[31m-[m
[31m-$detailPictMode = array([m
[31m-	'IMG' => GetMessage('DETAIL_PICTURE_MODE_IMG'),[m
[31m-	'POPUP' => GetMessage('DETAIL_PICTURE_MODE_POPUP'),[m
[31m-	'MAGNIFIER' => GetMessage('DETAIL_PICTURE_MODE_MAGNIFIER')[m
[31m-);[m
[31m-[m
[31m-$arTemplateParameters['DETAIL_PICTURE_MODE'] = array([m
[31m-	'PARENT' => 'VISUAL',[m
[31m-	'NAME' => GetMessage('CP_BCE_TPL_DETAIL_PICTURE_MODE'),[m
[31m-	'TYPE' => 'LIST',[m
[31m-	'DEFAULT' => 'IMG',[m
[31m-	'VALUES' => $detailPictMode[m
[31m-);[m
[31m-[m
[31m-$arTemplateParameters['ADD_DETAIL_TO_SLIDER'] = array([m
[31m-	'PARENT' => 'VISUAL',[m
[31m-	'NAME' => GetMessage('CP_BCE_TPL_ADD_DETAIL_TO_SLIDER'),[m
[31m-	'TYPE' => 'CHECKBOX',[m
[31m-	'DEFAULT' => 'N'[m
[31m-);[m
[31m-[m
[31m-$displayPreviewTextMode = array([m
[31m-	'H' => GetMessage('CP_BCE_TPL_DISPLAY_PREVIEW_TEXT_MODE_HIDE'),[m
[31m-	'E' => GetMessage('CP_BCE_TPL_DISPLAY_PREVIEW_TEXT_MODE_EMPTY_DETAIL'),[m
[31m-	'S' => GetMessage('CP_BCE_TPL_DISPLAY_PREVIEW_TEXT_MODE_SHOW')[m
[31m-);[m
[31m-[m
[31m-$arTemplateParameters['DISPLAY_PREVIEW_TEXT_MODE'] = array([m
[31m-	'PARENT' => 'VISUAL',[m
[31m-	'NAME' => GetMessage('CP_BCE_TPL_DISPLAY_PREVIEW_TEXT_MODE'),[m
[31m-	'TYPE' => 'LIST',[m
[31m-	'VALUES' => $displayPreviewTextMode,[m
[31m-	'DEFAULT' => 'E'[m
[31m-);[m
[31m-[m
[31m-if ($boolCatalog)[m
[31m-{[m
[31m-	$arTemplateParameters['PRODUCT_SUBSCRIPTION'] = array([m
[31m-		'PARENT' => 'VISUAL',[m
[31m-		'NAME' => GetMessage('CP_BCE_TPL_PRODUCT_SUBSCRIPTION'),[m
[31m-		'TYPE' => 'CHECKBOX',[m
[31m-		'DEFAULT' => 'N'[m
[31m-	);[m
[31m-	$arTemplateParameters['SHOW_DISCOUNT_PERCENT'] = array([m
[31m-		'PARENT' => 'VISUAL',[m
[31m-		'NAME' => GetMessage('CP_BCE_TPL_SHOW_DISCOUNT_PERCENT'),[m
[31m-		'TYPE' => 'CHECKBOX',[m
[31m-		'DEFAULT' => 'N'[m
[31m-	);[m
[31m-	$arTemplateParameters['SHOW_OLD_PRICE'] = array([m
[31m-		'PARENT' => 'VISUAL',[m
[31m-		'NAME' => GetMessage('CP_BCE_TPL_SHOW_OLD_PRICE'),[m
[31m-		'TYPE' => 'CHECKBOX',[m
[31m-		'DEFAULT' => 'N'[m
[31m-	);[m
[31m-	$arTemplateParameters['SHOW_MAX_QUANTITY'] = array([m
[31m-		'PARENT' => 'VISUAL',[m
[31m-		'NAME' => GetMessage('CP_BCE_TPL_SHOW_MAX_QUANTITY'),[m
[31m-		'TYPE' => 'CHECKBOX',[m
[31m-		'DEFAULT' => 'N'[m
[31m-	);[m
[31m-	if (isset($arCurrentValues['USE_PRODUCT_QUANTITY']) && $arCurrentValues['USE_PRODUCT_QUANTITY'] === 'Y')[m
[31m-	{[m
[31m-		$arTemplateParameters['SHOW_BASIS_PRICE'] = array([m
[31m-			"PARENT" => "BASKET",[m
[31m-			"NAME" => GetMessage("CP_BCE_TPL_SHOW_BASIS_PRICE"),[m
[31m-			"TYPE" => "CHECKBOX",[m
[31m-			"DEFAULT" => "N",[m
[31m-			"REFRESH" => "N",[m
[31m-		);[m
[31m-	}[m
[31m-	$addToBasketActions = array([m
[31m-		'BUY' => GetMessage('ADD_TO_BASKET_ACTION_BUY'),[m
[31m-		'ADD' => GetMessage('ADD_TO_BASKET_ACTION_ADD')[m
[31m-	);[m
[31m-	$arTemplateParameters['ADD_TO_BASKET_ACTION'] = array([m
[31m-		'PARENT' => 'BASKET',[m
[31m-		'NAME' => GetMessage('CP_BCE_TPL_ADD_TO_BASKET_ACTION'),[m
[31m-		'TYPE' => 'LIST',[m
[31m-		'MULTIPLE' => 'Y',[m
[31m-		'VALUES' => $addToBasketActions,[m
[31m-		'DEFAULT' => 'BUY',[m
[31m-		'REFRESH' => 'N'[m
[31m-	);[m
[31m-	$arTemplateParameters['SHOW_CLOSE_POPUP'] = array([m
[31m-		'PARENT' => 'VISUAL',[m
[31m-		'NAME' => GetMessage('CP_BCE_TPL_SHOW_CLOSE_POPUP'),[m
[31m-		'TYPE' => 'CHECKBOX',[m
[31m-		'DEFAULT' => 'N'[m
[31m-	);[m
[31m-}[m
[31m-[m
[31m-$arTemplateParameters['MESS_BTN_BUY'] = array([m
[31m-	'PARENT' => 'VISUAL',[m
[31m-	'NAME' => GetMessage('CP_BCE_TPL_MESS_BTN_BUY'),[m
[31m-	'TYPE' => 'STRING',[m
[31m-	'DEFAULT' => GetMessage('CP_BCE_TPL_MESS_BTN_BUY_DEFAULT')[m
[31m-);[m
[31m-$arTemplateParameters['MESS_BTN_ADD_TO_BASKET'] = array([m
[31m-	'PARENT' => 'VISUAL',[m
[31m-	'NAME' => GetMessage('CP_BCE_TPL_MESS_BTN_ADD_TO_BASKET'),[m
[31m-	'TYPE' => 'STRING',[m
[31m-	'DEFAULT' => GetMessage('CP_BCE_TPL_MESS_BTN_ADD_TO_BASKET_DEFAULT')[m
[31m-);[m
[31m-$arTemplateParameters['MESS_BTN_SUBSCRIBE'] = array([m
[31m-	'PARENT' => 'VISUAL',[m
[31m-	'NAME' => GetMessage('CP_BCE_TPL_MESS_BTN_SUBSCRIBE'),[m
[31m-	'TYPE' => 'STRING',[m
[31m-	'DEFAULT' => GetMessage('CP_BCE_TPL_MESS_BTN_SUBSCRIBE_DEFAULT')[m
[31m-);[m
[31m-if (isset($arCurrentValues['DISPLAY_COMPARE']) && 'Y' == isset($arCurrentValues['DISPLAY_COMPARE']))[m
[31m-{[m
[31m-	$arTemplateParameters['MESS_BTN_COMPARE'] = array([m
[31m-		'PARENT' => 'VISUAL',[m
[31m-		'NAME' => GetMessage('CP_BCE_TPL_MESS_BTN_COMPARE'),[m
[31m-		'TYPE' => 'STRING',[m
[31m-		'DEFAULT' => GetMessage('CP_BCE_TPL_MESS_BTN_COMPARE_DEFAULT')[m
[31m-	);[m
[31m-}[m
[31m-$arTemplateParameters['MESS_NOT_AVAILABLE'] = array([m
[31m-	'PARENT' => 'VISUAL',[m
[31m-	'NAME' => GetMessage('CP_BCE_TPL_MESS_NOT_AVAILABLE'),[m
[31m-	'TYPE' => 'STRING',[m
[31m-	'DEFAULT' => GetMessage('CP_BCE_TPL_MESS_NOT_AVAILABLE_DEFAULT')[m
[31m-);[m
[31m-[m
[31m-$arTemplateParameters['USE_VOTE_RATING'] = array([m
[31m-	'PARENT' => 'VISUAL',[m
[31m-	'NAME' => GetMessage('CP_BCE_TPL_USE_VOTE_RATING'),[m
[31m-	'TYPE' => 'CHECKBOX',[m
[31m-	'DEFAULT' => 'N',[m
[31m-	'REFRESH' => 'Y'[m
[31m-);[m
[31m-if (isset($arCurrentValues['USE_VOTE_RATING']) && 'Y' == $arCurrentValues['USE_VOTE_RATING'])[m
[31m-{[m
[31m-	$arTemplateParameters['VOTE_DISPLAY_AS_RATING'] = array([m
[31m-		'NAME' => GetMessage('CP_BCE_TPL_VOTE_DISPLAY_AS_RATING'),[m
[31m-		'TYPE' => 'LIST',[m
[31m-		'VALUES' => array([m
[31m-			'rating' => GetMessage('CP_BCE_TPL_VDAR_RATING'),[m
[31m-			'vote_avg' => GetMessage('CP_BCE_TPL_VDAR_AVERAGE'),[m
[31m-		),[m
[31m-		'DEFAULT' => 'rating'[m
[31m-	);[m
[31m-}[m
[31m-[m
[31m-$arTemplateParameters['USE_COMMENTS'] = array([m
[31m-	'PARENT' => 'VISUAL',[m
[31m-	'NAME' => GetMessage('CP_BCE_TPL_USE_COMMENTS'),[m
[31m-	'TYPE' => 'CHECKBOX',[m
[31m-	'DEFAULT' => 'N',[m
[31m-	'REFRESH' => 'Y'[m
[31m-);[m
[31m-[m
[31m-if (isset($arCurrentValues['USE_COMMENTS']) && $arCurrentValues['USE_COMMENTS'] == 'Y')[m
[31m-{[m
[31m-	if (ModuleManager::isModuleInstalled("blog"))[m
[31m-	{[m
[31m-		$arTemplateParameters['BLOG_USE'] = array([m
[31m-			'PARENT' => 'VISUAL',[m
[31m-			'NAME' => GetMessage('CP_BCE_TPL_BLOG_USE'),[m
[31m-			'TYPE' => 'CHECKBOX',[m
[31m-			'DEFAULT' => 'N',[m
[31m-			'REFRESH' => 'Y'[m
[31m-		);[m
[31m-[m
[31m-		if (isset($arCurrentValues['BLOG_USE']) && $arCurrentValues['BLOG_USE'] == 'Y')[m
[31m-		{[m
[31m-			$arTemplateParameters['BLOG_URL'] = array([m
[31m-				'PARENT' => 'VISUAL',[m
[31m-				'NAME' => GetMessage('CP_BCE_TPL_BLOG_URL'),[m
[31m-				'TYPE' => 'STRING',[m
[31m-				'DEFAULT' => 'catalog_comments'[m
[31m-			);[m
[31m-			$arTemplateParameters['BLOG_EMAIL_NOTIFY'] = array([m
[31m-				'PARENT' => 'VISUAL',[m
[31m-				'NAME' => GetMessage('CP_BCE_TPL_BLOG_EMAIL_NOTIFY'),[m
[31m-				'TYPE' => 'CHECKBOX',[m
[31m-				'DEFAULT' => 'N'[m
[31m-			);[m
[31m-		}[m
[31m-	}[m
[31m-[m
[31m-	$boolRus = false;[m
[31m-	$langBy = "id";[m
[31m-	$langOrder = "asc";[m
[31m-	$rsLangs = CLanguage::GetList($langBy, $langOrder, array('ID' => 'ru',"ACTIVE" => "Y"));[m
[31m-	if ($arLang = $rsLangs->Fetch())[m
[31m-	{[m
[31m-		$boolRus = true;[m
[31m-	}[m
[31m-[m
[31m-	if ($boolRus)[m
[31m-	{[m
[31m-		$arTemplateParameters['VK_USE'] = array([m
[31m-			'PARENT' => 'VISUAL',[m
[31m-			'NAME' => GetMessage('CP_BCE_TPL_VK_USE'),[m
[31m-			'TYPE' => 'CHECKBOX',[m
[31m-			'DEFAULT' => 'N',[m
[31m-			'REFRESH' => 'Y'[m
[31m-		);[m
[31m-[m
[31m-		if (isset($arCurrentValues['VK_USE']) && 'Y' == $arCurrentValues['VK_USE'])[m
[31m-		{[m
[31m-			$arTemplateParameters['VK_API_ID'] = array([m
[31m-				'PARENT' => 'VISUAL',[m
[31m-				'NAME' => GetMessage('CP_BCE_TPL_VK_API_ID'),[m
[31m-				'TYPE' => 'STRING',[m
[31m-				'DEFAULT' => 'API_ID'[m
[31m-			);[m
[31m-		}[m
[31m-	}[m
[31m-[m
[31m-	$arTemplateParameters['FB_USE'] = array([m
[31m-		'PARENT' => 'VISUAL',[m
[31m-		'NAME' => GetMessage('CP_BCE_TPL_FB_USE'),[m
[31m-		'TYPE' => 'CHECKBOX',[m
[31m-		'DEFAULT' => 'N',[m
[31m-		'REFRESH' => 'Y'[m
[31m-	);[m
[31m-[m
[31m-	if (isset($arCurrentValues['FB_USE']) && 'Y' == $arCurrentValues['FB_USE'])[m
[31m-	{[m
[31m-		$arTemplateParameters['FB_APP_ID'] = array([m
[31m-			'PARENT' => 'VISUAL',[m
[31m-			'NAME' => GetMessage('CP_BCE_TPL_FB_APP_ID'),[m
[31m-			'TYPE' => 'STRING',[m
[31m-			'DEFAULT' => ''[m
[31m-		);[m
[31m-	}[m
[31m-}[m
[31m-[m
[31m-if (ModuleManager::isModuleInstalled("highloadblock"))[m
[31m-{[m
[31m-	$arTemplateParameters['BRAND_USE'] = array([m
[31m-		'PARENT' => 'VISUAL',[m
[31m-		'NAME' => GetMessage('CP_BCE_TPL_BRAND_USE'),[m
[31m-		'TYPE' => 'CHECKBOX',[m
[31m-		'DEFAULT' => 'N',[m
[31m-		'REFRESH' => 'Y'[m
[31m-	);[m
[31m-[m
[31m-	if (isset($arCurrentValues['BRAND_USE']) && $arCurrentValues['BRAND_USE'] == 'Y')[m
[31m-	{[m
[31m-		$arTemplateParameters['BRAND_PROP_CODE'] = array([m
[31m-			'PARENT' => 'VISUAL',[m
[31m-			"NAME" => GetMessage("CP_BCE_TPL_BRAND_PROP_CODE"),[m
[31m-			"TYPE" => "LIST",[m
[31m-			"VALUES" => $arHighloadPropList,[m
[31m-			"MULTIPLE" => "Y",[m
[31m-			"ADDITIONAL_VALUES" => "Y"[m
[31m-		);[m
[31m-	}[m
[31m-}[m
[31m-?>[m
\ No newline at end of file[m
[1mdiff --git a/local/components/zakrepi/catalog.element/templates/.default/component_epilog.php b/local/components/zakrepi/catalog.element/templates/.default/component_epilog.php[m
[1mdeleted file mode 100644[m
[1mindex 5f480d1..0000000[m
[1m--- a/local/components/zakrepi/catalog.element/templates/.default/component_epilog.php[m
[1m+++ /dev/null[m
[36m@@ -1,36 +0,0 @@[m
[31m-<?if(!defined("B_PROLOG_INCLUDED") || B_PROLOG_INCLUDED!==true)die();[m
[31m-/** @var array $templateData */[m
[31m-/** @var @global CMain $APPLICATION */[m
[31m-use Bitrix\Main\Loader;[m
[31m-global $APPLICATION;[m
[31m-if (isset($templateData['TEMPLATE_THEME']))[m
[31m-{[m
[31m-	$APPLICATION->SetAdditionalCSS($templateData['TEMPLATE_THEME']);[m
[31m-}[m
[31m-if (isset($templateData['TEMPLATE_LIBRARY']) && !empty($templateData['TEMPLATE_LIBRARY']))[m
[31m-{[m
[31m-	$loadCurrency = false;[m
[31m-	if (!empty($templateData['CURRENCIES']))[m
[31m-		$loadCurrency = Loader::includeModule('currency');[m
[31m-	CJSCore::Init($templateData['TEMPLATE_LIBRARY']);[m
[31m-	if ($loadCurrency)[m
[31m-	{[m
[31m-	?>[m
[31m-	<script type="text/javascript">[m
[31m-		BX.Currency.setCurrencies(<? echo $templateData['CURRENCIES']; ?>);[m
[31m-	</script>[m
[31m-<?[m
[31m-	}[m
[31m-}[m
[31m-if (isset($templateData['JS_OBJ']))[m
[31m-{[m
[31m-?><script type="text/javascript">[m
[31m-BX.ready(BX.defer(function(){[m
[31m-	if (!!window.<? echo $templateData['JS_OBJ']; ?>)[m
[31m-	{[m
[31m-		window.<? echo $templateData['JS_OBJ']; ?>.allowViewedCount(true);[m
[31m-	}[m
[31m-}));[m
[31m-</script><?[m
[31m-}[m
[31m-?>[m
\ No newline at end of file[m
[1mdiff --git a/local/components/zakrepi/catalog.element/templates/.default/functions.php b/local/components/zakrepi/catalog.element/templates/.default/functions.php[m
[1mdeleted file mode 100644[m
[1mindex 8035e86..0000000[m
[1m--- a/local/components/zakrepi/catalog.element/templates/.default/functions.php[m
[1m+++ /dev/null[m
[36m@@ -1,103 +0,0 @@[m
[31m-<?[m
[31m-if (!defined('B_PROLOG_INCLUDED') || B_PROLOG_INCLUDED!==true) die();[m
[31m-[m
[31m-if (!function_exists('getSliderForItem'))[m
[31m-{[m
[31m-	function getSliderForItem(&$item, $propertyCode, $addDetailToSlider)[m
[31m-	{[m
[31m-		$result = array();[m
[31m-[m
[31m-		if (!empty($item) && is_array($item))[m
[31m-		{[m
[31m-			if ([m
[31m-				'' != $propertyCode &&[m
[31m-				isset($item['PROPERTIES'][$propertyCode]) &&[m
[31m-				'F' == $item['PROPERTIES'][$propertyCode]['PROPERTY_TYPE'][m
[31m-			)[m
[31m-			{[m
[31m-				if ('MORE_PHOTO' == $propertyCode && isset($item['MORE_PHOTO']) && !empty($item['MORE_PHOTO']))[m
[31m-				{[m
[31m-					foreach ($item['MORE_PHOTO'] as &$onePhoto)[m
[31m-					{[m
[31m-						$result[] = array([m
[31m-							'ID' => intval($onePhoto['ID']),[m
[31m-							'SRC' => $onePhoto['SRC'],[m
[31m-							'WIDTH' => intval($onePhoto['WIDTH']),[m
[31m-							'HEIGHT' => intval($onePhoto['HEIGHT'])[m
[31m-						);[m
[31m-					}[m
[31m-					unset($onePhoto);[m
[31m-				}[m
[31m-				else[m
[31m-				{[m
[31m-					if ([m
[31m-						isset($item['DISPLAY_PROPERTIES'][$propertyCode]['FILE_VALUE']) &&[m
[31m-						!empty($item['DISPLAY_PROPERTIES'][$propertyCode]['FILE_VALUE'])[m
[31m-					)[m
[31m-					{[m
[31m-						$fileValues = ([m
[31m-							isset($item['DISPLAY_PROPERTIES'][$propertyCode]['FILE_VALUE']['ID']) ?[m
[31m-							array(0 => $item['DISPLAY_PROPERTIES'][$propertyCode]['FILE_VALUE']) :[m
[31m-							$item['DISPLAY_PROPERTIES'][$propertyCode]['FILE_VALUE'][m
[31m-						);[m
[31m-						foreach ($fileValues as &$oneFileValue)[m
[31m-						{[m
[31m-							$result[] = array([m
[31m-								'ID' => intval($oneFileValue['ID']),[m
[31m-								'SRC' => $oneFileValue['SRC'],[m
[31m-								'WIDTH' => intval($oneFileValue['WIDTH']),[m
[31m-								'HEIGHT' => intval($oneFileValue['HEIGHT'])[m
[31m-							);[m
[31m-						}[m
[31m-						if (isset($oneFileValue))[m
[31m-							unset($oneFileValue);[m
[31m-					}[m
[31m-					else[m
[31m-					{[m
[31m-						$propValues = $item['PROPERTIES'][$propertyCode]['VALUE'];[m
[31m-						if (!is_array($propValues))[m
[31m-							$propValues = array($propValues);[m
[31m-[m
[31m-						foreach ($propValues as &$oneValue)[m
[31m-						{[m
[31m-							$oneFileValue = CFile::GetFileArray($oneValue);[m
[31m-							if (isset($oneFileValue['ID']))[m
[31m-							{[m
[31m-								$result[] = array([m
[31m-									'ID' => intval($oneFileValue['ID']),[m
[31m-									'SRC' => $oneFileValue['SRC'],[m
[31m-									'WIDTH' => intval($oneFileValue['WIDTH']),[m
[31m-									'HEIGHT' => intval($oneFileValue['HEIGHT'])[m
[31m-								);[m
[31m-							}[m
[31m-						}[m
[31m-						if (isset($oneValue))[m
[31m-							unset($oneValue);[m
[31m-					}[m
[31m-				}[m
[31m-			}[m
[31m-			if ($addDetailToSlider || empty($result))[m
[31m-			{[m
[31m-				if (!empty($item['DETAIL_PICTURE']))[m
[31m-				{[m
[31m-					if (!is_array($item['DETAIL_PICTURE']))[m
[31m-						$item['DETAIL_PICTURE'] = CFile::GetFileArray($item['DETAIL_PICTURE']);[m
[31m-					if (isset($item['DETAIL_PICTURE']['ID']))[m
[31m-					{[m
[31m-						array_unshift([m
[31m-							$result,[m
[31m-							array([m
[31m-								'ID' => intval($item['DETAIL_PICTURE']['ID']),[m
[31m-								'SRC' => $item['DETAIL_PICTURE']['SRC'],[m
[31m-								'WIDTH' => intval($item['DETAIL_PICTURE']['WIDTH']),[m
[31m-								'HEIGHT' => intval($item['DETAIL_PICTURE']['HEIGHT'])[m
[31m-							)[m
[31m-						);[m
[31m-					}[m
[31m-				}[m
[31m-			}[m
[31m-		}[m
[31m-		return $result;[m
[31m-	}[m
[31m-}[m
[31m-?>[m
\ No newline at end of file[m
[1mdiff --git a/local/components/zakrepi/catalog.element/templates/.default/images/arr_left.png b/local/components/zakrepi/catalog.element/templates/.default/images/arr_left.png[m
[1mdeleted file mode 100644[m
[1mindex c2ca99a..0000000[m
Binary files a/local/components/zakrepi/catalog.element/templates/.default/images/arr_left.png and /dev/null differ
[1mdiff --git a/local/components/zakrepi/catalog.element/templates/.default/images/arr_right.png b/local/components/zakrepi/catalog.element/templates/.default/images/arr_right.png[m
[1mdeleted file mode 100644[m
[1mindex 2780801..0000000[m
Binary files a/local/components/zakrepi/catalog.element/templates/.default/images/arr_right.png and /dev/null differ
[1mdiff --git a/local/components/zakrepi/catalog.element/templates/.default/images/bt_cart.png b/local/components/zakrepi/catalog.element/templates/.default/images/bt_cart.png[m
[1mdeleted file mode 100644[m
[1mindex 99e42e5..0000000[m
Binary files a/local/components/zakrepi/catalog.element/templates/.default/images/bt_cart.png and /dev/null differ
[1mdiff --git a/local/components/zakrepi/catalog.element/templates/.default/images/fade_left.png b/local/components/zakrepi/catalog.element/templates/.default/images/fade_left.png[m
[1mdeleted file mode 100644[m
[1mindex 8f2b0fb..0000000[m
Binary files a/local/components/zakrepi/catalog.element/templates/.default/images/fade_left.png and /dev/null differ
[1mdiff --git a/local/components/zakrepi/catalog.element/templates/.default/images/fade_right.png b/local/components/zakrepi/catalog.element/templates/.default/images/fade_right.png[m
[1mdeleted file mode 100644[m
[1mindex 3baf05f..0000000[m
Binary files a/local/components/zakrepi/catalog.element/templates/.default/images/fade_right.png and /dev/null differ
[1mdiff --git a/local/components/zakrepi/catalog.element/templates/.default/images/missing.png b/local/components/zakrepi/catalog.element/templates/.default/images/missing.png[m
[1mdeleted file mode 100644[m
[1mindex 4840256..0000000[m
Binary files a/local/components/zakrepi/catalog.element/templates/.default/images/missing.png and /dev/null differ
[1mdiff --git a/local/components/zakrepi/catalog.element/templates/.default/images/no_photo.png b/local/components/zakrepi/catalog.element/templates/.default/images/no_photo.png[m
[1mdeleted file mode 100644[m
[1mindex f9dd583..0000000[m
Binary files a/local/components/zakrepi/catalog.element/templates/.default/images/no_photo.png and /dev/null differ
[1mdiff --git a/local/components/zakrepi/catalog.element/templates/.default/images/stick.png b/local/components/zakrepi/catalog.element/templates/.default/images/stick.png[m
[1mdeleted file mode 100644[m
[1mindex 812eb80..0000000[m
Binary files a/local/components/zakrepi/catalog.element/templates/.default/images/stick.png and /dev/null differ
[1mdiff --git a/local/components/zakrepi/catalog.element/templates/.default/images/stick_disc.png b/local/components/zakrepi/catalog.element/templates/.default/images/stick_disc.png[m
[1mdeleted file mode 100644[m
[1mindex 84b98e4..0000000[m
Binary files a/local/components/zakrepi/catalog.element/templates/.default/images/stick_disc.png and /dev/null differ
[1mdiff --git a/local/components/zakrepi/catalog.element/templates/.default/images/wait.gif b/local/components/zakrepi/catalog.element/templates/.default/images/wait.gif[m
[1mdeleted file mode 100644[m
[1mindex 35ff684..0000000[m
Binary files a/local/components/zakrepi/catalog.element/templates/.default/images/wait.gif and /dev/null differ
[1mdiff --git a/local/components/zakrepi/catalog.element/templates/.default/images/x2border.png b/local/components/zakrepi/catalog.element/templates/.default/images/x2border.png[m
[1mdeleted file mode 100644[m
[1mindex e7b32cf..0000000[m
Binary files a/local/components/zakrepi/catalog.element/templates/.default/images/x2border.png and /dev/null differ
[1mdiff --git a/local/components/zakrepi/catalog.element/templates/.default/images/x2border_active.png b/local/components/zakrepi/catalog.element/templates/.default/images/x2border_active.png[m
[1mdeleted file mode 100644[m
[1mindex 7eb3fee..0000000[m
Binary files a/local/components/zakrepi/catalog.element/templates/.default/images/x2border_active.png and /dev/null differ
[1mdiff --git a/local/components/zakrepi/catalog.element/templates/.default/lang/en/.parameters.php b/local/components/zakrepi/catalog.element/templates/.default/lang/en/.parameters.php[m
[1mdeleted file mode 100644[m
[1mindex 5f48f2c..0000000[m
[1m--- a/local/components/zakrepi/catalog.element/templates/.default/lang/en/.parameters.php[m
[1m+++ /dev/null[m
[36m@@ -1,78 +0,0 @@[m
[31m-<?[m
[31m-$MESS["CP_BCE_TPL_THEME_SITE"] = "Use site theme (for bitrix.eshop)";[m
[31m-$MESS["CP_BCE_TPL_THEME_BLUE"] = "blue (default theme)";[m
[31m-$MESS["CP_BCE_TPL_THEME_GREEN"] = "green";[m
[31m-$MESS["CP_BCE_TPL_THEME_RED"] = "red";[m
[31m-$MESS["CP_BCE_TPL_THEME_WOOD"] = "wood";[m
[31m-$MESS["CP_BCE_TPL_THEME_YELLOW"] = "yellow";[m
[31m-$MESS["CP_BCE_TPL_THEME_BLACK"] = "dark";[m
[31m-$MESS["CP_BCE_TPL_PROP_EMPTY"] = "not selected";[m
[31m-$MESS["CP_BCE_TPL_VDAR_RATING"] = "rating value";[m
[31m-$MESS["CP_BCE_TPL_VDAR_AVERAGE"] = "average value";[m
[31m-$MESS["CP_BCE_TPL_TEMPLATE_THEME"] = "Color theme";[m
[31m-$MESS["CP_BCE_TPL_ADD_PICT_PROP"] = "Additional image of main item";[m
[31m-$MESS["CP_BCE_TPL_LABEL_PROP"] = "Product tag property";[m
[31m-$MESS["CP_BCE_TPL_OFFER_ADD_PICT_PROP"] = "Additional image property of SKU";[m
[31m-$MESS["CP_BCE_TPL_OFFER_TREE_PROPS"] = "Properties for grouping of SKUs";[m
[31m-$MESS["CP_BCE_TPL_DISPLAY_NAME"] = "Display element title";[m
[31m-$MESS["CP_BCE_TPL_DETAIL_PICTURE_MODE"] = "Detailed image view mode";[m
[31m-$MESS["CP_BCE_TPL_ADD_DETAIL_TO_SLIDER"] = "Add detailed image to slider";[m
[31m-$MESS["CP_BCE_TPL_DISPLAY_PREVIEW_TEXT_MODE"] = "Show short description";[m
[31m-$MESS["CP_BCE_TPL_DISPLAY_PREVIEW_TEXT_MODE_HIDE"] = "never";[m
[31m-$MESS["CP_BCE_TPL_DISPLAY_PREVIEW_TEXT_MODE_SHOW"] = "always";[m
[31m-$MESS["CP_BCE_TPL_DISPLAY_PREVIEW_TEXT_MODE_EMPTY_DETAIL"] = "only if detailed description is missing";[m
[31m-$MESS["CP_BCE_TPL_PRODUCT_SUBSCRIPTION"] = "Enable back-in-stock notifications";[m
[31m-$MESS["CP_BCE_TPL_SHOW_DISCOUNT_PERCENT"] = "Show discount value";[m
[31m-$MESS["CP_BCE_TPL_SHOW_OLD_PRICE"] = "Show previous price";[m
[31m-$MESS["CP_BCE_TPL_SHOW_MAX_QUANTITY"] = "Show product total quantity";[m
[31m-$MESS["CP_BCE_TPL_SHOW_BASIS_PRICE"] = "Show product item price";[m
[31m-$MESS["CP_BCE_TPL_ADD_TO_BASKET_ACTION"] = "Show \"Add to Cart\" and \"Buy Now\" buttons";[m
[31m-$MESS["CP_BCE_TPL_SHOW_CLOSE_POPUP"] = "Show \"Continue Shopping\" button in popup windows";[m
[31m-$MESS["CP_BCE_TPL_MESS_BTN_BUY"] = "\"Buy\" button text";[m
[31m-$MESS["CP_BCE_TPL_MESS_BTN_ADD_TO_BASKET"] = "\"Add to cart\" button text";[m
[31m-$MESS["CP_BCE_TPL_MESS_BTN_SUBSCRIBE"] = "\"Notify when back in stock\" button text";[m
[31m-$MESS["CP_BCE_TPL_MESS_BTN_COMPARE"] = "\"Compare\" button text";[m
[31m-$MESS["CP_BCE_TPL_MESS_NOT_AVAILABLE"] = "Item not available message";[m
[31m-$MESS["CP_BCE_TPL_USE_VOTE_RATING"] = "Enable product rating";[m
[31m-$MESS["CP_BCE_TPL_VOTE_DISPLAY_AS_RATING"] = "Show in rating ";[m
[31m-$MESS["CP_BCE_TPL_USE_COMMENTS"] = "Enable product comments";[m
[31m-$MESS["CP_BCE_TPL_BLOG_USE"] = "Use comments";[m
[31m-$MESS["CP_BCE_TPL_BLOG_URL"] = "Blog name (Latin only)";[m
[31m-$MESS["CP_BCE_TPL_BLOG_EMAIL_NOTIFY"] = "E-mail notification";[m
[31m-$MESS["CP_BCE_TPL_VK_USE"] = "Use VK";[m
[31m-$MESS["CP_BCE_TPL_VK_API_ID"] = "API_ID";[m
[31m-$MESS["CP_BCE_TPL_FB_USE"] = "Use Facebook";[m
[31m-$MESS["CP_BCE_TPL_FB_APP_ID"] = "APP_ID";[m
[31m-$MESS["CP_BCE_TPL_MESS_BTN_BUY_DEFAULT"] = "Buy";[m
[31m-$MESS["CP_BCE_TPL_MESS_NOT_AVAILABLE_DEFAULT"] = "Item not available";[m
[31m-$MESS["CP_BCE_TPL_MESS_BTN_ADD_TO_BASKET_DEFAULT"] = "Add to cart";[m
[31m-$MESS["CP_BCE_TPL_MESS_BTN_SUBSCRIBE_DEFAULT"] = "Notify when back in stock";[m
[31m-$MESS["CP_BCE_TPL_MESS_BTN_COMPARE_DEFAULT"] = "Compare";[m
[31m-$MESS["CP_BCE_TPL_MESS_BTN_DETAIL_DEFAULT"] = "Details";[m
[31m-$MESS["CP_BCE_TPL_BRAND_USE"] = "Use \"Brands\" component";[m
[31m-$MESS["CP_BCE_TPL_BRAND_PROP_CODE"] = "Information block containing brand data";[m
[31m-$MESS["DETAIL_PICTURE_MODE_IMG"] = "normal";[m
[31m-$MESS["DETAIL_PICTURE_MODE_POPUP"] = "in popup window";[m
[31m-$MESS["DETAIL_PICTURE_MODE_MAGNIFIER"] = "zoom";[m
[31m-$MESS["DETAIL_PICTURE_MODE_GALLERY"] = "gallery";[m
[31m-$MESS["ADD_TO_BASKET_ACTION_BUY"] = "Buy Now";[m
[31m-$MESS["ADD_TO_BASKET_ACTION_ADD"] = "Add to Cart";[m
[31m-$MESS["TEMPLATE_THEME_TIP"] = "Defines colors for rendering the website text and graphics. Blue theme is the default option.";[m
[31m-$MESS["ADD_PICT_PROP_TIP"] = "Additional images property for product";[m
[31m-$MESS["LABEL_PROP_TIP"] = "Product tag property";[m
[31m-$MESS["OFFER_TREE_PROPS_TIP"] = "List of properties by which SKUs will be grouped and displayed";[m
[31m-$MESS["ADD_DETAIL_TO_SLIDER_TIP"] = "The detailed image will be shown with the other images in the product image slider.";[m
[31m-$MESS["DISPLAY_PREVIEW_TEXT_MODE_TIP"] = "Use this option to specify how and if at all a short description can be shown on an item details page";[m
[31m-$MESS["PRODUCT_SUBSCRIPTION_TIP"] = "Enables the system to notify a customer of the new arrival of a previously out-of-stock item he or she took a particular interest in";[m
[31m-$MESS["SHOW_DISCOUNT_PERCENT_TIP"] = "If the discount is active, shows the discount percent value";[m
[31m-$MESS["SHOW_OLD_PRICE_TIP"] = "If the discount is active, shows the previous price";[m
[31m-$MESS["SHOW_MAX_QUANTITY_TIP"] = "Show total quantity if stock control is enabled for a product";[m
[31m-$MESS["SHOW_CLOSE_POPUP_TIP"] = "If checked, popup windows will show the \"Continue Shopping\" button";[m
[31m-$MESS["MESS_BTN_BUY_TIP"] = "Text to display on button";[m
[31m-$MESS["MESS_BTN_ADD_TO_BASKET_TIP"] = "Text to display on button";[m
[31m-$MESS["MESS_BTN_SUBSCRIBE_TIP"] = "Text to display on button";[m
[31m-$MESS["MESS_BTN_COMPARE_TIP"] = "Text to display on button";[m
[31m-$MESS["MESS_NOT_AVAILABLE_TIP"] = "Item not available message";[m
[31m-$MESS["USE_VOTE_RATING_TIP"] = "Show and use product voting controls";[m
[31m-$MESS["USE_COMMENTS_TIP"] = "Show and use product comments";[m
[31m-?>[m
\ No newline at end of file[m
[1mdiff --git a/local/components/zakrepi/catalog.element/templates/.default/lang/en/template.php b/local/components/zakrepi/catalog.element/templates/.default/lang/en/template.php[m
[1mdeleted file mode 100644[m
[1mindex d1e09c6..0000000[m
[1m--- a/local/components/zakrepi/catalog.element/templates/.default/lang/en/template.php[m
[1m+++ /dev/null[m
[36m@@ -1,34 +0,0 @@[m
[31m-<?[m
[31m-$MESS["CATALOG_QUANTITY"] = "Quantity";[m
[31m-$MESS["CATALOG_QUANTITY_FROM_TO"] = "from #FROM# to #TO#";[m
[31m-$MESS["CATALOG_QUANTITY_FROM"] = "#FROM# and more";[m
[31m-$MESS["CATALOG_QUANTITY_TO"] = "up to #TO#";[m
[31m-$MESS["CATALOG_PRICE_VAT"] = "tax included";[m
[31m-$MESS["CATALOG_PRICE_NOVAT"] = "tax excluded";[m
[31m-$MESS["CATALOG_VAT"] = "Tax rate";[m
[31m-$MESS["CATALOG_NO_VAT"] = "not taxed";[m
[31m-$MESS["CATALOG_VAT_INCLUDED"] = "Tax rate included in price";[m
[31m-$MESS["CATALOG_VAT_NOT_INCLUDED"] = "Tax rate not included in price";[m
[31m-$MESS["CT_BCE_QUANTITY"] = "Quantity";[m
[31m-$MESS["CT_BCE_CATALOG_BUY"] = "Buy";[m
[31m-$MESS["CT_BCE_CATALOG_ADD"] = "Add to cart";[m
[31m-$MESS["CT_BCE_CATALOG_COMPARE"] = "Compare";[m
[31m-$MESS["CT_BCE_CATALOG_NOT_AVAILABLE"] = "not available from stock";[m
[31m-$MESS["OSTATOK"] = "Quantity in stock";[m
[31m-$MESS["COMMENTARY"] = "Comments";[m
[31m-$MESS["CT_BCE_CATALOG_ECONOMY_INFO"] = "(Savings - #ECONOMY#)";[m
[31m-$MESS["FULL_DESCRIPTION"] = "Full description";[m
[31m-$MESS["CT_BCE_CATALOG_TITLE_ERROR"] = "Error";[m
[31m-$MESS["CT_BCE_CATALOG_TITLE_BASKET_PROPS"] = "Item properties to pass to shopping cart";[m
[31m-$MESS["CT_BCE_CATALOG_BASKET_UNKNOWN_ERROR"] = "Unknown error adding an item to shopping cart";[m
[31m-$MESS["CT_BCE_CATALOG_BTN_SEND_PROPS"] = "Select";[m
[31m-$MESS["CT_BCE_CATALOG_BTN_MESSAGE_CLOSE"] = "Close";[m
[31m-$MESS["CT_BCE_CATALOG_BTN_MESSAGE_BASKET_REDIRECT"] = "View shopping cart";[m
[31m-$MESS["CT_BCE_CATALOG_ADD_TO_BASKET_OK"] = "Added to your shopping cart";[m
[31m-$MESS["CT_BCE_CATALOG_MESS_BASIS_PRICE"] = "#PRICE# for 1 #MEASURE#";[m
[31m-$MESS["CT_BCE_CATALOG_BTN_MESSAGE_CLOSE_POPUP"] = "Continue shopping";[m
[31m-$MESS["CT_BCE_CATALOG_MESS_COMPARE_OK"] = "Product has been added to comparison chart";[m
[31m-$MESS["CT_BCE_CATALOG_MESS_COMPARE_TITLE"] = "Product comparison";[m
[31m-$MESS["CT_BCE_CATALOG_MESS_COMPARE_UNKNOWN_ERROR"] = "Error adding the product to comparison chart";[m
[31m-$MESS["CT_BCE_CATALOG_BTN_MESSAGE_COMPARE_REDIRECT"] = "Compare products";[m
[31m-?>[m
\ No newline at end of file[m
[1mdiff --git a/local/components/zakrepi/catalog.element/templates/.default/lang/ru/.parameters.php b/local/components/zakrepi/catalog.element/templates/.default/lang/ru/.parameters.php[m
[1mdeleted file mode 100644[m
[1mindex 3513980..0000000[m
[1m--- a/local/components/zakrepi/catalog.element/templates/.default/lang/ru/.parameters.php[m
[1m+++ /dev/null[m
[36m@@ -1,78 +0,0 @@[m
[31m-<?[m
[31m-$MESS["CP_BCE_TPL_THEME_SITE"] = "Брать тему из настроек сайта (для решения bitrix.eshop)";[m
[31m-$MESS["CP_BCE_TPL_THEME_BLUE"] = "синяя (тема по умолчанию)";[m
[31m-$MESS["CP_BCE_TPL_THEME_GREEN"] = "зеленая";[m
[31m-$MESS["CP_BCE_TPL_THEME_RED"] = "красная";[m
[31m-$MESS["CP_BCE_TPL_THEME_WOOD"] = "дерево";[m
[31m-$MESS["CP_BCE_TPL_THEME_YELLOW"] = "желтая";[m
[31m-$MESS["CP_BCE_TPL_THEME_BLACK"] = "темная";[m
[31m-$MESS["CP_BCE_TPL_PROP_EMPTY"] = "не выбрано";[m
[31m-$MESS["CP_BCE_TPL_VDAR_RATING"] = "рейтинг";[m
[31m-$MESS["CP_BCE_TPL_VDAR_AVERAGE"] = "среднее значение";[m
[31m-$MESS["CP_BCE_TPL_TEMPLATE_THEME"] = "Цветовая тема";[m
[31m-$MESS["CP_BCE_TPL_ADD_PICT_PROP"] = "Дополнительная картинка основного товара";[m
[31m-$MESS["CP_BCE_TPL_LABEL_PROP"] = "Свойство меток товара";[m
[31m-$MESS["CP_BCE_TPL_OFFER_ADD_PICT_PROP"] = "Дополнительные картинки предложения";[m
[31m-$MESS["CP_BCE_TPL_OFFER_TREE_PROPS"] = "Свойства для отбора предложений";[m
[31m-$MESS["CP_BCE_TPL_DISPLAY_NAME"] = "Выводить название элемента";[m
[31m-$MESS["CP_BCE_TPL_DETAIL_PICTURE_MODE"] = "Режим показа детальной картинки";[m
[31m-$MESS["CP_BCE_TPL_ADD_DETAIL_TO_SLIDER"] = "Добавлять детальную картинку в слайдер";[m
[31m-$MESS["CP_BCE_TPL_DISPLAY_PREVIEW_TEXT_MODE"] = "Показ описания для анонса";[m
[31m-$MESS["CP_BCE_TPL_DISPLAY_PREVIEW_TEXT_MODE_HIDE"] = "не показывать";[m
[31m-$MESS["CP_BCE_TPL_DISPLAY_PREVIEW_TEXT_MODE_SHOW"] = "показывать всегда";[m
[31m-$MESS["CP_BCE_TPL_DISPLAY_PREVIEW_TEXT_MODE_EMPTY_DETAIL"] = "показывать, если детальное описание пусто";[m
[31m-$MESS["CP_BCE_TPL_PRODUCT_SUBSCRIPTION"] = "Разрешить оповещения для отсутствующих товаров";[m
[31m-$MESS["CP_BCE_TPL_SHOW_DISCOUNT_PERCENT"] = "Показывать процент скидки";[m
[31m-$MESS["CP_BCE_TPL_SHOW_OLD_PRICE"] = "Показывать старую цену";[m
[31m-$MESS["CP_BCE_TPL_SHOW_MAX_QUANTITY"] = "Показывать общее количество товара";[m
[31m-$MESS["CP_BCE_TPL_SHOW_BASIS_PRICE"] = "Показывать цену за единицу товара";[m
[31m-$MESS["CP_BCE_TPL_ADD_TO_BASKET_ACTION"] = "Показывать кнопки добавления в корзину и покупки";[m
[31m-$MESS["CP_BCE_TPL_SHOW_CLOSE_POPUP"] = "Показывать кнопку продолжения покупок во всплывающих окнах";[m
[31m-$MESS["CP_BCE_TPL_MESS_BTN_BUY"] = "Текст кнопки \"Купить\"";[m
[31m-$MESS["CP_BCE_TPL_MESS_BTN_ADD_TO_BASKET"] = "Текст кнопки \"Добавить в корзину\"";[m
[31m-$MESS["CP_BCE_TPL_MESS_BTN_SUBSCRIBE"] = "Текст кнопки \"Уведомить о поступлении\"";[m
[31m-$MESS["CP_BCE_TPL_MESS_BTN_COMPARE"] = "Текст кнопки \"Сравнить\"";[m
[31m-$MESS["CP_BCE_TPL_MESS_NOT_AVAILABLE"] = "Сообщение об отсутствии товара";[m
[31m-$MESS["CP_BCE_TPL_USE_VOTE_RATING"] = "Включить рейтинг товара";[m
[31m-$MESS["CP_BCE_TPL_VOTE_DISPLAY_AS_RATING"] = "В качестве рейтинга показывать";[m
[31m-$MESS["CP_BCE_TPL_USE_COMMENTS"] = "Включить отзывы о товаре";[m
[31m-$MESS["CP_BCE_TPL_BLOG_USE"] = "Использовать комментарии";[m
[31m-$MESS["CP_BCE_TPL_BLOG_URL"] = "Название блога латинскими буквами";[m
[31m-$MESS["CP_BCE_TPL_BLOG_EMAIL_NOTIFY"] = "Уведомление по электронной почте";[m
[31m-$MESS["CP_BCE_TPL_VK_USE"] = "Использовать Вконтакте";[m
[31m-$MESS["CP_BCE_TPL_VK_API_ID"] = "Идентификатор приложения Вконтакте (API_ID)";[m
[31m-$MESS["CP_BCE_TPL_FB_USE"] = "Использовать Facebook";[m
[31m-$MESS["CP_BCE_TPL_FB_APP_ID"] = "Идентификатор приложения (APP_ID)";[m
[31m-$MESS["CP_BCE_TPL_MESS_BTN_BUY_DEFAULT"] = "Купить";[m
[31m-$MESS["CP_BCE_TPL_MESS_NOT_AVAILABLE_DEFAULT"] = "Нет в наличии";[m
[31m-$MESS["CP_BCE_TPL_MESS_BTN_ADD_TO_BASKET_DEFAULT"] = "В корзину";[m
[31m-$MESS["CP_BCE_TPL_MESS_BTN_SUBSCRIBE_DEFAULT"] = "Подписаться";[m
[31m-$MESS["CP_BCE_TPL_MESS_BTN_COMPARE_DEFAULT"] = "Сравнить";[m
[31m-$MESS["CP_BCE_TPL_MESS_BTN_DETAIL_DEFAULT"] = "Подробнее";[m
[31m-$MESS["CP_BCE_TPL_BRAND_USE"] = "Использовать компонент \"Бренды\"";[m
[31m-$MESS["CP_BCE_TPL_BRAND_PROP_CODE"] = "Таблица с брендами";[m
[31m-$MESS["DETAIL_PICTURE_MODE_IMG"] = "обычный";[m
[31m-$MESS["DETAIL_PICTURE_MODE_POPUP"] = "всплывающее окно";[m
[31m-$MESS["DETAIL_PICTURE_MODE_MAGNIFIER"] = "лупа";[m
[31m-$MESS["DETAIL_PICTURE_MODE_GALLERY"] = "галерея";[m
[31m-$MESS["ADD_TO_BASKET_ACTION_BUY"] = "покупки";[m
[31m-$MESS["ADD_TO_BASKET_ACTION_ADD"] = "добавления в корзину";[m
[31m-$MESS["TEMPLATE_THEME_TIP"] = "Цветовая тема для отображения. По умолчанию берется синяя тема.";[m
[31m-$MESS["ADD_PICT_PROP_TIP"] = "Свойство дополнительных картинок товара";[m
[31m-$MESS["LABEL_PROP_TIP"] = "Свойство меток товара";[m
[31m-$MESS["OFFER_TREE_PROPS_TIP"] = "Свойства, по значениям которых будут группироваться торговые предложения";[m
[31m-$MESS["ADD_DETAIL_TO_SLIDER_TIP"] = "Детальная картинка выводится вместе с дополнительными в слайдере изображений товара";[m
[31m-$MESS["DISPLAY_PREVIEW_TEXT_MODE_TIP"] = "Данная настройка позволяет указать, необходимо ли и когда выводить описание анонса на детальной странице элемента";[m
[31m-$MESS["PRODUCT_SUBSCRIPTION_TIP"] = "Разрешить оповещать клиента, что интересующий его товар стал доступен к покупке";[m
[31m-$MESS["SHOW_DISCOUNT_PERCENT_TIP"] = "Вывод процентного значения скидки, если скидка есть";[m
[31m-$MESS["SHOW_OLD_PRICE_TIP"] = "Показывать старую цену, если есть скидка";[m
[31m-$MESS["SHOW_MAX_QUANTITY_TIP"] = "Показывать общее количество, если для товара включен количественный учет";[m
[31m-$MESS["SHOW_CLOSE_POPUP_TIP"] = "Если опция отмечена, во всплывающих окнах будет показана кнопка \"Продолжить покупки\"";[m
[31m-$MESS["MESS_BTN_BUY_TIP"] = "Какой текст выводить на кнопке";[m
[31m-$MESS["MESS_BTN_ADD_TO_BASKET_TIP"] = "Какой текст выводить на кнопке";[m
[31m-$MESS["MESS_BTN_SUBSCRIBE_TIP"] = "Какой текст выводить на кнопке";[m
[31m-$MESS["MESS_BTN_COMPARE_TIP"] = "Какой текст выводить на кнопке";[m
[31m-$MESS["MESS_NOT_AVAILABLE_TIP"] = "Сообщение об отсутствии товара и невозможности его купить";[m
[31m-$MESS["USE_VOTE_RATING_TIP"] = "Включить рейтингование товара";[m
[31m-$MESS["USE_COMMENTS_TIP"] = "Включить функционал отзывов о товаре";[m
[31m-?>[m
\ No newline at end of file[m
[1mdiff --git a/local/components/zakrepi/catalog.element/templates/.default/lang/ru/template.php b/local/components/zakrepi/catalog.element/templates/.default/lang/ru/template.php[m
[1mdeleted file mode 100644[m
[1mindex 75befba..0000000[m
[1m--- a/local/components/zakrepi/catalog.element/templates/.default/lang/ru/template.php[m
[1m+++ /dev/null[m
[36m@@ -1,34 +0,0 @@[m
[31m-<?[m
[31m-$MESS["CATALOG_QUANTITY"] = "Количество";[m
[31m-$MESS["CATALOG_QUANTITY_FROM_TO"] = "От #FROM# до #TO#";[m
[31m-$MESS["CATALOG_QUANTITY_FROM"] = "От #FROM#";[m
[31m-$MESS["CATALOG_QUANTITY_TO"] = "До #TO#";[m
[31m-$MESS["CATALOG_PRICE_VAT"] = "с НДС";[m
[31m-$MESS["CATALOG_PRICE_NOVAT"] = "без НДС";[m
[31m-$MESS["CATALOG_VAT"] = "НДС";[m
[31m-$MESS["CATALOG_NO_VAT"] = "не облагается";[m
[31m-$MESS["CATALOG_VAT_INCLUDED"] = "НДС включен в цену";[m
[31m-$MESS["CATALOG_VAT_NOT_INCLUDED"] = "НДС не включен в цену";[m
[31m-$MESS["CT_BCE_QUANTITY"] = "Количество";[m
[31m-$MESS["CT_BCE_CATALOG_BUY"] = "Купить";[m
[31m-$MESS["CT_BCE_CATALOG_ADD"] = "В корзину";[m
[31m-$MESS["CT_BCE_CATALOG_COMPARE"] = "Сравнить";[m
[31m-$MESS["CT_BCE_CATALOG_NOT_AVAILABLE"] = "нет на складе";[m
[31m-$MESS["OSTATOK"] = "Остаток";[m
[31m-$MESS["COMMENTARY"] = "Комментарии";[m
[31m-$MESS["CT_BCE_CATALOG_ECONOMY_INFO"] = "(Экономия в цене - #ECONOMY#)";[m
[31m-$MESS["FULL_DESCRIPTION"] = "Полное описание";[m
[31m-$MESS["CT_BCE_CATALOG_TITLE_ERROR"] = "Ошибка";[m
[31m-$MESS["CT_BCE_CATALOG_TITLE_BASKET_PROPS"] = "Свойства товара, добавляемые в корзину";[m
[31m-$MESS["CT_BCE_CATALOG_BASKET_UNKNOWN_ERROR"] = "Неизвестная ошибка при добавлении товара в корзину";[m
[31m-$MESS["CT_BCE_CATALOG_BTN_SEND_PROPS"] = "Выбрать";[m
[31m-$MESS["CT_BCE_CATALOG_BTN_MESSAGE_CLOSE"] = "Закрыть";[m
[31m-$MESS["CT_BCE_CATALOG_BTN_MESSAGE_CLOSE_POPUP"] = "Продолжить покупки";[m
[31m-$MESS["CT_BCE_CATALOG_BTN_MESSAGE_BASKET_REDIRECT"] = "Перейти в корзину";[m
[31m-$MESS["CT_BCE_CATALOG_ADD_TO_BASKET_OK"] = "Товар добавлен в корзину";[m
[31m-$MESS["CT_BCE_CATALOG_MESS_BASIS_PRICE"] = "Цена #PRICE# за 1 #MEASURE#";[m
[31m-$MESS["CT_BCE_CATALOG_MESS_COMPARE_OK"] = "Товар добавлен в список сравнения";[m
[31m-$MESS["CT_BCE_CATALOG_MESS_COMPARE_TITLE"] = "Сравнение товаров";[m
[31m-$MESS["CT_BCE_CATALOG_MESS_COMPARE_UNKNOWN_ERROR"] = "При добавлении товара в список сравнения произошла ошибка";[m
[31m-$MESS["CT_BCE_CATALOG_BTN_MESSAGE_COMPARE_REDIRECT"] = "Перейти в список сравнения";[m
[31m-?>[m
\ No newline at end of file[m
[1mdiff --git a/local/components/zakrepi/catalog.element/templates/.default/result_modifier.php b/local/components/zakrepi/catalog.element/templates/.default/result_modifier.php[m
[1mdeleted file mode 100644[m
[1mindex 4e9386d..0000000[m
[1m--- a/local/components/zakrepi/catalog.element/templates/.default/result_modifier.php[m
[1m+++ /dev/null[m
[36m@@ -1,588 +0,0 @@[m
[31m-<?[m
[31m-use Bitrix\Main\Type\Collection;[m
[31m-use Bitrix\Currency\CurrencyTable;[m
[31m-use Bitrix\Iblock;[m
[31m-[m
[31m-if (!defined('B_PROLOG_INCLUDED') || B_PROLOG_INCLUDED!==true) die();[m
[31m-/** @var CBitrixComponentTemplate $this */[m
[31m-/** @var array $arParams */[m
[31m-/** @var array $arResult */[m
[31m-$displayPreviewTextMode = array([m
[31m-	'H' => true,[m
[31m-	'E' => true,[m
[31m-	'S' => true[m
[31m-);[m
[31m-$detailPictMode = array([m
[31m-	'IMG' => true,[m
[31m-	'POPUP' => true,[m
[31m-	'MAGNIFIER' => true,[m
[31m-	'GALLERY' => true[m
[31m-);[m
[31m-[m
[31m-$arDefaultParams = array([m
[31m-	'TEMPLATE_THEME' => 'blue',[m
[31m-	'ADD_PICT_PROP' => '-',[m
[31m-	'LABEL_PROP' => '-',[m
[31m-	'OFFER_ADD_PICT_PROP' => '-',[m
[31m-	'OFFER_TREE_PROPS' => array('-'),[m
[31m-	'DISPLAY_NAME' => 'Y',[m
[31m-	'DETAIL_PICTURE_MODE' => 'IMG',[m
[31m-	'ADD_DETAIL_TO_SLIDER' => 'N',[m
[31m-	'DISPLAY_PREVIEW_TEXT_MODE' => 'E',[m
[31m-	'PRODUCT_SUBSCRIPTION' => 'N',[m
[31m-	'SHOW_DISCOUNT_PERCENT' => 'N',[m
[31m-	'SHOW_OLD_PRICE' => 'N',[m
[31m-	'SHOW_MAX_QUANTITY' => 'N',[m
[31m-	'SHOW_BASIS_PRICE' => 'N',[m
[31m-	'ADD_TO_BASKET_ACTION' => array('BUY'),[m
[31m-	'SHOW_CLOSE_POPUP' => 'N',[m
[31m-	'MESS_BTN_BUY' => '',[m
[31m-	'MESS_BTN_ADD_TO_BASKET' => '',[m
[31m-	'MESS_BTN_SUBSCRIBE' => '',[m
[31m-	'MESS_BTN_COMPARE' => '',[m
[31m-	'MESS_NOT_AVAILABLE' => '',[m
[31m-	'USE_VOTE_RATING' => 'N',[m
[31m-	'VOTE_DISPLAY_AS_RATING' => 'rating',[m
[31m-	'USE_COMMENTS' => 'N',[m
[31m-	'BLOG_USE' => 'N',[m
[31m-	'BLOG_URL' => 'catalog_comments',[m
[31m-	'BLOG_EMAIL_NOTIFY' => 'N',[m
[31m-	'VK_USE' => 'N',[m
[31m-	'VK_API_ID' => '',[m
[31m-	'FB_USE' => 'N',[m
[31m-	'FB_APP_ID' => '',[m
[31m-	'BRAND_USE' => 'N',[m
[31m-	'BRAND_PROP_CODE' => ''[m
[31m-);[m
[31m-$arParams = array_merge($arDefaultParams, $arParams);[m
[31m-[m
[31m-$arParams['TEMPLATE_THEME'] = (string)($arParams['TEMPLATE_THEME']);[m
[31m-if ('' != $arParams['TEMPLATE_THEME'])[m
[31m-{[m
[31m-	$arParams['TEMPLATE_THEME'] = preg_replace('/[^a-zA-Z0-9_\-\(\)\!]/', '', $arParams['TEMPLATE_THEME']);[m
[31m-	if ('site' == $arParams['TEMPLATE_THEME'])[m
[31m-	{[m
[31m-		$arParams['TEMPLATE_THEME'] = COption::GetOptionString('main', 'wizard_eshop_adapt_theme_id', 'blue', SITE_ID);[m
[31m-	}[m
[31m-	if ('' != $arParams['TEMPLATE_THEME'])[m
[31m-	{[m
[31m-		if (!is_file($_SERVER['DOCUMENT_ROOT'].$this->GetFolder().'/themes/'.$arParams['TEMPLATE_THEME'].'/style.css'))[m
[31m-			$arParams['TEMPLATE_THEME'] = '';[m
[31m-	}[m
[31m-}[m
[31m-if ('' == $arParams['TEMPLATE_THEME'])[m
[31m-	$arParams['TEMPLATE_THEME'] = 'blue';[m
[31m-[m
[31m-$arParams['ADD_PICT_PROP'] = trim($arParams['ADD_PICT_PROP']);[m
[31m-if ('-' == $arParams['ADD_PICT_PROP'])[m
[31m-	$arParams['ADD_PICT_PROP'] = '';[m
[31m-$arParams['LABEL_PROP'] = trim($arParams['LABEL_PROP']);[m
[31m-if ('-' == $arParams['LABEL_PROP'])[m
[31m-	$arParams['LABEL_PROP'] = '';[m
[31m-$arParams['OFFER_ADD_PICT_PROP'] = trim($arParams['OFFER_ADD_PICT_PROP']);[m
[31m-if ('-' == $arParams['OFFER_ADD_PICT_PROP'])[m
[31m-	$arParams['OFFER_ADD_PICT_PROP'] = '';[m
[31m-if (!is_array($arParams['OFFER_TREE_PROPS']))[m
[31m-	$arParams['OFFER_TREE_PROPS'] = array($arParams['OFFER_TREE_PROPS']);[m
[31m-foreach ($arParams['OFFER_TREE_PROPS'] as $key => $value)[m
[31m-{[m
[31m-	$value = (string)$value;[m
[31m-	if ('' == $value || '-' == $value)[m
[31m-		unset($arParams['OFFER_TREE_PROPS'][$key]);[m
[31m-}[m
[31m-if (empty($arParams['OFFER_TREE_PROPS']) && isset($arParams['OFFERS_CART_PROPERTIES']) && is_array($arParams['OFFERS_CART_PROPERTIES']))[m
[31m-{[m
[31m-	$arParams['OFFER_TREE_PROPS'] = $arParams['OFFERS_CART_PROPERTIES'];[m
[31m-	foreach ($arParams['OFFER_TREE_PROPS'] as $key => $value)[m
[31m-	{[m
[31m-		$value = (string)$value;[m
[31m-		if ('' == $value || '-' == $value)[m
[31m-			unset($arParams['OFFER_TREE_PROPS'][$key]);[m
[31m-	}[m
[31m-}[m
[31m-if ('N' != $arParams['DISPLAY_NAME'])[m
[31m-	$arParams['DISPLAY_NAME'] = 'Y';[m
[31m-if (!isset($detailPictMode[$arParams['DETAIL_PICTURE_MODE']]))[m
[31m-	$arParams['DETAIL_PICTURE_MODE'] = 'IMG';[m
[31m-if ('Y' != $arParams['ADD_DETAIL_TO_SLIDER'])[m
[31m-	$arParams['ADD_DETAIL_TO_SLIDER'] = 'N';[m
[31m-if (!isset($displayPreviewTextMode[$arParams['DISPLAY_PREVIEW_TEXT_MODE']]))[m
[31m-	$arParams['DISPLAY_PREVIEW_TEXT_MODE'] = 'E';[m
[31m-if ('Y' != $arParams['PRODUCT_SUBSCRIPTION'])[m
[31m-	$arParams['PRODUCT_SUBSCRIPTION'] = 'N';[m
[31m-if ('Y' != $arParams['SHOW_DISCOUNT_PERCENT'])[m
[31m-	$arParams['SHOW_DISCOUNT_PERCENT'] = 'N';[m
[31m-if ('Y' != $arParams['SHOW_OLD_PRICE'])[m
[31m-	$arParams['SHOW_OLD_PRICE'] = 'N';[m
[31m-if ('Y' != $arParams['SHOW_MAX_QUANTITY'])[m
[31m-	$arParams['SHOW_MAX_QUANTITY'] = 'N';[m
[31m-if ($arParams['SHOW_BASIS_PRICE'] != 'Y')[m
[31m-	$arParams['SHOW_BASIS_PRICE'] = 'N';[m
[31m-if (!is_array($arParams['ADD_TO_BASKET_ACTION']))[m
[31m-	$arParams['ADD_TO_BASKET_ACTION'] = array($arParams['ADD_TO_BASKET_ACTION']);[m
[31m-$arParams['ADD_TO_BASKET_ACTION'] = array_filter($arParams['ADD_TO_BASKET_ACTION'], 'CIBlockParameters::checkParamValues');[m
[31m-if (empty($arParams['ADD_TO_BASKET_ACTION']) || (!in_array('ADD', $arParams['ADD_TO_BASKET_ACTION']) && !in_array('BUY', $arParams['ADD_TO_BASKET_ACTION'])))[m
[31m-	$arParams['ADD_TO_BASKET_ACTION'] = array('BUY');[m
[31m-if ($arParams['SHOW_CLOSE_POPUP'] != 'Y')[m
[31m-	$arParams['SHOW_CLOSE_POPUP'] = 'N';[m
[31m-[m
[31m-$arParams['MESS_BTN_BUY'] = trim($arParams['MESS_BTN_BUY']);[m
[31m-$arParams['MESS_BTN_ADD_TO_BASKET'] = trim($arParams['MESS_BTN_ADD_TO_BASKET']);[m
[31m-$arParams['MESS_BTN_SUBSCRIBE'] = trim($arParams['MESS_BTN_SUBSCRIBE']);[m
[31m-$arParams['MESS_BTN_COMPARE'] = trim($arParams['MESS_BTN_COMPARE']);[m
[31m-$arParams['MESS_NOT_AVAILABLE'] = trim($arParams['MESS_NOT_AVAILABLE']);[m
[31m-if ('Y' != $arParams['USE_VOTE_RATING'])[m
[31m-	$arParams['USE_VOTE_RATING'] = 'N';[m
[31m-if ('vote_avg' != $arParams['VOTE_DISPLAY_AS_RATING'])[m
[31m-	$arParams['VOTE_DISPLAY_AS_RATING'] = 'rating';[m
[31m-if ('Y' != $arParams['USE_COMMENTS'])[m
[31m-	$arParams['USE_COMMENTS'] = 'N';[m
[31m-if ('Y' != $arParams['BLOG_USE'])[m
[31m-	$arParams['BLOG_USE'] = 'N';[m
[31m-if ('Y' != $arParams['VK_USE'])[m
[31m-	$arParams['VK_USE'] = 'N';[m
[31m-if ('Y' != $arParams['FB_USE'])[m
[31m-	$arParams['FB_USE'] = 'N';[m
[31m-if ('Y' == $arParams['USE_COMMENTS'])[m
[31m-{[m
[31m-	if ('N' == $arParams['BLOG_USE'] && 'N' == $arParams['VK_USE'] && 'N' == $arParams['FB_USE'])[m
[31m-		$arParams['USE_COMMENTS'] = 'N';[m
[31m-}[m
[31m-if ('Y' != $arParams['BRAND_USE'])[m
[31m-	$arParams['BRAND_USE'] = 'N';[m
[31m-if ($arParams['BRAND_PROP_CODE'] == '')[m
[31m-	$arParams['BRAND_PROP_CODE'] = array();[m
[31m-if (!is_array($arParams['BRAND_PROP_CODE']))[m
[31m-	$arParams['BRAND_PROP_CODE'] = array($arParams['BRAND_PROP_CODE']);[m
[31m-[m
[31m-$arEmptyPreview = false;[m
[31m-$strEmptyPreview = $this->GetFolder().'/images/no_photo.png';[m
[31m-if (file_exists($_SERVER['DOCUMENT_ROOT'].$strEmptyPreview))[m
[31m-{[m
[31m-	$arSizes = getimagesize($_SERVER['DOCUMENT_ROOT'].$strEmptyPreview);[m
[31m-	if (!empty($arSizes))[m
[31m-	{[m
[31m-		$arEmptyPreview = array([m
[31m-			'SRC' => $strEmptyPreview,[m
[31m-			'WIDTH' => (int)$arSizes[0],[m
[31m-			'HEIGHT' => (int)$arSizes[1][m
[31m-		);[m
[31m-	}[m
[31m-	unset($arSizes);[m
[31m-}[m
[31m-unset($strEmptyPreview);[m
[31m-[m
[31m-$arSKUPropList = array();[m
[31m-$arSKUPropIDs = array();[m
[31m-$arSKUPropKeys = array();[m
[31m-$boolSKU = false;[m
[31m-$strBaseCurrency = '';[m
[31m-$boolConvert = isset($arResult['CONVERT_CURRENCY']['CURRENCY_ID']);[m
[31m-[m
[31m-if ($arResult['MODULES']['catalog'])[m
[31m-{[m
[31m-	if (!$boolConvert)[m
[31m-		$strBaseCurrency = CCurrency::GetBaseCurrency();[m
[31m-[m
[31m-	$arSKU = CCatalogSKU::GetInfoByProductIBlock($arParams['IBLOCK_ID']);[m
[31m-	$boolSKU = !empty($arSKU) && is_array($arSKU);[m
[31m-[m
[31m-	if ($boolSKU && !empty($arParams['OFFER_TREE_PROPS']))[m
[31m-	{[m
[31m-		$arSKUPropList = CIBlockPriceTools::getTreeProperties([m
[31m-			$arSKU,[m
[31m-			$arParams['OFFER_TREE_PROPS'],[m
[31m-			array([m
[31m-				'PICT' => $arEmptyPreview,[m
[31m-				'NAME' => '-'[m
[31m-			)[m
[31m-		);[m
[31m-		$arSKUPropIDs = array_keys($arSKUPropList);[m
[31m-	}[m
[31m-}[m
[31m-[m
[31m-$arResult['CHECK_QUANTITY'] = false;[m
[31m-if (!isset($arResult['CATALOG_MEASURE_RATIO']))[m
[31m-	$arResult['CATALOG_MEASURE_RATIO'] = 1;[m
[31m-if (!isset($arResult['CATALOG_QUANTITY']))[m
[31m-	$arResult['CATALOG_QUANTITY'] = 0;[m
[31m-$arResult['CATALOG_QUANTITY'] = ([m
[31m-	0 < $arResult['CATALOG_QUANTITY'] && is_float($arResult['CATALOG_MEASURE_RATIO'])[m
[31m-	? (float)$arResult['CATALOG_QUANTITY'][m
[31m-	: (int)$arResult['CATALOG_QUANTITY'][m
[31m-);[m
[31m-$arResult['CATALOG'] = false;[m
[31m-if (!isset($arResult['CATALOG_SUBSCRIPTION']) || 'Y' != $arResult['CATALOG_SUBSCRIPTION'])[m
[31m-	$arResult['CATALOG_SUBSCRIPTION'] = 'N';[m
[31m-[m
[31m-CIBlockPriceTools::getLabel($arResult, $arParams['LABEL_PROP']);[m
[31m-[m
[31m-$productSlider = CIBlockPriceTools::getSliderForItem($arResult, $arParams['ADD_PICT_PROP'], 'Y' == $arParams['ADD_DETAIL_TO_SLIDER']);[m
[31m-if (empty($productSlider))[m
[31m-{[m
[31m-	$productSlider = array([m
[31m-		0 => $arEmptyPreview[m
[31m-	);[m
[31m-}[m
[31m-$productSliderCount = count($productSlider);[m
[31m-$arResult['SHOW_SLIDER'] = true;[m
[31m-$arResult['MORE_PHOTO'] = $productSlider;[m
[31m-$arResult['MORE_PHOTO_COUNT'] = count($productSlider);[m
[31m-[m
[31m-if ($arResult['MODULES']['catalog'])[m
[31m-{[m
[31m-	$arResult['CATALOG'] = true;[m
[31m-	if (!isset($arResult['CATALOG_TYPE']))[m
[31m-		$arResult['CATALOG_TYPE'] = CCatalogProduct::TYPE_PRODUCT;[m
[31m-	if ([m
[31m-		(CCatalogProduct::TYPE_PRODUCT == $arResult['CATALOG_TYPE'] || CCatalogProduct::TYPE_SKU == $arResult['CATALOG_TYPE'])[m
[31m-		&& !empty($arResult['OFFERS'])[m
[31m-	)[m
[31m-	{[m
[31m-		$arResult['CATALOG_TYPE'] = CCatalogProduct::TYPE_SKU;[m
[31m-	}[m
[31m-	switch ($arResult['CATALOG_TYPE'])[m
[31m-	{[m
[31m-		case CCatalogProduct::TYPE_SET:[m
[31m-			$arResult['OFFERS'] = array();[m
[31m-			$arResult['CHECK_QUANTITY'] = ('Y' == $arResult['CATALOG_QUANTITY_TRACE'] && 'N' == $arResult['CATALOG_CAN_BUY_ZERO']);[m
[31m-			break;[m
[31m-		case CCatalogProduct::TYPE_SKU:[m
[31m-			break;[m
[31m-		case CCatalogProduct::TYPE_PRODUCT:[m
[31m-		default:[m
[31m-			$arResult['CHECK_QUANTITY'] = ('Y' == $arResult['CATALOG_QUANTITY_TRACE'] && 'N' == $arResult['CATALOG_CAN_BUY_ZERO']);[m
[31m-			break;[m
[31m-	}[m
[31m-}[m
[31m-else[m
[31m-{[m
[31m-	$arResult['CATALOG_TYPE'] = 0;[m
[31m-	$arResult['OFFERS'] = array();[m
[31m-}[m
[31m-[m
[31m-if ($arResult['CATALOG'] && isset($arResult['OFFERS']) && !empty($arResult['OFFERS']))[m
[31m-{[m
[31m-	$boolSKUDisplayProps = false;[m
[31m-[m
[31m-	$arResultSKUPropIDs = array();[m
[31m-	$arFilterProp = array();[m
[31m-	$arNeedValues = array();[m
[31m-	foreach ($arResult['OFFERS'] as &$arOffer)[m
[31m-	{[m
[31m-		foreach ($arSKUPropIDs as &$strOneCode)[m
[31m-		{[m
[31m-			if (isset($arOffer['DISPLAY_PROPERTIES'][$strOneCode]))[m
[31m-			{[m
[31m-				$arResultSKUPropIDs[$strOneCode] = true;[m
[31m-				if (!isset($arNeedValues[$arSKUPropList[$strOneCode]['ID']]))[m
[31m-					$arNeedValues[$arSKUPropList[$strOneCode]['ID']] = array();[m
[31m-				$valueId = ([m
[31m-					$arSKUPropList[$strOneCode]['PROPERTY_TYPE'] == Iblock\PropertyTable::TYPE_LIST[m
[31m-					? $arOffer['DISPLAY_PROPERTIES'][$strOneCode]['VALUE_ENUM_ID'][m
[31m-					: $arOffer['DISPLAY_PROPERTIES'][$strOneCode]['VALUE'][m
[31m-				);[m
[31m-				$arNeedValues[$arSKUPropList[$strOneCode]['ID']][$valueId] = $valueId;[m
[31m-				unset($valueId);[m
[31m-				if (!isset($arFilterProp[$strOneCode]))[m
[31m-					$arFilterProp[$strOneCode] = $arSKUPropList[$strOneCode];[m
[31m-			}[m
[31m-		}[m
[31m-		unset($strOneCode);[m
[31m-	}[m
[31m-	unset($arOffer);[m
[31m-[m
[31m-	CIBlockPriceTools::getTreePropertyValues($arSKUPropList, $arNeedValues);[m
[31m-	$arSKUPropIDs = array_keys($arSKUPropList);[m
[31m-	$arSKUPropKeys = array_fill_keys($arSKUPropIDs, false);[m
[31m-[m
[31m-[m
[31m-	$arMatrixFields = $arSKUPropKeys;[m
[31m-	$arMatrix = array();[m
[31m-[m
[31m-	$arNewOffers = array();[m
[31m-[m
[31m-	$arIDS = array($arResult['ID']);[m
[31m-	$arOfferSet = array();[m
[31m-	$arResult['OFFER_GROUP'] = false;[m
[31m-	$arResult['OFFERS_PROP'] = false;[m
[31m-[m
[31m-	$arDouble = array();[m
[31m-	foreach ($arResult['OFFERS'] as $keyOffer => $arOffer)[m
[31m-	{[m
[31m-		$arOffer['ID'] = (int)$arOffer['ID'];[m
[31m-		if (isset($arDouble[$arOffer['ID']]))[m
[31m-			continue;[m
[31m-		$arIDS[] = $arOffer['ID'];[m
[31m-		$boolSKUDisplayProperties = false;[m
[31m-		$arOffer['OFFER_GROUP'] = false;[m
[31m-		$arRow = array();[m
[31m-		foreach ($arSKUPropIDs as $propkey => $strOneCode)[m
[31m-		{[m
[31m-			$arCell = array([m
[31m-				'VALUE' => 0,[m
[31m-				'SORT' => PHP_INT_MAX,[m
[31m-				'NA' => true[m
[31m-			);[m
[31m-			if (isset($arOffer['DISPLAY_PROPERTIES'][$strOneCode]))[m
[31m-			{[m
[31m-				$arMatrixFields[$strOneCode] = true;[m
[31m-				$arCell['NA'] = false;[m
[31m-				if ('directory' == $arSKUPropList[$strOneCode]['USER_TYPE'])[m
[31m-				{[m
[31m-					$intValue = $arSKUPropList[$strOneCode]['XML_MAP'][$arOffer['DISPLAY_PROPERTIES'][$strOneCode]['VALUE']];[m
[31m-					$arCell['VALUE'] = $intValue;[m
[31m-				}[m
[31m-				elseif ('L' == $arSKUPropList[$strOneCode]['PROPERTY_TYPE'])[m
[31m-				{[m
[31m-					$arCell['VALUE'] = (int)$arOffer['DISPLAY_PROPERTIES'][$strOneCode]['VALUE_ENUM_ID'];[m
[31m-				}[m
[31m-				elseif ('E' == $arSKUPropList[$strOneCode]['PROPERTY_TYPE'])[m
[31m-				{[m
[31m-					$arCell['VALUE'] = (int)$arOffer['DISPLAY_PROPERTIES'][$strOneCode]['VALUE'];[m
[31m-				}[m
[31m-				$arCell['SORT'] = $arSKUPropList[$strOneCode]['VALUES'][$arCell['VALUE']]['SORT'];[m
[31m-			}[m
[31m-			$arRow[$strOneCode] = $arCell;[m
[31m-		}[m
[31m-		$arMatrix[$keyOffer] = $arRow;[m
[31m-[m
[31m-		CIBlockPriceTools::setRatioMinPrice($arOffer, false);[m
[31m-[m
[31m-		$arOffer['MORE_PHOTO'] = array();[m
[31m-		$arOffer['MORE_PHOTO_COUNT'] = 0;[m
[31m-		$offerSlider = CIBlockPriceTools::getSliderForItem($arOffer, $arParams['OFFER_ADD_PICT_PROP'], $arParams['ADD_DETAIL_TO_SLIDER'] == 'Y');[m
[31m-		if (empty($offerSlider))[m
[31m-		{[m
[31m-			$offerSlider = $productSlider;[m
[31m-		}[m
[31m-		$arOffer['MORE_PHOTO'] = $offerSlider;[m
[31m-		$arOffer['MORE_PHOTO_COUNT'] = count($offerSlider);[m
[31m-[m
[31m-		if (CIBlockPriceTools::clearProperties($arOffer['DISPLAY_PROPERTIES'], $arParams['OFFER_TREE_PROPS']))[m
[31m-		{[m
[31m-			$boolSKUDisplayProps = true;[m
[31m-		}[m
[31m-[m
[31m-		$arDouble[$arOffer['ID']] = true;[m
[31m-		$arNewOffers[$keyOffer] = $arOffer;[m
[31m-	}[m
[31m-	$arResult['OFFERS'] = $arNewOffers;[m
[31m-	$arResult['SHOW_OFFERS_PROPS'] = $boolSKUDisplayProps;[m
[31m-[m
[31m-	$arUsedFields = array();[m
[31m-	$arSortFields = array();[m
[31m-[m
[31m-	foreach ($arSKUPropIDs as $propkey => $strOneCode)[m
[31m-	{[m
[31m-		$boolExist = $arMatrixFields[$strOneCode];[m
[31m-		foreach ($arMatrix as $keyOffer => $arRow)[m
[31m-		{[m
[31m-			if ($boolExist)[m
[31m-			{[m
[31m-				if (!isset($arResult['OFFERS'][$keyOffer]['TREE']))[m
[31m-					$arResult['OFFERS'][$keyOffer]['TREE'] = array();[m
[31m-				$arResult['OFFERS'][$keyOffer]['TREE']['PROP_'.$arSKUPropList[$strOneCode]['ID']] = $arMatrix[$keyOffer][$strOneCode]['VALUE'];[m
[31m-				$arResult['OFFERS'][$keyOffer]['SKU_SORT_'.$strOneCode] = $arMatrix[$keyOffer][$strOneCode]['SORT'];[m
[31m-				$arUsedFields[$strOneCode] = true;[m
[31m-				$arSortFields['SKU_SORT_'.$strOneCode] = SORT_NUMERIC;[m
[31m-			}[m
[31m-			else[m
[31m-			{[m
[31m-				unset($arMatrix[$keyOffer][$strOneCode]);[m
[31m-			}[m
[31m-		}[m
[31m-	}[m
[31m-	$arResult['OFFERS_PROP'] = $arUsedFields;[m
[31m-	$arResult['OFFERS_PROP_CODES'] = (!empty($arUsedFields) ? base64_encode(serialize(array_keys($arUsedFields))) : '');[m
[31m-[m
[31m-	Collection::sortByColumn($arResult['OFFERS'], $arSortFields);[m
[31m-[m
[31m-	$offerSet = array();[m
[31m-	if (!empty($arIDS) && CBXFeatures::IsFeatureEnabled('CatCompleteSet'))[m
[31m-	{[m
[31m-		$offerSet = array_fill_keys($arIDS, false);[m
[31m-		$rsSets = CCatalogProductSet::getList([m
[31m-			array(),[m
[31m-			array([m
[31m-				'@OWNER_ID' => $arIDS,[m
[31m-				'=SET_ID' => 0,[m
[31m-				'=TYPE' => CCatalogProductSet::TYPE_GROUP[m
[31m-			),[m
[31m-			false,[m
[31m-			false,[m
[31m-			array('ID', 'OWNER_ID')[m
[31m-		);[m
[31m-		while ($arSet = $rsSets->Fetch())[m
[31m-		{[m
[31m-			$arSet['OWNER_ID'] = (int)$arSet['OWNER_ID'];[m
[31m-			$offerSet[$arSet['OWNER_ID']] = true;[m
[31m-			$arResult['OFFER_GROUP'] = true;[m
[31m-		}[m
[31m-		if ($offerSet[$arResult['ID']])[m
[31m-		{[m
[31m-			foreach ($offerSet as &$setOfferValue)[m
[31m-			{[m
[31m-				if ($setOfferValue === false)[m
[31m-				{[m
[31m-					$setOfferValue = true;[m
[31m-				}[m
[31m-			}[m
[31m-			unset($setOfferValue);[m
[31m-			unset($offerSet[$arResult['ID']]);[m
[31m-		}[m
[31m-		if ($arResult['OFFER_GROUP'])[m
[31m-		{[m
[31m-			$offerSet = array_filter($offerSet);[m
[31m-			$arResult['OFFER_GROUP_VALUES'] = array_keys($offerSet);[m
[31m-		}[m
[31m-	}[m
[31m-[m
[31m-	$arMatrix = array();[m
[31m-	$intSelected = -1;[m
[31m-	$arResult['MIN_PRICE'] = false;[m
[31m-	$arResult['MIN_BASIS_PRICE'] = false;[m
[31m-	foreach ($arResult['OFFERS'] as $keyOffer => $arOffer)[m
[31m-	{[m
[31m-		if (empty($arResult['MIN_PRICE']) && $arOffer['CAN_BUY'])[m
[31m-		{[m
[31m-			$intSelected = $keyOffer;[m
[31m-			$arResult['MIN_PRICE'] = (isset($arOffer['RATIO_PRICE']) ? $arOffer['RATIO_PRICE'] : $arOffer['MIN_PRICE']);[m
[31m-			$arResult['MIN_BASIS_PRICE'] = $arOffer['MIN_PRICE'];[m
[31m-		}[m
[31m-		$arSKUProps = false;[m
[31m-		if (!empty($arOffer['DISPLAY_PROPERTIES']))[m
[31m-		{[m
[31m-			$boolSKUDisplayProps = true;[m
[31m-			$arSKUProps = array();[m
[31m-			foreach ($arOffer['DISPLAY_PROPERTIES'] as &$arOneProp)[m
[31m-			{[m
[31m-				if ('F' == $arOneProp['PROPERTY_TYPE'])[m
[31m-					continue;[m
[31m-				$arSKUProps[] = array([m
[31m-					'NAME' => $arOneProp['NAME'],[m
[31m-					'VALUE' => $arOneProp['DISPLAY_VALUE'][m
[31m-				);[m
[31m-			}[m
[31m-			unset($arOneProp);[m
[31m-		}[m
[31m-		if (isset($arOfferSet[$arOffer['ID']]))[m
[31m-		{[m
[31m-			$arOffer['OFFER_GROUP'] = true;[m
[31m-			$arResult['OFFERS'][$keyOffer]['OFFER_GROUP'] = true;[m
[31m-		}[m
[31m-		reset($arOffer['MORE_PHOTO']);[m
[31m-		$firstPhoto = current($arOffer['MORE_PHOTO']);[m
[31m-		$arOneRow = array([m
[31m-			'ID' => $arOffer['ID'],[m
[31m-			'NAME' => $arOffer['~NAME'],[m
[31m-			'TREE' => $arOffer['TREE'],[m
[31m-			'PRICE' => (isset($arOffer['RATIO_PRICE']) ? $arOffer['RATIO_PRICE'] : $arOffer['MIN_PRICE']),[m
[31m-			'BASIS_PRICE' => $arOffer['MIN_PRICE'],[m
[31m-			'DISPLAY_PROPERTIES' => $arSKUProps,[m
[31m-			'PREVIEW_PICTURE' => $firstPhoto,[m
[31m-			'DETAIL_PICTURE' => $firstPhoto,[m
[31m-			'CHECK_QUANTITY' => $arOffer['CHECK_QUANTITY'],[m
[31m-			'MAX_QUANTITY' => $arOffer['CATALOG_QUANTITY'],[m
[31m-			'STEP_QUANTITY' => $arOffer['CATALOG_MEASURE_RATIO'],[m
[31m-			'QUANTITY_FLOAT' => is_double($arOffer['CATALOG_MEASURE_RATIO']),[m
[31m-			'MEASURE' => $arOffer['~CATALOG_MEASURE_NAME'],[m
[31m-			'OFFER_GROUP' => (isset($offerSet[$arOffer['ID']]) && $offerSet[$arOffer['ID']]),[m
[31m-			'CAN_BUY' => $arOffer['CAN_BUY'],[m
[31m-			'SLIDER' => $arOffer['MORE_PHOTO'],[m
[31m-			'SLIDER_COUNT' => $arOffer['MORE_PHOTO_COUNT'],[m
[31m-		);[m
[31m-		$arMatrix[$keyOffer] = $arOneRow;[m
[31m-	}[m
[31m-	if (-1 == $intSelected)[m
[31m-		$intSelected = 0;[m
[31m-	$arResult['JS_OFFERS'] = $arMatrix;[m
[31m-	$arResult['OFFERS_SELECTED'] = $intSelected;[m
[31m-[m
[31m-	$arResult['OFFERS_IBLOCK'] = $arSKU['IBLOCK_ID'];[m
[31m-}[m
[31m-[m
[31m-if ($arResult['MODULES']['catalog'] && $arResult['CATALOG'])[m
[31m-{[m
[31m-	if ($arResult['CATALOG_TYPE'] == CCatalogProduct::TYPE_PRODUCT || $arResult['CATALOG_TYPE'] == CCatalogProduct::TYPE_SET)[m
[31m-	{[m
[31m-		CIBlockPriceTools::setRatioMinPrice($arResult, false);[m
[31m-		$arResult['MIN_BASIS_PRICE'] = $arResult['MIN_PRICE'];[m
[31m-	}[m
[31m-	if (CBXFeatures::IsFeatureEnabled('CatCompleteSet') && $arResult['CATALOG_TYPE'] == CCatalogProduct::TYPE_PRODUCT)[m
[31m-	{[m
[31m-		$rsSets = CCatalogProductSet::getList([m
[31m-			array(),[m
[31m-			array([m
[31m-				'@OWNER_ID' => $arResult['ID'],[m
[31m-				'=SET_ID' => 0,[m
[31m-				'=TYPE' => CCatalogProductSet::TYPE_GROUP[m
[31m-			),[m
[31m-			false,[m
[31m-			false,[m
[31m-			array('ID', 'OWNER_ID')[m
[31m-		);[m
[31m-		if ($arSet = $rsSets->Fetch())[m
[31m-		{[m
[31m-			$arResult['OFFER_GROUP'] = true;[m
[31m-		}[m
[31m-	}[m
[31m-}[m
[31m-[m
[31m-if (!empty($arResult['DISPLAY_PROPERTIES']))[m
[31m-{[m
[31m-	foreach ($arResult['DISPLAY_PROPERTIES'] as $propKey => $arDispProp)[m
[31m-	{[m
[31m-		if ('F' == $arDispProp['PROPERTY_TYPE'])[m
[31m-			unset($arResult['DISPLAY_PROPERTIES'][$propKey]);[m
[31m-	}[m
[31m-}[m
[31m-[m
[31m-$arResult['SKU_PROPS'] = $arSKUPropList;[m
[31m-$arResult['DEFAULT_PICTURE'] = $arEmptyPreview;[m
[31m-[m
[31m-$arResult['CURRENCIES'] = array();[m
[31m-if ($arResult['MODULES']['currency'])[m
[31m-{[m
[31m-	if ($boolConvert)[m
[31m-	{[m
[31m-		$currencyFormat = CCurrencyLang::GetFormatDescription($arResult['CONVERT_CURRENCY']['CURRENCY_ID']);[m
[31m-		$arResult['CURRENCIES'] = array([m
[31m-			array([m
[31m-				'CURRENCY' => $arResult['CONVERT_CURRENCY']['CURRENCY_ID'],[m
[31m-				'FORMAT' => array([m
[31m-					'FORMAT_STRING' => $currencyFormat['FORMAT_STRING'],[m
[31m-					'DEC_POINT' => $currencyFormat['DEC_POINT'],[m
[31m-					'THOUSANDS_SEP' => $currencyFormat['THOUSANDS_SEP'],[m
[31m-					'DECIMALS' => $currencyFormat['DECIMALS'],[m
[31m-					'THOUSANDS_VARIANT' => $currencyFormat['THOUSANDS_VARIANT'],[m
[31m-					'HIDE_ZERO' => $currencyFormat['HIDE_ZERO'][m
[31m-				)[m
[31m-			)[m
[31m-		);[m
[31m-		unset($currencyFormat);[m
[31m-	}[m
[31m-	else[m
[31m-	{[m
[31m-		$currencyIterator = CurrencyTable::getList(array([m
[31m-			'select' => array('CURRENCY')[m
[31m-		));[m
[31m-		while ($currency = $currencyIterator->fetch())[m
[31m-		{[m
[31m-			$currencyFormat = CCurrencyLang::GetFormatDescription($currency['CURRENCY']);[m
[31m-			$arResult['CURRENCIES'][] = array([m
[31m-				'CURRENCY' => $currency['CURRENCY'],[m
[31m-				'FORMAT' => array([m
[31m-					'FORMAT_STRING' => $currencyFormat['FORMAT_STRING'],[m
[31m-					'DEC_POINT' => $currencyFormat['DEC_POINT'],[m
[31m-					'THOUSANDS_SEP' => $currencyFormat['THOUSANDS_SEP'],[m
[31m-					'DECIMALS' => $currencyFormat['DECIMALS'],[m
[31m-					'THOUSANDS_VARIANT' => $currencyFormat['THOUSANDS_VARIANT'],[m
[31m-					'HIDE_ZERO' => $currencyFormat['HIDE_ZERO'][m
[31m-				)[m
[31m-			);[m
[31m-		}[m
[31m-		unset($currencyFormat, $currency, $currencyIterator);[m
[31m-	}[m
[31m-}[m
[31m-?>[m
\ No newline at end of file[m
[1mdiff --git a/local/components/zakrepi/catalog.element/templates/.default/script.js b/local/components/zakrepi/catalog.element/templates/.default/script.js[m
[1mdeleted file mode 100644[m
[1mindex 7388993..0000000[m
[1m--- a/local/components/zakrepi/catalog.element/templates/.default/script.js[m
[1m+++ /dev/null[m
[36m@@ -1,2828 +0,0 @@[m
[31m-(function (window) {[m
[31m-[m
[31m-if (!!window.JCCatalogElement)[m
[31m-{[m
[31m-	return;[m
[31m-}[m
[31m-[m
[31m-var BasketButton = function(params)[m
[31m-{[m
[31m-	BasketButton.superclass.constructor.apply(this, arguments);[m
[31m-	this.nameNode = BX.create('span', {[m
[31m-		props : { className : 'bx_medium bx_bt_button', id : this.id },[m
[31m-		style: typeof(params.style) === 'object' ? params.style : {},[m
[31m-		text: params.text[m
[31m-	});[m
[31m-	this.buttonNode = BX.create('span', {[m
[31m-		attrs: { className: params.ownerClass },[m
[31m-		children: [this.nameNode],[m
[31m-		events : this.contextEvents[m
[31m-	});[m
[31m-	if (BX.browser.IsIE())[m
[31m-	{[m
[31m-		this.buttonNode.setAttribute("hideFocus", "hidefocus");[m
[31m-	}[m
[31m-};[m
[31m-BX.extend(BasketButton, BX.PopupWindowButton);[m
[31m-[m
[31m-window.JCCatalogElement = function (arParams)[m
[31m-{[m
[31m-	this.productType = 0;[m
[31m-[m
[31m-	this.config = {[m
[31m-		useCatalog: true,[m
[31m-		showQuantity: true,[m
[31m-		showPrice: true,[m
[31m-		showAbsent: true,[m
[31m-		showOldPrice: false,[m
[31m-		showPercent: false,[m
[31m-		showSkuProps: false,[m
[31m-		showOfferGroup: false,[m
[31m-		useCompare: false,[m
[31m-		mainPictureMode: 'IMG',[m
[31m-		showBasisPrice: false,[m
[31m-		basketAction: ['BUY'],[m
[31m-		showClosePopup: false[m
[31m-	};[m
[31m-[m
[31m-	this.checkQuantity = false;[m
[31m-	this.maxQuantity = 0;[m
[31m-	this.stepQuantity = 1;[m
[31m-	this.isDblQuantity = false;[m
[31m-	this.canBuy = true;[m
[31m-	this.currentBasisPrice = {};[m
[31m-	this.canSubscription = true;[m
[31m-	this.currentIsSet = false;[m
[31m-	this.updateViewedCount = false;[m
[31m-[m
[31m-	this.precision = 6;[m
[31m-	this.precisionFactor = Math.pow(10,this.precision);[m
[31m-[m
[31m-	this.listID = {[m
[31m-		main: ['PICT_ID', 'BIG_SLIDER_ID', 'BIG_IMG_CONT_ID'],[m
[31m-		stickers: ['STICKER_ID'],[m
[31m-		productSlider: ['SLIDER_CONT', 'SLIDER_LIST', 'SLIDER_LEFT', 'SLIDER_RIGHT'],[m
[31m-		offerSlider: ['SLIDER_CONT_OF_ID', 'SLIDER_LIST_OF_ID', 'SLIDER_LEFT_OF_ID', 'SLIDER_RIGHT_OF_ID'],[m
[31m-		offers: ['TREE_ID', 'TREE_ITEM_ID', 'DISPLAY_PROP_DIV', 'OFFER_GROUP'],[m
[31m-		quantity: ['QUANTITY_ID', 'QUANTITY_UP_ID', 'QUANTITY_DOWN_ID', 'QUANTITY_MEASURE', 'QUANTITY_LIMIT', 'BASIS_PRICE'],[m
[31m-		price: ['PRICE_ID'],[m
[31m-		oldPrice: ['OLD_PRICE_ID', 'DISCOUNT_VALUE_ID'],[m
[31m-		discountPerc: ['DISCOUNT_PERC_ID'],[m
[31m-		basket: ['BASKET_PROP_DIV', 'BUY_ID', 'ADD_BASKET_ID', 'BASKET_ACTIONS_ID', 'NOT_AVAILABLE_MESS'],[m
[31m-		magnifier: ['MAGNIFIER_ID', 'MAGNIFIER_AREA_ID'],[m
[31m-		compare: ['COMPARE_LINK_ID'][m
[31m-	};[m
[31m-[m
[31m-	this.visualPostfix = {[m
[31m-		// main pict[m
[31m-		PICT_ID: '_pict',[m
[31m-		BIG_SLIDER_ID: '_big_slider',[m
[31m-		BIG_IMG_CONT_ID: '_bigimg_cont',[m
[31m-		// stickers[m
[31m-		STICKER_ID: '_sticker',[m
[31m-		// product pict slider[m
[31m-		SLIDER_CONT: '_slider_cont',[m
[31m-		SLIDER_LIST: '_slider_list',[m
[31m-		SLIDER_LEFT: '_slider_left',[m
[31m-		SLIDER_RIGHT: '_slider_right',[m
[31m-		// offers sliders[m
[31m-		SLIDER_CONT_OF_ID: '_slider_cont_',[m
[31m-		SLIDER_LIST_OF_ID: '_slider_list_',[m
[31m-		SLIDER_LEFT_OF_ID: '_slider_left_',[m
[31m-		SLIDER_RIGHT_OF_ID: '_slider_right_',[m
[31m-		// offers[m
[31m-		TREE_ID: '_skudiv',[m
[31m-		TREE_ITEM_ID: '_prop_',[m
[31m-		DISPLAY_PROP_DIV: '_sku_prop',[m
[31m-		// quantity[m
[31m-		QUANTITY_ID: '_quantity',[m
[31m-		QUANTITY_UP_ID: '_quant_up',[m
[31m-		QUANTITY_DOWN_ID: '_quant_down',[m
[31m-		QUANTITY_MEASURE: '_quant_measure',[m
[31m-		QUANTITY_LIMIT: '_quant_limit',[m
[31m-		BASIS_PRICE: '_basis_price',[m
[31m-		// price and discount[m
[31m-		PRICE_ID: '_price',[m
[31m-		OLD_PRICE_ID: '_old_price',[m
[31m-		DISCOUNT_VALUE_ID: '_price_discount',[m
[31m-		DISCOUNT_PERC_ID: '_dsc_pict',[m
[31m-		// basket[m
[31m-		BASKET_PROP_DIV: '_basket_prop',[m
[31m-		BUY_ID: '_buy_link',[m
[31m-		ADD_BASKET_ID: '_add_basket_link',[m
[31m-		BASKET_ACTIONS_ID: '_basket_actions',[m
[31m-		NOT_AVAILABLE_MESS: '_not_avail',[m
[31m-		// magnifier[m
[31m-		MAGNIFIER_ID: '_magnifier',[m
[31m-		MAGNIFIER_AREA_ID: '_magnifier_area',[m
[31m-		// offer groups[m
[31m-		OFFER_GROUP: '_set_group_',[m
[31m-		// compare[m
[31m-		COMPARE_LINK_ID: '_compare_link'[m
[31m-	};[m
[31m-[m
[31m-	this.visual = {};[m
[31m-[m
[31m-	this.basketMode = '';[m
[31m-	this.product = {[m
[31m-		checkQuantity: false,[m
[31m-		maxQuantity: 0,[m
[31m-		stepQuantity: 1,[m
[31m-		startQuantity: 1,[m
[31m-		isDblQuantity: false,[m
[31m-		canBuy: true,[m
[31m-		canSubscription: true,[m
[31m-		name: '',[m
[31m-		pict: {},[m
[31m-		id: 0,[m
[31m-		addUrl: '',[m
[31m-		buyUrl: '',[m
[31m-		slider: {},[m
[31m-		sliderCount: 0,[m
[31m-		useSlider: false,[m
[31m-		sliderPict: [][m
[31m-	};[m
[31m-	this.mess = {};[m
[31m-[m
[31m-	this.basketData = {[m
[31m-		useProps: false,[m
[31m-		emptyProps: false,[m
[31m-		quantity: 'quantity',[m
[31m-		props: 'prop',[m
[31m-		basketUrl: '',[m
[31m-		sku_props: '',[m
[31m-		sku_props_var: 'basket_props',[m
[31m-		add_url: '',[m
[31m-		buy_url: ''[m
[31m-	};[m
[31m-	this.compareData = {[m
[31m-		compareUrl: '',[m
[31m-		comparePath: ''[m
[31m-	};[m
[31m-[m
[31m-	this.defaultPict = {[m
[31m-		preview: null,[m
[31m-		detail: null[m
[31m-	};[m
[31m-[m
[31m-	this.offers = [];[m
[31m-	this.offerNum = 0;[m
[31m-	this.treeProps = [];[m
[31m-	this.obTreeRows = [];[m
[31m-	this.showCount = [];[m
[31m-	this.showStart = [];[m
[31m-	this.selectedValues = {};[m
[31m-	this.sliders = [];[m
[31m-[m
[31m-	this.obProduct = null;[m
[31m-	this.obQuantity = null;[m
[31m-	this.obQuantityUp = null;[m
[31m-	this.obQuantityDown = null;[m
[31m-	this.obBasisPrice = null;[m
[31m-	this.obPict = null;[m
[31m-	this.obPictAligner = null;[m
[31m-	this.obPrice = {[m
[31m-		price: null,[m
[31m-		full: null,[m
[31m-		discount: null,[m
[31m-		percent: null[m
[31m-	};[m
[31m-	this.obTree = null;[m
[31m-	this.obBuyBtn = null;[m
[31m-	this.obAddToBasketBtn = null;[m
[31m-	this.obBasketActions = null;[m
[31m-	this.obNotAvail = null;[m
[31m-	this.obSkuProps = null;[m
[31m-	this.obSlider = null;[m
[31m-	this.obMeasure = null;[m
[31m-	this.obQuantityLimit = {[m
[31m-		all: null,[m
[31m-		value: null[m
[31m-	};[m
[31m-	this.obCompare = null;[m
[31m-[m
[31m-	this.viewedCounter = {[m
[31m-		path: '/bitrix/components/bitrix/catalog.element/ajax.php',[m
[31m-		params: {[m
[31m-			AJAX: 'Y',[m
[31m-			SITE_ID: '',[m
[31m-			PRODUCT_ID: 0,[m
[31m-			PARENT_ID: 0[m
[31m-		}[m
[31m-	};[m
[31m-[m
[31m-	this.currentImg = {[m
[31m-		src: '',[m
[31m-		width: 0,[m
[31m-		height: 0,[m
[31m-		screenWidth: 0,[m
[31m-		screenHeight: 0,[m
[31m-		screenOffsetX: 0,[m
[31m-		screenOffsetY: 0,[m
[31m-		scale: 1[m
[31m-	};[m
[31m-[m
[31m-	this.obPopupWin = null;[m
[31m-	this.basketUrl = '';[m
[31m-	this.basketParams = {};[m
[31m-[m
[31m-	this.obPopupPict = null;[m
[31m-	this.magnify = {[m
[31m-		obMagnifier: null,[m
[31m-		obMagnifyPict: null,[m
[31m-		obMagnifyArea: null,[m
[31m-		obBigImg: null,[m
[31m-		obBigSlider: null,[m
[31m-		magnifyShow: false,[m
[31m-		areaParams : {[m
[31m-			width: 100,[m
[31m-			height: 130,[m
[31m-			left: 0,[m
[31m-			top: 0,[m
[31m-			scaleFactor: 1,[m
[31m-			globalLeft: 0,[m
[31m-			globalTop: 0,[m
[31m-			globalRight: 0,[m
[31m-			globalBottom: 0[m
[31m-		},[m
[31m-		magnifierParams: {[m
[31m-			top: 0,[m
[31m-			left: 0,[m
[31m-			width: 0,[m
[31m-			height: 0,[m
[31m-			ratioX: 10,[m
[31m-			ratioY: 13,[m
[31m-			defaultScale: 1[m
[31m-		},[m
[31m-		magnifyPictParams: {[m
[31m-			marginTop: 0,[m
[31m-			marginLeft: 0,[m
[31m-			width: 0,[m
[31m-			height: 0[m
[31m-		}[m
[31m-	};[m
[31m-[m
[31m-	this.treeRowShowSize = 5;[m
[31m-	this.treeEnableArrow = { display: '', cursor: 'pointer', opacity: 1 };[m
[31m-	this.treeDisableArrow = { display: '', cursor: 'default', opacity: 0.2 };[m
[31m-	this.sliderRowShowSize = 5;[m
[31m-	this.sliderEnableArrow = { display: '', cursor: 'pointer', opacity: 1 };[m
[31m-	this.sliderDisableArrow = { display: '', cursor: 'default', opacity: 0.2 };[m
[31m-[m
[31m-	this.errorCode = 0;[m
[31m-[m
[31m-	if (typeof arParams === 'object')[m
[31m-	{[m
[31m-		this.params = arParams;[m
[31m-		this.initConfig();[m
[31m-[m
[31m-		if (!!this.params.MESS)[m
[31m-		{[m
[31m-			this.mess = this.params.MESS;[m
[31m-		}[m
[31m-		switch (this.productType)[m
[31m-		{[m
[31m-			case 0:// no catalog[m
[31m-			case 1://product[m
[31m-			case 2://set[m
[31m-				this.initProductData();[m
[31m-				break;[m
[31m-			case 3://sku[m
[31m-				this.initOffersData();[m
[31m-				break;[m
[31m-			default:[m
[31m-				this.errorCode = -1;[m
[31m-		}[m
[31m-		this.initBasketData();[m
[31m-		this.initCompareData();[m
[31m-	}[m
[31m-	if (0 === this.errorCode)[m
[31m-	{[m
[31m-		BX.ready(BX.delegate(this.Init,this));[m
[31m-	}[m
[31m-	this.params = {};[m
[31m-};[m
[31m-[m
[31m-window.JCCatalogElement.prototype.Init = function()[m
[31m-{[m
[31m-	var i = 0,[m
[31m-		j = 0,[m
[31m-		strPrefix = '',[m
[31m-		SliderImgs = null,[m
[31m-		TreeItems = null;[m
[31m-[m
[31m-	this.obProduct = BX(this.visual.ID);[m
[31m-	if (!this.obProduct)[m
[31m-	{[m
[31m-		this.errorCode = -1;[m
[31m-	}[m
[31m-	this.obPict = BX(this.visual.PICT_ID);[m
[31m-	if (!this.obPict)[m
[31m-	{[m
[31m-		this.errorCode = -2;[m
[31m-	}[m
[31m-	else[m
[31m-	{[m
[31m-		this.obPictAligner = this.obPict.parentNode;[m
[31m-	}[m
[31m-[m
[31m-	if (this.config.showPrice)[m
[31m-	{[m
[31m-		this.obPrice.price = BX(this.visual.PRICE_ID);[m
[31m-		if (!this.obPrice.price && this.config.useCatalog)[m
[31m-		{[m
[31m-			this.errorCode = -16;[m
[31m-		}[m
[31m-		else[m
[31m-		{[m
[31m-			if (this.config.showOldPrice)[m
[31m-			{[m
[31m-				this.obPrice.full = BX(this.visual.OLD_PRICE_ID);[m
[31m-				this.obPrice.discount = BX(this.visual.DISCOUNT_VALUE_ID);[m
[31m-				if (!this.obPrice.full || !this.obPrice.discount)[m
[31m-				{[m
[31m-					this.config.showOldPrice = false;[m
[31m-				}[m
[31m-			}[m
[31m-			if (this.config.showPercent)[m
[31m-			{[m
[31m-				this.obPrice.percent = BX(this.visual.DISCOUNT_PERC_ID);[m
[31m-				if (!this.obPrice.percent)[m
[31m-				{[m
[31m-					this.config.showPercent = false;[m
[31m-				}[m
[31m-			}[m
[31m-		}[m
[31m-		this.obBasketActions = BX(this.visual.BASKET_ACTIONS_ID);[m
[31m-		if (!!this.obBasketActions)[m
[31m-		{[m
[31m-			if (BX.util.in_array('BUY', this.config.basketAction))[m
[31m-			{[m
[31m-				this.obBuyBtn = BX(this.visual.BUY_ID);[m
[31m-			}[m
[31m-			if (BX.util.in_array('ADD', this.config.basketAction))[m
[31m-			{[m
[31m-				this.obAddToBasketBtn = BX(this.visual.ADD_BASKET_ID);[m
[31m-			}[m
[31m-		}[m
[31m-		this.obNotAvail = BX(this.visual.NOT_AVAILABLE_MESS);[m
[31m-	}[m
[31m-[m
[31m-	if (this.config.showQuantity)[m
[31m-	{[m
[31m-		this.obQuantity = BX(this.visual.QUANTITY_ID);[m
[31m-		if (!!this.visual.QUANTITY_UP_ID)[m
[31m-		{[m
[31m-			this.obQuantityUp = BX(this.visual.QUANTITY_UP_ID);[m
[31m-		}[m
[31m-		if (!!this.visual.QUANTITY_DOWN_ID)[m
[31m-		{[m
[31m-			this.obQuantityDown = BX(this.visual.QUANTITY_DOWN_ID);[m
[31m-		}[m
[31m-		if (this.config.showBasisPrice)[m
[31m-		{[m
[31m-			this.obBasisPrice = BX(this.visual.BASIS_PRICE);[m
[31m-		}[m
[31m-	}[m
[31m-	if (3 === this.productType)[m
[31m-	{[m
[31m-		if (!!this.visual.TREE_ID)[m
[31m-		{[m
[31m-			this.obTree = BX(this.visual.TREE_ID);[m
[31m-			if (!this.obTree)[m
[31m-			{[m
[31m-				this.errorCode = -256;[m
[31m-			}[m
[31m-			strPrefix = this.visual.TREE_ITEM_ID;[m
[31m-			for (i = 0; i < this.treeProps.length; i++)[m
[31m-			{[m
[31m-				this.obTreeRows[i] = {[m
[31m-					LEFT: BX(strPrefix+this.treeProps[i].ID+'_left'),[m
[31m-					RIGHT: BX(strPrefix+this.treeProps[i].ID+'_right'),[m
[31m-					LIST: BX(strPrefix+this.treeProps[i].ID+'_list'),[m
[31m-					CONT: BX(strPrefix+this.treeProps[i].ID+'_cont')[m
[31m-				};[m
[31m-				if (!this.obTreeRows[i].LEFT || !this.obTreeRows[i].RIGHT || !this.obTreeRows[i].LIST || !this.obTreeRows[i].CONT)[m
[31m-				{[m
[31m-					this.errorCode = -512;[m
[31m-					break;[m
[31m-				}[m
[31m-			}[m
[31m-		}[m
[31m-		if (!!this.visual.QUANTITY_MEASURE)[m
[31m-		{[m
[31m-			this.obMeasure = BX(this.visual.QUANTITY_MEASURE);[m
[31m-		}[m
[31m-		if (!!this.visual.QUANTITY_LIMIT)[m
[31m-		{[m
[31m-			this.obQuantityLimit.all = BX(this.visual.QUANTITY_LIMIT);[m
[31m-			if (!!this.obQuantityLimit.all)[m
[31m-			{[m
[31m-				this.obQuantityLimit.value = BX.findChild(this.obQuantityLimit.all, {tagName: 'span'}, false, false);[m
[31m-				if (!this.obQuantityLimit.value)[m
[31m-				{[m
[31m-					this.obQuantityLimit.all = null;[m
[31m-				}[m
[31m-			}[m
[31m-		}[m
[31m-	}[m
[31m-[m
[31m-	if (this.config.showSkuProps)[m
[31m-	{[m
[31m-		if (!!this.visual.DISPLAY_PROP_DIV)[m
[31m-		{[m
[31m-			this.obSkuProps = BX(this.visual.DISPLAY_PROP_DIV);[m
[31m-		}[m
[31m-	}[m
[31m-[m
[31m-	if (this.config.useCompare)[m
[31m-	{[m
[31m-		this.obCompare = BX(this.visual.COMPARE_LINK_ID);[m
[31m-	}[m
[31m-[m
[31m-	if (0 === this.errorCode)[m
[31m-	{[m
[31m-		if (this.config.showQuantity)[m
[31m-		{[m
[31m-			if (!!this.obQuantityUp)[m
[31m-			{[m
[31m-				BX.bind(this.obQuantityUp, 'click', BX.delegate(this.QuantityUp, this));[m
[31m-			}[m
[31m-			if (!!this.obQuantityDown)[m
[31m-			{[m
[31m-				BX.bind(this.obQuantityDown, 'click', BX.delegate(this.QuantityDown, this));[m
[31m-			}[m
[31m-			if (!!this.obQuantity)[m
[31m-			{[m
[31m-				BX.bind(this.obQuantity, 'change', BX.delegate(this.QuantityChange, this));[m
[31m-			}[m
[31m-		}[m
[31m-		switch (this.productType)[m
[31m-		{[m
[31m-			case 0://no catalog[m
[31m-			case 1://product[m
[31m-			case 2://set[m
[31m-				if (this.product.useSlider)[m
[31m-				{[m
[31m-					this.product.slider = {[m
[31m-						COUNT: this.product.sliderCount,[m
[31m-						ID: this.visual.SLIDER_CONT,[m
[31m-						CONT: BX(this.visual.SLIDER_CONT),[m
[31m-						LIST: BX(this.visual.SLIDER_LIST),[m
[31m-						LEFT: BX(this.visual.SLIDER_LEFT),[m
[31m-						RIGHT: BX(this.visual.SLIDER_RIGHT),[m
[31m-						START: 0[m
[31m-					};[m
[31m-					SliderImgs = BX.findChildren(this.product.slider.LIST, {tagName: 'li'}, true);[m
[31m-					if (!!SliderImgs && 0 < SliderImgs.length)[m
[31m-					{[m
[31m-						for (j = 0; j < SliderImgs.length; j++)[m
[31m-						{[m
[31m-							BX.bind(SliderImgs[j], 'click', BX.delegate(this.ProductSelectSliderImg, this));[m
[31m-						}[m
[31m-					}[m
[31m-					if (!!this.product.slider.LEFT)[m
[31m-					{[m
[31m-						BX.bind(this.product.slider.LEFT, 'click', BX.delegate(this.ProductSliderRowLeft, this));[m
[31m-						BX.adjust(this.product.slider.LEFT, { style: this.sliderDisableArrow } );[m
[31m-[m
[31m-					}[m
[31m-					if (!!this.product.slider.RIGHT)[m
[31m-					{[m
[31m-						BX.bind(this.product.slider.RIGHT, 'click', BX.delegate(this.ProductSliderRowRight, this));[m
[31m-						BX.adjust(this.product.slider.RIGHT, { style: this.sliderEnableArrow } );[m
[31m-					}[m
[31m-					this.setCurrentImg(this.product.sliderPict[0], true);[m
[31m-				}[m
[31m-				break;[m
[31m-			case 3://sku[m
[31m-				TreeItems = BX.findChildren(this.obTree, {tagName: 'li'}, true);[m
[31m-				if (!!TreeItems && 0 < TreeItems.length)[m
[31m-				{[m
[31m-					for (i = 0; i < TreeItems.length; i++)[m
[31m-					{[m
[31m-						BX.bind(TreeItems[i], 'click', BX.delegate(this.SelectOfferProp, this));[m
[31m-					}[m
[31m-				}[m
[31m-				for (i = 0; i < this.obTreeRows.length; i++)[m
[31m-				{[m
[31m-					BX.bind(this.obTreeRows[i].LEFT, 'click', BX.delegate(this.RowLeft, this));[m
[31m-					BX.bind(this.obTreeRows[i].RIGHT, 'click', BX.delegate(this.RowRight, this));[m
[31m-				}[m
[31m-				for (i = 0; i < this.offers.length; i++)[m
[31m-				{[m
[31m-					this.offers[i].SLIDER_COUNT = parseInt(this.offers[i].SLIDER_COUNT, 10);[m
[31m-					if (isNaN(this.offers[i].SLIDER_COUNT))[m
[31m-					{[m
[31m-						this.offers[i].SLIDER_COUNT = 0;[m
[31m-					}[m
[31m-					if (0 === this.offers[i].SLIDER_COUNT)[m
[31m-					{[m
[31m-						this.sliders[i] = {[m
[31m-							COUNT: this.offers[i].SLIDER_COUNT,[m
[31m-							ID: ''[m
[31m-						};[m
[31m-					}[m
[31m-					else[m
[31m-					{[m
[31m-						for (j = 0; j < this.offers[i].SLIDER.length; j++)[m
[31m-						{[m
[31m-							this.offers[i].SLIDER[j].WIDTH = parseInt(this.offers[i].SLIDER[j].WIDTH, 10);[m
[31m-							this.offers[i].SLIDER[j].HEIGHT = parseInt(this.offers[i].SLIDER[j].HEIGHT, 10);[m
[31m-						}[m
[31m-						this.sliders[i] = {[m
[31m-							COUNT: this.offers[i].SLIDER_COUNT,[m
[31m-							OFFER_ID: this.offers[i].ID,[m
[31m-							ID: this.visual.SLIDER_CONT_OF_ID+this.offers[i].ID,[m
[31m-							CONT: BX(this.visual.SLIDER_CONT_OF_ID+this.offers[i].ID),[m
[31m-							LIST: BX(this.visual.SLIDER_LIST_OF_ID+this.offers[i].ID),[m
[31m-							LEFT: BX(this.visual.SLIDER_LEFT_OF_ID+this.offers[i].ID),[m
[31m-							RIGHT: BX(this.visual.SLIDER_RIGHT_OF_ID+this.offers[i].ID),[m
[31m-							START: 0[m
[31m-						};[m
[31m-						SliderImgs = BX.findChildren(this.sliders[i].LIST, {tagName: 'li'}, true);[m
[31m-						if (!!SliderImgs && 0 < SliderImgs.length)[m
[31m-						{[m
[31m-							for (j = 0; j < SliderImgs.length; j++)[m
[31m-							{[m
[31m-								BX.bind(SliderImgs[j], 'click', BX.delegate(this.SelectSliderImg, this));[m
[31m-							}[m
[31m-						}[m
[31m-						if (!!this.sliders[i].LEFT)[m
[31m-						{[m
[31m-							BX.bind(this.sliders[i].LEFT, 'click', BX.delegate(this.SliderRowLeft, this));[m
[31m-						}[m
[31m-						if (!!this.sliders[i].RIGHT)[m
[31m-						{[m
[31m-							BX.bind(this.sliders[i].RIGHT, 'click', BX.delegate(this.SliderRowRight, this));[m
[31m-						}[m
[31m-					}[m
[31m-				}[m
[31m-				this.SetCurrent();[m
[31m-				break;[m
[31m-		}[m
[31m-[m
[31m-		if (!!this.obBuyBtn)[m
[31m-		{[m
[31m-			BX.bind(this.obBuyBtn, 'click', BX.proxy(this.BuyBasket, this));[m
[31m-		}[m
[31m-		if (!!this.obAddToBasketBtn)[m
[31m-		{[m
[31m-			BX.bind(this.obAddToBasketBtn, 'click', BX.proxy(this.Add2Basket, this));[m
[31m-		}[m
[31m-		if (!!this.obCompare)[m
[31m-		{[m
[31m-			BX.bind(this.obCompare, 'click', BX.proxy(this.Compare, this));[m
[31m-		}[m
[31m-[m
[31m-		this.setMainPictHandler();[m
[31m-	}[m
[31m-};[m
[31m-[m
[31m-window.JCCatalogElement.prototype.initConfig = function()[m
[31m-{[m
[31m-	this.productType = parseInt(this.params.PRODUCT_TYPE, 10);[m
[31m-	if (!!this.params.CONFIG && typeof(this.params.CONFIG) === 'object')[m
[31m-	{[m
[31m-		if (this.params.CONFIG.USE_CATALOG !== 'undefined' && BX.type.isBoolean(this.params.CONFIG.USE_CATALOG))[m
[31m-		{[m
[31m-			this.config.useCatalog = this.params.CONFIG.USE_CATALOG;[m
[31m-		}[m
[31m-		this.config.showQuantity = !!this.params.CONFIG.SHOW_QUANTITY;[m
[31m-		this.config.showPrice = !!this.params.CONFIG.SHOW_PRICE;[m
[31m-		this.config.showPercent = !!this.params.CONFIG.SHOW_DISCOUNT_PERCENT;[m
[31m-		this.config.showOldPrice = !!this.params.CONFIG.SHOW_OLD_PRICE;[m
[31m-		this.config.showSkuProps = !!this.params.CONFIG.SHOW_SKU_PROPS;[m
[31m-		this.config.showOfferGroup = !!this.params.CONFIG.OFFER_GROUP;[m
[31m-		this.config.useCompare = !!this.params.CONFIG.DISPLAY_COMPARE;[m
[31m-		if (!!this.params.CONFIG.MAIN_PICTURE_MODE)[m
[31m-		{[m
[31m-			this.config.mainPictureMode = this.params.CONFIG.MAIN_PICTURE_MODE;[m
[31m-		}[m
[31m-		this.config.showBasisPrice = !!this.params.CONFIG.SHOW_BASIS_PRICE;[m
[31m-		if (!!this.params.CONFIG.ADD_TO_BASKET_ACTION)[m
[31m-		{[m
[31m-			this.config.basketAction = this.params.CONFIG.ADD_TO_BASKET_ACTION;[m
[31m-		}[m
[31m-		this.config.showClosePopup = !!this.params.CONFIG.SHOW_CLOSE_POPUP;[m
[31m-	}[m
[31m-	else[m
[31m-	{[m
[31m-		// old version[m
[31m-		if (this.params.USE_CATALOG !== 'undefined' && BX.type.isBoolean(this.params.USE_CATALOG))[m
[31m-		{[m
[31m-			this.config.useCatalog = this.params.USE_CATALOG;[m
[31m-		}[m
[31m-		this.config.showQuantity = !!this.params.SHOW_QUANTITY;[m
[31m-		this.config.showPrice = !!this.params.SHOW_PRICE;[m
[31m-		this.config.showPercent = !!this.params.SHOW_DISCOUNT_PERCENT;[m
[31m-		this.config.showOldPrice = !!this.params.SHOW_OLD_PRICE;[m
[31m-		this.config.showSkuProps = !!this.params.SHOW_SKU_PROPS;[m
[31m-		this.config.showOfferGroup = !!this.params.OFFER_GROUP;[m
[31m-		this.config.useCompare = !!this.params.DISPLAY_COMPARE;[m
[31m-		if (!!this.params.MAIN_PICTURE_MODE)[m
[31m-		{[m
[31m-			this.config.mainPictureMode = this.params.MAIN_PICTURE_MODE;[m
[31m-		}[m
[31m-		this.config.showBasisPrice = !!this.params.SHOW_BASIS_PRICE;[m
[31m-		if (!!this.params.ADD_TO_BASKET_ACTION)[m
[31m-		{[m
[31m-			this.config.basketAction = this.params.ADD_TO_BASKET_ACTION;[m
[31m-		}[m
[31m-		this.config.showClosePopup = !!this.params.SHOW_CLOSE_POPUP;[m
[31m-	}[m
[31m-[m
[31m-	if (!this.params.VISUAL || typeof(this.params.VISUAL) !== 'object' || !this.params.VISUAL.ID)[m
[31m-	{[m
[31m-		this.errorCode = -1;[m
[31m-		return;[m
[31m-	}[m
[31m-	this.visual.ID = this.params.VISUAL.ID;[m
[31m-	this.initVisualParams('main');[m
[31m-	if (this.config.showQuantity)[m
[31m-	{[m
[31m-		this.initVisualParams('quantity');[m
[31m-	}[m
[31m-	if (this.config.showPrice)[m
[31m-	{[m
[31m-		this.initVisualParams('price');[m
[31m-	}[m
[31m-	if (this.config.showOldPrice)[m
[31m-	{[m
[31m-		this.initVisualParams('oldPrice');[m
[31m-	}[m
[31m-	if (this.config.showPercent)[m
[31m-	{[m
[31m-		this.initVisualParams('discountPerc');[m
[31m-	}[m
[31m-	this.initVisualParams('basket');[m
[31m-	if (this.config.mainPictureMode === 'MAGNIFIER')[m
[31m-	{[m
[31m-		this.initVisualParams('magnifier');[m
[31m-	}[m
[31m-	if (this.config.useCompare)[m
[31m-	{[m
[31m-		this.initVisualParams('compare');[m
[31m-	}[m
[31m-};[m
[31m-[m
[31m-window.JCCatalogElement.prototype.initVisualParams = function(ID)[m
[31m-{[m
[31m-	var i = 0,[m
[31m-		key = '';[m
[31m-[m
[31m-	if (!this.listID[ID])[m
[31m-	{[m
[31m-		this.errorCode = -1;[m
[31m-		return;[m
[31m-	}[m
[31m-	for (i = 0; i < this.listID[ID].length; i++)[m
[31m-	{[m
[31m-		key = this.listID[ID][i];[m
[31m-		this.visual[key] = (!!this.params.VISUAL[key] ? this.params.VISUAL[key] : this.visual.ID+this.visualPostfix[key]);[m
[31m-	}[m
[31m-};[m
[31m-[m
[31m-window.JCCatalogElement.prototype.initProductData = function()[m
[31m-{[m
[31m-	var j = 0;[m
[31m-	this.initVisualParams('productSlider');[m
[31m-	if (!!this.params.PRODUCT && 'object' === typeof(this.params.PRODUCT))[m
[31m-	{[m
[31m-		if (this.config.showQuantity)[m
[31m-		{[m
[31m-			this.product.checkQuantity = this.params.PRODUCT.CHECK_QUANTITY;[m
[31m-			this.product.isDblQuantity = this.params.PRODUCT.QUANTITY_FLOAT;[m
[31m-			if (this.product.checkQuantity)[m
[31m-			{[m
[31m-				this.product.maxQuantity = (this.product.isDblQuantity ? parseFloat(this.params.PRODUCT.MAX_QUANTITY) : parseInt(this.params.PRODUCT.MAX_QUANTITY, 10));[m
[31m-			}[m
[31m-			this.product.stepQuantity = (this.product.isDblQuantity ? parseFloat(this.params.PRODUCT.STEP_QUANTITY) : parseInt(this.params.PRODUCT.STEP_QUANTITY, 10));[m
[31m-[m
[31m-			this.checkQuantity = this.product.checkQuantity;[m
[31m-			this.isDblQuantity = this.product.isDblQuantity;[m
[31m-			this.maxQuantity = this.product.maxQuantity;[m
[31m-			this.stepQuantity = this.product.stepQuantity;[m
[31m-			if (this.isDblQuantity)[m
[31m-			{[m
[31m-				this.stepQuantity = Math.round(this.stepQuantity*this.precisionFactor)/this.precisionFactor;[m
[31m-			}[m
[31m-		}[m
[31m-		this.product.canBuy = this.params.PRODUCT.CAN_BUY;[m
[31m-		this.product.canSubscription = this.params.PRODUCT.SUBSCRIPTION;[m
[31m-		if (this.config.showPrice)[m
[31m-		{[m
[31m-			this.currentBasisPrice = this.params.PRODUCT.BASIS_PRICE;[m
[31m-		}[m
[31m-[m
[31m-		this.canBuy = this.product.canBuy;[m
[31m-		this.canSubscription = this.product.canSubscription;[m
[31m-[m
[31m-		this.product.name = this.params.PRODUCT.NAME;[m
[31m-		this.product.pict = this.params.PRODUCT.PICT;[m
[31m-		this.product.id = this.params.PRODUCT.ID;[m
[31m-[m
[31m-		if (!!this.params.PRODUCT.ADD_URL)[m
[31m-		{[m
[31m-			this.product.addUrl = this.params.PRODUCT.ADD_URL;[m
[31m-		}[m
[31m-		if (!!this.params.PRODUCT.BUY_URL)[m
[31m-		{[m
[31m-			this.product.buyUrl = this.params.PRODUCT.BUY_URL;[m
[31m-		}[m
[31m-[m
[31m-		if (!!this.params.PRODUCT.SLIDER_COUNT)[m
[31m-		{[m
[31m-			this.product.sliderCount = parseInt(this.params.PRODUCT.SLIDER_COUNT, 10);[m
[31m-			if (isNaN(this.product.sliderCount))[m
[31m-			{[m
[31m-				this.product.sliderCount = 0;[m
[31m-			}[m
[31m-			if (0 < this.product.sliderCount && !!this.params.PRODUCT.SLIDER.length && 0 < this.params.PRODUCT.SLIDER.length)[m
[31m-			{[m
[31m-				for (j = 0; j < this.params.PRODUCT.SLIDER.length; j++)[m
[31m-				{[m
[31m-					this.product.useSlider = true;[m
[31m-					this.params.PRODUCT.SLIDER[j].WIDTH = parseInt(this.params.PRODUCT.SLIDER[j].WIDTH, 10);[m
[31m-					this.params.PRODUCT.SLIDER[j].HEIGHT = parseInt(this.params.PRODUCT.SLIDER[j].HEIGHT, 10);[m
[31m-				}[m
[31m-				this.product.sliderPict = this.params.PRODUCT.SLIDER;[m
[31m-				this.setCurrentImg(this.product.sliderPict[0], false);[m
[31m-			}[m
[31m-		}[m
[31m-		this.currentIsSet = true;[m
[31m-	}[m
[31m-	else[m
[31m-	{[m
[31m-		this.errorCode = -1;[m
[31m-	}[m
[31m-};[m
[31m-[m
[31m-window.JCCatalogElement.prototype.initOffersData = function()[m
[31m-{[m
[31m-	this.initVisualParams('offerSlider');[m
[31m-	this.initVisualParams('offers');[m
[31m-	if (!!this.params.OFFERS && BX.type.isArray(this.params.OFFERS))[m
[31m-	{[m
[31m-		this.offers = this.params.OFFERS;[m
[31m-		this.offerNum = 0;[m
[31m-		if (!!this.params.OFFER_SELECTED)[m
[31m-		{[m
[31m-			this.offerNum = parseInt(this.params.OFFER_SELECTED, 10);[m
[31m-		}[m
[31m-		if (isNaN(this.offerNum))[m
[31m-		{[m
[31m-			this.offerNum = 0;[m
[31m-		}[m
[31m-		if (!!this.params.TREE_PROPS)[m
[31m-		{[m
[31m-			this.treeProps = this.params.TREE_PROPS;[m
[31m-		}[m
[31m-		if (!!this.params.DEFAULT_PICTURE)[m
[31m-		{[m
[31m-			this.defaultPict.preview = this.params.DEFAULT_PICTURE.PREVIEW_PICTIRE;[m
[31m-			this.defaultPict.detail = this.params.DEFAULT_PICTURE.DETAIL_PICTURE;[m
[31m-		}[m
[31m-		if (!!this.params.PRODUCT && typeof(this.params.PRODUCT) === 'object')[m
[31m-		{[m
[31m-			this.product.id = parseInt(this.params.PRODUCT.ID, 10);[m
[31m-			this.product.name = this.params.PRODUCT.NAME;[m
[31m-		}[m
[31m-	}[m
[31m-	else[m
[31m-	{[m
[31m-		this.errorCode = -1;[m
[31m-	}[m
[31m-};[m
[31m-[m
[31m-window.JCCatalogElement.prototype.initBasketData = function()[m
[31m-{[m
[31m-	if (!!this.params.BASKET && 'object' === typeof(this.params.BASKET))[m
[31m-	{[m
[31m-		if (1 === this.productType || 2 === this.productType)[m
[31m-		{[m
[31m-			this.basketData.useProps = !!this.params.BASKET.ADD_PROPS;[m
[31m-			this.basketData.emptyProps = !!this.params.BASKET.EMPTY_PROPS;[m
[31m-		}[m
[31m-[m
[31m-		if (!!this.params.BASKET.QUANTITY)[m
[31m-		{[m
[31m-			this.basketData.quantity = this.params.BASKET.QUANTITY;[m
[31m-		}[m
[31m-		if (!!this.params.BASKET.PROPS)[m
[31m-		{[m
[31m-			this.basketData.props = this.params.BASKET.PROPS;[m
[31m-		}[m
[31m-		if (!!this.params.BASKET.BASKET_URL)[m
[31m-		{[m
[31m-			this.basketData.basketUrl = this.params.BASKET.BASKET_URL;[m
[31m-		}[m
[31m-		if (3 === this.productType)[m
[31m-		{[m
[31m-			if (!!this.params.BASKET.SKU_PROPS)[m
[31m-			{[m
[31m-				this.basketData.sku_props = this.params.BASKET.SKU_PROPS;[m
[31m-			}[m
[31m-		}[m
[31m-		if (!!this.params.BASKET.ADD_URL_TEMPLATE)[m
[31m-		{[m
[31m-			this.basketData.add_url = this.params.BASKET.ADD_URL_TEMPLATE;[m
[31m-		}[m
[31m-		if (!!this.params.BASKET.BUY_URL_TEMPLATE)[m
[31m-		{[m
[31m-			this.basketData.buy_url = this.params.BASKET.BUY_URL_TEMPLATE;[m
[31m-		}[m
[31m-		if (this.basketData.add_url === '' && this.basketData.buy_url === '')[m
[31m-		{[m
[31m-			this.errorCode = -1024;[m
[31m-		}[m
[31m-	}[m
[31m-};[m
[31m-[m
[31m-window.JCCatalogElement.prototype.initCompareData = function()[m
[31m-{[m
[31m-	if (this.config.useCompare)[m
[31m-	{[m
[31m-		if (!!this.params.COMPARE && typeof(this.params.COMPARE) === 'object')[m
[31m-		{[m
[31m-			if (!!this.params.COMPARE.COMPARE_PATH)[m
[31m-			{[m
[31m-				this.compareData.comparePath = this.params.COMPARE.COMPARE_PATH;[m
[31m-			}[m
[31m-			if (!!this.params.COMPARE.COMPARE_URL_TEMPLATE)[m
[31m-			{[m
[31m-				this.compareData.compareUrl = this.params.COMPARE.COMPARE_URL_TEMPLATE;[m
[31m-			}[m
[31m-			else[m
[31m-			{[m
[31m-				this.config.useCompare = false;[m
[31m-			}[m
[31m-		}[m
[31m-		else[m
[31m-		{[m
[31m-			this.config.useCompare = false;[m
[31m-		}[m
[31m-	}[m
[31m-};[m
[31m-[m
[31m-window.JCCatalogElement.prototype.setMainPictHandler = function()[m
[31m-{[m
[31m-	switch (this.config.mainPictureMode)[m
[31m-	{[m
[31m-		case 'GALLERY':[m
[31m-			break;[m
[31m-		case 'MAGNIFIER':[m
[31m-			this.magnify.obBigImg = BX(this.visual.BIG_IMG_CONT_ID);[m
[31m-			this.magnify.obBigSlider = BX(this.visual.BIG_SLIDER_ID);[m
[31m-			if (!!this.magnify.obBigImg && !!this.magnify.obBigSlider)[m
[31m-			{[m
[31m-				this.magnify.obMagnifyArea = this.obPictAligner.appendChild(BX.create([m
[31m-					'DIV',[m
[31m-					{[m
[31m-						props: {[m
[31m-							id: this.visual.MAGNIFIER_AREA_ID,[m
[31m-							className: 'bx_item_slider_lupe_small'[m
[31m-						},[m
[31m-						style: {[m
[31m-							display: 'none',[m
[31m-							top: 0,[m
[31m-							left: 0,[m
[31m-							width: '100px',[m
[31m-							height: '130px'[m
[31m-						},[m
[31m-						events: {[m
[31m-							mouseover: BX.delegate(this.onMagnifierArea, this),[m
[31m-							mouseout: BX.delegate(function(){this.outMagnifierArea(); this.hideMagnifier(); }, this)[m
[31m-						}[m
[31m-					}[m
[31m-				));[m
[31m-[m
[31m-				this.magnify.obMagnifier = this.magnify.obBigSlider.appendChild(BX.create([m
[31m-					'DIV',[m
[31m-					{[m
[31m-						props: {[m
[31m-							id: this.visual.MAGNIFIER_ID,[m
[31m-							className: 'bx_item_slider_lupe'[m
[31m-						},[m
[31m-						style: {[m
[31m-							display: 'none'[m
[31m-						}[m
[31m-					}[m
[31m-				));[m
[31m-				this.magnify.obMagnifyPict = this.magnify.obMagnifier.appendChild(BX.create([m
[31m-					'IMG',[m
[31m-					{[m
[31m-						props: {[m
[31m-							src: this.currentImg.src[m
[31m-						}[m
[31m-					}[m
[31m-				));[m
[31m-				BX.bind(this.obPict, 'mouseover', BX.delegate(this.showMagnifier, this));[m
[31m-			}[m
[31m-			break;[m
[31m-		case 'POPUP':[m
[31m-			this.obPopupPict = new BX.PopupWindow('CatalogElementPopup_'+this.visual.ID, null, {[m
[31m-				autoHide: false,[m
[31m-				offsetLeft: 0,[m
[31m-				offsetTop: 0,[m
[31m-				overlay : false,[m
[31m-				closeByEsc: true,[m
[31m-				titleBar: true,[m
[31m-				closeIcon: {top: '10px', right: '10px'}[m
[31m-			});[m
[31m-			BX.bind(this.obPict, 'click', BX.delegate(this.showMainPictPopup, this));[m
[31m-			BX.adjust(this.obPict, { style: { cursor: 'pointer' } });[m
[31m-			BX.addCustomEvent(this.obPopupPict, "onAfterPopupShow", BX.proxy(this.onPopupWindowShow, this));[m
[31m-			BX.addCustomEvent(this.obPopupPict, "onPopupClose", BX.proxy(this.onPopupWindowClose, this));[m
[31m-			break;[m
[31m-		default:[m
[31m-			break;[m
[31m-	}[m
[31m-};[m
[31m-[m
[31m-window.JCCatalogElement.prototype.setCurrentImg = function(img, showImage)[m
[31m-{[m
[31m-	showImage = !!showImage;[m
[31m-	this.currentImg.src = img.SRC;[m
[31m-	this.currentImg.width = img.WIDTH;[m
[31m-	this.currentImg.height = img.HEIGHT;[m
[31m-	if (showImage && !!this.obPict)[m
[31m-	{[m
[31m-		if (this.config.mainPictureMode === 'MAGNIFIER')[m
[31m-		{[m
[31m-			this.outMagnifierArea();[m
[31m-			this.hideMagnifier();[m
[31m-		}[m
[31m-		BX.adjust(this.obPict, { props: { src: this.currentImg.src } });[m
[31m-		var dest = {[m
[31m-				width: parseInt(this.obPictAligner.offsetWidth, 10),[m
[31m-				height: parseInt(this.obPictAligner.offsetHeight, 10)[m
[31m-			},[m
[31m-			result,[m
[31m-			newMarginTop;[m
[31m-		result = this.scaleImg(this.currentImg, dest);[m
[31m-[m
[31m-		newMarginTop = (result.height < dest.height ? (dest.height - result.height) >>> 1 : 0);[m
[31m-		if (newMarginTop !== this.currentImg.screenOffsetY)[m
[31m-		{[m
[31m-			BX.style(this.obPictAligner, 'marginTop', newMarginTop+'px');[m
[31m-			this.currentImg.screenOffsetY = newMarginTop;[m
[31m-		}[m
[31m-		this.currentImg.screenOffsetX = (result.width < dest.width ? (dest.width - result.width) >>> 1 : 0);[m
[31m-		this.currentImg.screenWidth = result.width;[m
[31m-		this.currentImg.screenHeight = result.height;[m
[31m-	}[m
[31m-};[m
[31m-[m
[31m-window.JCCatalogElement.prototype.scaleImg = function(src, dest)[m
[31m-{[m
[31m-	var[m
[31m-		scaleX,[m
[31m-		scaleY,[m
[31m-		scale,[m
[31m-		result = {};[m
[31m-[m
[31m-	if (dest.width >= src.width && dest.height >= src.height)[m
[31m-	{[m
[31m-		result.width = src.width;[m
[31m-		result.height = src.height;[m
[31m-	}[m
[31m-	else[m
[31m-	{[m
[31m-		scaleX = dest.width/src.width;[m
[31m-		scaleY = dest.height/src.height;[m
[31m-		scale =  Math.min(scaleX, scaleY);[m
[31m-		result.width = Math.max(1, parseInt(scale*src.width , 10));[m
[31m-		result.height = Math.max(1, parseInt(scale*src.height , 10));[m
[31m-	}[m
[31m-	return result;[m
[31m-};[m
[31m-[m
[31m-window.JCCatalogElement.prototype.showMagnifier = function(e)[m
[31m-{[m
[31m-	if (!this.magnify.magnifyShow)[m
[31m-	{[m
[31m-		this.calcMagnifierParams();[m
[31m-		this.calcMagnifyAreaSize();[m
[31m-		this.calcMagnifyAreaPos(e);[m
[31m-		this.calcMagnifyPictSize();[m
[31m-		this.calcMagnifyPictPos();[m
[31m-		this.setMagnifyAreaParams(true);[m
[31m-		this.setMagnifyPictParams(true);[m
[31m-		this.setMagnifierParams(true);[m
[31m-		BX.bind(document, 'mousemove', BX.proxy(this.moveMagnifierArea, this));[m
[31m-	}[m
[31m-};[m
[31m-[m
[31m-window.JCCatalogElement.prototype.hideMagnifier = function()[m
[31m-{[m
[31m-	if (!this.magnify.magnifyShow)[m
[31m-	{[m
[31m-		if (!!this.magnify.obMagnifier)[m
[31m-		{[m
[31m-			BX.adjust(this.magnify.obMagnifier, { style: { display: 'none' } });[m
[31m-		}[m
[31m-		if (!!this.magnify.obMagnifyArea)[m
[31m-		{[m
[31m-			BX.adjust(this.magnify.obMagnifyArea, { style: { display: 'none' } });[m
[31m-		}[m
[31m-		BX.unbind(document, 'mousemove', BX.proxy(this.moveMagnifierArea, this));[m
[31m-	}[m
[31m-};[m
[31m-[m
[31m-window.JCCatalogElement.prototype.moveMagnifierArea = function(e)[m
[31m-{[m
[31m-	var[m
[31m-		currentPos = {[m
[31m-			X: 0,[m
[31m-			Y: 0[m
[31m-		},[m
[31m-		posBigImg = BX.pos(this.obPict),[m
[31m-		intersect = {},[m
[31m-		params = {},[m
[31m-		paramsPict = {};[m
[31m-[m
[31m-	currentPos = this.inRect(e, posBigImg);[m
[31m-	if (this.inBound(posBigImg, currentPos))[m
[31m-	{[m
[31m-		intersect = this.intersectArea(currentPos, posBigImg);[m
[31m-		switch (intersect.X)[m
[31m-		{[m
[31m-			case -1:[m
[31m-				this.magnify.areaParams.left = this.currentImg.screenOffsetX;[m
[31m-				break;[m
[31m-			case 0:[m
[31m-				this.magnify.areaParams.left = this.currentImg.screenOffsetX + currentPos.X - (this.magnify.areaParams.width >>> 1);[m
[31m-				break;[m
[31m-			case 1:[m
[31m-				this.magnify.areaParams.left = this.currentImg.screenOffsetX + posBigImg.width - this.magnify.areaParams.width;[m
[31m-				break;[m
[31m-		}[m
[31m-		switch (intersect.Y)[m
[31m-		{[m
[31m-			case -1:[m
[31m-				this.magnify.areaParams.top = 0;[m
[31m-				break;[m
[31m-			case 0:[m
[31m-				this.magnify.areaParams.top = currentPos.Y - (this.magnify.areaParams.height >>> 1);[m
[31m-				break;[m
[31m-			case 1:[m
[31m-				this.magnify.areaParams.top = posBigImg.height - this.magnify.areaParams.height;[m
[31m-				break;[m
[31m-		}[m
[31m-		this.magnify.magnifyPictParams.marginLeft = -parseInt(((this.magnify.areaParams.left-this.currentImg.screenOffsetX)*this.currentImg.scale), 10);[m
[31m-		this.magnify.magnifyPictParams.marginTop = -parseInt(((this.magnify.areaParams.top)*this.currentImg.scale), 10);[m
[31m-		params.left = this.magnify.areaParams.left+'px';[m
[31m-		params.top = this.magnify.areaParams.top+'px';[m
[31m-		BX.adjust(this.magnify.obMagnifyArea, { style: params });[m
[31m-		paramsPict.marginLeft = this.magnify.magnifyPictParams.marginLeft+'px';[m
[31m-		paramsPict.marginTop = this.magnify.magnifyPictParams.marginTop+'px';[m
[31m-		BX.adjust(this.magnify.obMagnifyPict, { style: paramsPict });[m
[31m-	}[m
[31m-	else[m
[31m-	{[m
[31m-		this.outMagnifierArea();[m
[31m-		this.hideMagnifier();[m
[31m-	}[m
[31m-};[m
[31m-[m
[31m-window.JCCatalogElement.prototype.onMagnifierArea = function()[m
[31m-{[m
[31m-	this.magnify.magnifyShow = true;[m
[31m-};[m
[31m-[m
[31m-window.JCCatalogElement.prototype.outMagnifierArea = function()[m
[31m-{[m
[31m-	this.magnify.magnifyShow = false;[m
[31m-};[m
[31m-[m
[31m-window.JCCatalogElement.prototype.calcMagnifierParams = function()[m
[31m-{[m
[31m-	if (!!this.magnify.obBigImg)[m
[31m-	{[m
[31m-		var pos = BX.pos(this.magnify.obBigImg, true);[m
[31m-[m
[31m-		this.magnify.magnifierParams.width = pos.width;[m
[31m-		this.magnify.magnifierParams.height = pos.height;[m
[31m-		this.magnify.magnifierParams.top = pos.top;[m
[31m-		this.magnify.magnifierParams.left = pos.left + pos.width + 2;[m
[31m-	}[m
[31m-};[m
[31m-[m
[31m-window.JCCatalogElement.prototype.setMagnifierParams = function(show)[m
[31m-{[m
[31m-	if (!!this.magnify.obMagnifier)[m
[31m-	{[m
[31m-		show = !!show;[m
[31m-		var params = {[m
[31m-			top: this.magnify.magnifierParams.top+'px',[m
[31m-			left: this.magnify.magnifierParams.left+'px',[m
[31m-			width: this.magnify.magnifierParams.width+'px',[m
[31m-			height: this.magnify.magnifierParams.height+'px'[m
[31m-		};[m
[31m-		if (show)[m
[31m-		{[m
[31m-			params.display = '';[m
[31m-		}[m
[31m-		BX.adjust(this.magnify.obMagnifier, { style: params });[m
[31m-	}[m
[31m-};[m
[31m-[m
[31m-window.JCCatalogElement.prototype.setMagnifyAreaParams = function(show)[m
[31m-{[m
[31m-	if (!!this.magnify.obMagnifier)[m
[31m-	{[m
[31m-		show = !!show;[m
[31m-		var params = {[m
[31m-			top: this.magnify.areaParams.top+'px',[m
[31m-			left: this.magnify.areaParams.left+'px',[m
[31m-			width: this.magnify.areaParams.width+'px',[m
[31m-			height: this.magnify.areaParams.height+'px'[m
[31m-		};[m
[31m-		if (show)[m
[31m-		{[m
[31m-			params.display = '';[m
[31m-		}[m
[31m-		BX.adjust(this.magnify.obMagnifyArea, { style: params });[m
[31m-	}[m
[31m-};[m
[31m-[m
[31m-window.JCCatalogElement.prototype.calcMagnifyAreaPos = function(e)[m
[31m-{[m
[31m-	var currentPos,[m
[31m-		posBigImg,[m
[31m-		intersect;[m
[31m-[m
[31m-	posBigImg = BX.pos(this.obPict);[m
[31m-	currentPos = this.inRect(e, posBigImg);[m
[31m-	if (this.inBound(posBigImg, currentPos))[m
[31m-	{[m
[31m-		intersect = this.intersectArea(currentPos, posBigImg);[m
[31m-		switch (intersect.X)[m
[31m-		{[m
[31m-			case -1:[m
[31m-				this.magnify.areaParams.left = this.currentImg.screenOffsetX;[m
[31m-				break;[m
[31m-			case 0:[m
[31m-				this.magnify.areaParams.left = this.currentImg.screenOffsetX + currentPos.X - (this.magnify.areaParams.width >>> 1);[m
[31m-				break;[m
[31m-			case 1:[m
[31m-				this.magnify.areaParams.left = this.currentImg.screenOffsetX + posBigImg.width - this.magnify.areaParams.width;[m
[31m-				break;[m
[31m-		}[m
[31m-		switch (intersect.Y)[m
[31m-		{[m
[31m-			case -1:[m
[31m-				this.magnify.areaParams.top = 0;[m
[31m-				break;[m
[31m-			case 0:[m
[31m-				this.magnify.areaParams.top = currentPos.Y - (this.magnify.areaParams.height >>> 1);[m
[31m-				break;[m
[31m-			case 1:[m
[31m-				this.magnify.areaParams.top = posBigImg.height - this.magnify.areaParams.height;[m
[31m-				break;[m
[31m-		}[m
[31m-	}[m
[31m-};[m
[31m-[m
[31m-window.JCCatalogElement.prototype.inBound = function(rect, point)[m
[31m-{[m
[31m-	return ((0 <= point.Y && rect.height >= point.Y) && (0 <= point.X && rect.width >= point.X));[m
[31m-};[m
[31m-[m
[31m-window.JCCatalogElement.prototype.inRect = function(e, rect)[m
[31m-{[m
[31m-	var wndSize = BX.GetWindowSize(),[m
[31m-		currentPos = {[m
[31m-			X: 0,[m
[31m-			Y: 0,[m
[31m-			globalX: 0,[m
[31m-			globalY: 0[m
[31m-		};[m
[31m-[m
[31m-	currentPos.globalX = e.clientX + wndSize.scrollLeft;[m
[31m-	currentPos.X = currentPos.globalX - rect.left;[m
[31m-	currentPos.globalY = e.clientY + wndSize.scrollTop;[m
[31m-	currentPos.Y = currentPos.globalY - rect.top;[m
[31m-	return currentPos;[m
[31m-};[m
[31m-[m
[31m-window.JCCatalogElement.prototype.intersectArea = function(currentPos, rect)[m
[31m-{[m
[31m-	var intersect = {[m
[31m-			X: 0,[m
[31m-			Y: 0[m
[31m-		},[m
[31m-		halfX = this.magnify.areaParams.width >>> 1,[m
[31m-		halfY = this.magnify.areaParams.height >>> 1;[m
[31m-[m
[31m-	if (currentPos.X <= halfX)[m
[31m-	{[m
[31m-		intersect.X = -1;[m
[31m-	}[m
[31m-	else if (currentPos.X >= (rect.width - halfX))[m
[31m-	{[m
[31m-		intersect.X = 1;[m
[31m-	}[m
[31m-	else[m
[31m-	{[m
[31m-		intersect.X = 0;[m
[31m-	}[m
[31m-	if (currentPos.Y <= halfY)[m
[31m-	{[m
[31m-		intersect.Y = -1;[m
[31m-	}[m
[31m-	else if (currentPos.Y >= (rect.height - halfY))[m
[31m-	{[m
[31m-		intersect.Y = 1;[m
[31m-	}[m
[31m-	else[m
[31m-	{[m
[31m-		intersect.Y = 0;[m
[31m-	}[m
[31m-[m
[31m-	return intersect;[m
[31m-};[m
[31m-[m
[31m-window.JCCatalogElement.prototype.calcMagnifyAreaSize = function()[m
[31m-{[m
[31m-	var scaleX,[m
[31m-		scaleY,[m
[31m-		scale;[m
[31m-[m
[31m-	if ([m
[31m-		this.magnify.magnifierParams.width < this.currentImg.width &&[m
[31m-			this.magnify.magnifierParams.height < this.currentImg.height[m
[31m-		)[m
[31m-	{[m
[31m-		scaleX = this.magnify.obBigImg.offsetWidth/this.currentImg.width;[m
[31m-		scaleY = this.magnify.obBigImg.offsetHeight/this.currentImg.height;[m
[31m-		scale =  Math.min(scaleX, scaleY);[m
[31m-		this.currentImg.scale = 1/scale;[m
[31m-		this.magnify.areaParams.width = Math.max(1, parseInt(scale*this.magnify.magnifierParams.width , 10));[m
[31m-		this.magnify.areaParams.height = Math.max(1, parseInt(scale*this.magnify.magnifierParams.height , 10));[m
[31m-		this.magnify.areaParams.scaleFactor = this.magnify.magnifierParams.defaultScale;[m
[31m-	}[m
[31m-	else[m
[31m-	{[m
[31m-		scaleX = this.obPict.offsetWidth/this.magnify.obBigImg.offsetWidth;[m
[31m-		scaleY = this.obPict.offsetHeight/this.magnify.obBigImg.offsetHeight;[m
[31m-		scale =  Math.min(scaleX, scaleY);[m
[31m-		this.currentImg.scale = 1/scale;[m
[31m-		this.magnify.areaParams.width = Math.max(1, parseInt(scale*this.magnify.magnifierParams.width , 10));[m
[31m-		this.magnify.areaParams.height = Math.max(1, parseInt(scale*this.magnify.magnifierParams.height , 10));[m
[31m-[m
[31m-		scaleX = this.magnify.magnifierParams.width/this.currentImg.width;[m
[31m-		scaleY = this.magnify.magnifierParams.height/this.currentImg.height;[m
[31m-		scale = Math.max(scaleX, scaleY);[m
[31m-		this.magnify.areaParams.scaleFactor = scale;[m
[31m-	}[m
[31m-};[m
[31m-[m
[31m-window.JCCatalogElement.prototype.calcMagnifyPictSize = function()[m
[31m-{[m
[31m-	this.magnify.magnifyPictParams.width = this.currentImg.width*this.magnify.areaParams.scaleFactor;[m
[31m-	this.magnify.magnifyPictParams.height = this.currentImg.height*this.magnify.areaParams.scaleFactor;[m
[31m-};[m
[31m-[m
[31m-window.JCCatalogElement.prototype.calcMagnifyPictPos = function()[m
[31m-{[m
[31m-	this.magnify.magnifyPictParams.marginLeft = -parseInt(((this.magnify.areaParams.left-this.currentImg.screenOffsetX)*this.currentImg.scale), 10);[m
[31m-	this.magnify.magnifyPictParams.marginTop = -parseInt(((this.magnify.areaParams.top)*this.currentImg.scale), 10);[m
[31m-};[m
[31m-[m
[31m-window.JCCatalogElement.prototype.setMagnifyPictParams = function(show)[m
[31m-{[m
[31m-	if (!!this.magnify.obMagnifier)[m
[31m-	{[m
[31m-		show = !!show;[m
[31m-		var params = {[m
[31m-			width: this.magnify.magnifyPictParams.width+'px',[m
[31m-			height: this.magnify.magnifyPictParams.height+'px',[m
[31m-			marginTop: this.magnify.magnifyPictParams.marginTop+'px',[m
[31m-			marginLeft: this.magnify.magnifyPictParams.marginLeft+'px'[m
[31m-		};[m
[31m-		if (show)[m
[31m-		{[m
[31m-			params.display = '';[m
[31m-		}[m
[31m-		BX.adjust(this.magnify.obMagnifyPict, { style: params, props: { src: this.currentImg.src } });[m
[31m-	}[m
[31m-};[m
[31m-[m
[31m-window.JCCatalogElement.prototype.ProductSliderRowLeft = function()[m
[31m-{[m
[31m-	var target = BX.proxy_context;[m
[31m-	if (!!target)[m
[31m-	{[m
[31m-		if (this.sliderRowShowSize < this.product.slider.COUNT)[m
[31m-		{[m
[31m-			if (0 > this.product.slider.START)[m
[31m-			{[m
[31m-				this.product.slider.START++;[m
[31m-				BX.adjust(this.product.slider.LIST, { style: { marginLeft: this.product.slider.START*20+'%' }});[m
[31m-				BX.adjust(this.product.slider.RIGHT, { style: this.sliderEnableArrow });[m
[31m-			}[m
[31m-[m
[31m-			if (0 <= this.product.slider.START)[m
[31m-			{[m
[31m-				BX.adjust(this.product.slider.LEFT, { style: this.sliderDisableArrow });[m
[31m-			}[m
[31m-		}[m
[31m-	}[m
[31m-};[m
[31m-[m
[31m-window.JCCatalogElement.prototype.ProductSliderRowRight = function()[m
[31m-{[m
[31m-	var target = BX.proxy_context;[m
[31m-	if (!!target)[m
[31m-	{[m
[31m-		if (this.sliderRowShowSize < this.product.slider.COUNT)[m
[31m-		{[m
[31m-			if ((this.sliderRowShowSize - this.product.slider.START) < this.product.slider.COUNT)[m
[31m-			{[m
[31m-				this.product.slider.START--;[m
[31m-				BX.adjust(this.product.slider.LIST, { style: { marginLeft: this.product.slider.START*20+'%' }});[m
[31m-				BX.adjust(this.product.slider.LEFT, { style: this.sliderEnableArrow } );[m
[31m-			}[m
[31m-[m
[31m-			if ((this.sliderRowShowSize - this.product.slider.START) >= this.product.slider.COUNT)[m
[31m-			{[m
[31m-				BX.adjust(this.product.slider.RIGHT, { style: this.sliderDisableArrow } );[m
[31m-			}[m
[31m-		}[m
[31m-	}[m
[31m-};[m
[31m-[m
[31m-window.JCCatalogElement.prototype.ProductSelectSliderImg = function()[m
[31m-{[m
[31m-	var strValue = '',[m
[31m-		target = BX.proxy_context;[m
[31m-	if (!!target && target.hasAttribute('data-value'))[m
[31m-	{[m
[31m-		strValue = target.getAttribute('data-value');[m
[31m-		this.SetProductMainPict(strValue);[m
[31m-	}[m
[31m-};[m
[31m-[m
[31m-window.JCCatalogElement.prototype.SetProductMainPict = function(intPict)[m
[31m-{[m
[31m-	var indexPict = -1,[m
[31m-		i = 0,[m
[31m-		j = 0,[m
[31m-		value = '',[m
[31m-		strValue = '',[m
[31m-		RowItems = null;[m
[31m-[m
[31m-	if (0 < this.product.sliderCount)[m
[31m-	{[m
[31m-		for (j = 0; j < this.product.sliderPict.length; j++)[m
[31m-		{[m
[31m-			if (intPict === this.product.sliderPict[j].ID)[m
[31m-			{[m
[31m-				indexPict = j;[m
[31m-				break;[m
[31m-			}[m
[31m-		}[m
[31m-		if (-1 < indexPict)[m
[31m-		{[m
[31m-			if (!!this.product.sliderPict[indexPict])[m
[31m-			{[m
[31m-				this.setCurrentImg(this.product.sliderPict[indexPict], true);[m
[31m-			}[m
[31m-			RowItems = BX.findChildren(this.product.slider.LIST, {tagName: 'li'}, false);[m
[31m-			if (!!RowItems && 0 < RowItems.length)[m
[31m-			{[m
[31m-				strValue = intPict;[m
[31m-				for (i = 0; i < RowItems.length; i++)[m
[31m-				{[m
[31m-					value = RowItems[i].getAttribute('data-value');[m
[31m-					if (value === strValue)[m
[31m-					{[m
[31m-						BX.addClass(RowItems[i], 'bx_active');[m
[31m-					}[m
[31m-					else[m
[31m-					{[m
[31m-						BX.removeClass(RowItems[i], 'bx_active');[m
[31m-					}[m
[31m-				}[m
[31m-			}[m
[31m-		}[m
[31m-	}[m
[31m-};[m
[31m-[m
[31m-window.JCCatalogElement.prototype.SliderRowLeft = function()[m
[31m-{[m
[31m-	var strValue = '',[m
[31m-		index = -1,[m
[31m-		i,[m
[31m-		target = BX.proxy_context;[m
[31m-	if (!!target && target.hasAttribute('data-value'))[m
[31m-	{[m
[31m-		strValue = target.getAttribute('data-value');[m
[31m-		for (i = 0; i < this.sliders.length; i++)[m
[31m-		{[m
[31m-			if (this.sliders[i].OFFER_ID === strValue)[m
[31m-			{[m
[31m-				index = i;[m
[31m-				break;[m
[31m-			}[m
[31m-		}[m
[31m-		if (-1 < index && this.sliderRowShowSize < this.sliders[index].COUNT)[m
[31m-		{[m
[31m-			if (0 > this.sliders[index].START)[m
[31m-			{[m
[31m-				this.sliders[index].START++;[m
[31m-				BX.adjust(this.sliders[index].LIST, { style: { marginLeft: this.sliders[index].START*20+'%' }});[m
[31m-				BX.adjust(this.sliders[index].RIGHT, { style: this.sliderEnableArrow });[m
[31m-			}[m
[31m-[m
[31m-			if (0 <= this.sliders[index].START)[m
[31m-			{[m
[31m-				BX.adjust(this.sliders[index].LEFT, { style: this.sliderDisableArrow });[m
[31m-			}[m
[31m-		}[m
[31m-	}[m
[31m-};[m
[31m-[m
[31m-window.JCCatalogElement.prototype.SliderRowRight = function()[m
[31m-{[m
[31m-	var strValue = '',[m
[31m-		index = -1,[m
[31m-		i,[m
[31m-		target = BX.proxy_context;[m
[31m-	if (!!target && target.hasAttribute('data-value'))[m
[31m-	{[m
[31m-		strValue = target.getAttribute('data-value');[m
[31m-		for (i = 0; i < this.sliders.length; i++)[m
[31m-		{[m
[31m-			if (this.sliders[i].OFFER_ID === strValue)[m
[31m-			{[m
[31m-				index = i;[m
[31m-				break;[m
[31m-			}[m
[31m-		}[m
[31m-		if (-1 < index && this.sliderRowShowSize < this.sliders[index].COUNT)[m
[31m-		{[m
[31m-			if ((this.sliderRowShowSize - this.sliders[index].START) < this.sliders[index].COUNT)[m
[31m-			{[m
[31m-				this.sliders[index].START--;[m
[31m-				BX.adjust(this.sliders[index].LIST, { style: { marginLeft: this.sliders[index].START*20+'%' }});[m
[31m-				BX.adjust(this.sliders[index].LEFT, { style: this.sliderEnableArrow } );[m
[31m-			}[m
[31m-[m
[31m-			if ((this.sliderRowShowSize - this.sliders[index].START) >= this.sliders[index].COUNT)[m
[31m-			{[m
[31m-				BX.adjust(this.sliders[index].RIGHT, { style: this.sliderDisableArrow } );[m
[31m-			}[m
[31m-		}[m
[31m-	}[m
[31m-};[m
[31m-[m
[31m-window.JCCatalogElement.prototype.SelectSliderImg = function()[m
[31m-{[m
[31m-	var strValue = '',[m
[31m-		arItem = [],[m
[31m-		target = BX.proxy_context;[m
[31m-	if (!!target && target.hasAttribute('data-value'))[m
[31m-	{[m
[31m-		strValue = target.getAttribute('data-value');[m
[31m-		arItem = strValue.split('_');[m
[31m-		this.SetMainPict(arItem[0], arItem[1]);[m
[31m-	}[m
[31m-};[m
[31m-[m
[31m-window.JCCatalogElement.prototype.SetMainPict = function(intSlider, intPict)[m
[31m-{[m
[31m-	var index = -1,[m
[31m-		indexPict = -1,[m
[31m-		i,[m
[31m-		j,[m
[31m-		value = '',[m
[31m-		RowItems = null,[m
[31m-		strValue = '';[m
[31m-[m
[31m-	for (i = 0; i < this.offers.length; i++)[m
[31m-	{[m
[31m-		if (intSlider === this.offers[i].ID)[m
[31m-		{[m
[31m-			index = i;[m
[31m-			break;[m
[31m-		}[m
[31m-	}[m
[31m-	if (-1 < index)[m
[31m-	{[m
[31m-		if (0 < this.offers[index].SLIDER_COUNT)[m
[31m-		{[m
[31m-			for (j = 0; j < this.offers[index].SLIDER.length; j++)[m
[31m-			{[m
[31m-				if (intPict === this.offers[index].SLIDER[j].ID)[m
[31m-				{[m
[31m-					indexPict = j;[m
[31m-					break;[m
[31m-				}[m
[31m-			}[m
[31m-			if (-1 < indexPict)[m
[31m-			{[m
[31m-				if (!!this.offers[index].SLIDER[indexPict])[m
[31m-				{[m
[31m-					this.setCurrentImg(this.offers[index].SLIDER[indexPict], true);[m
[31m-				}[m
[31m-				RowItems = BX.findChildren(this.sliders[index].LIST, {tagName: 'li'}, false);[m
[31m-				if (!!RowItems && 0 < RowItems.length)[m
[31m-				{[m
[31m-					strValue = intSlider+'_'+intPict;[m
[31m-					for (i = 0; i < RowItems.length; i++)[m
[31m-					{[m
[31m-						value = RowItems[i].getAttribute('data-value');[m
[31m-						if (value === strValue)[m
[31m-						{[m
[31m-							BX.addClass(RowItems[i], 'bx_active');[m
[31m-						}[m
[31m-						else[m
[31m-						{[m
[31m-							BX.removeClass(RowItems[i], 'bx_active');[m
[31m-						}[m
[31m-					}[m
[31m-				}[m
[31m-			}[m
[31m-		}[m
[31m-	}[m
[31m-};[m
[31m-[m
[31m-window.JCCatalogElement.prototype.SetMainPictFromItem = function(index)[m
[31m-{[m
[31m-	if (!!this.obPict)[m
[31m-	{[m
[31m-		var boolSet = false,[m
[31m-			obNewPict = {};[m
[31m-[m
[31m-		if (!!this.offers[index])[m
[31m-		{[m
[31m-			if (!!this.offers[index].DETAIL_PICTURE)[m
[31m-			{[m
[31m-				obNewPict = this.offers[index].DETAIL_PICTURE;[m
[31m-				boolSet = true;[m
[31m-			}[m
[31m-			else if (!!this.offers[index].PREVIEW_PICTURE)[m
[31m-			{[m
[31m-				obNewPict = this.offers[index].PREVIEW_PICTURE;[m
[31m-				boolSet = true;[m
[31m-			}[m
[31m-		}[m
[31m-		if (!boolSet)[m
[31m-		{[m
[31m-			if (!!this.defaultPict.detail)[m
[31m-			{[m
[31m-				obNewPict = this.defaultPict.detail;[m
[31m-				boolSet = true;[m
[31m-			}[m
[31m-			else if (!!this.defaultPict.preview)[m
[31m-			{[m
[31m-				obNewPict = this.defaultPict.preview;[m
[31m-				boolSet = true;[m
[31m-			}[m
[31m-		}[m
[31m-		if (boolSet)[m
[31m-		{[m
[31m-			this.setCurrentImg(obNewPict, true);[m
[31m-		}[m
[31m-	}[m
[31m-};[m
[31m-[m
[31m-window.JCCatalogElement.prototype.showMainPictPopup = function(e)[m
[31m-{[m
[31m-	var pictContent = '';[m
[31m-[m
[31m-	pictContent = '<div style="text-align: center;"><img src="'+[m
[31m-		this.currentImg.src+[m
[31m-		'" width="'+this.currentImg.width+'" height="'+this.currentImg.height+'" name=""></div>';[m
[31m-	this.obPopupPict.setContent(pictContent);[m
[31m-	this.obPopupPict.show();[m
[31m-	return BX.PreventDefault(e);[m
[31m-};[m
[31m-[m
[31m-window.JCCatalogElement.prototype.QuantityUp = function()[m
[31m-{[m
[31m-	var curValue = 0,[m
[31m-		boolSet = true,[m
[31m-		calcPrice;[m
[31m-[m
[31m-	if (0 === this.errorCode && this.config.showQuantity && this.canBuy)[m
[31m-	{[m
[31m-		curValue = (this.isDblQuantity ? parseFloat(this.obQuantity.value) : parseInt(this.obQuantity.value, 10));[m
[31m-		if (!isNaN(curValue))[m
[31m-		{[m
[31m-			curValue += this.stepQuantity;[m
[31m-			if (this.checkQuantity)[m
[31m-			{[m
[31m-				if (curValue > this.maxQuantity)[m
[31m-				{[m
[31m-					boolSet = false;[m
[31m-				}[m
[31m-			}[m
[31m-[m
[31m-			if (boolSet)[m
[31m-			{[m
[31m-				if (this.isDblQuantity)[m
[31m-				{[m
[31m-					curValue = Math.round(curValue*this.precisionFactor)/this.precisionFactor;[m
[31m-				}[m
[31m-				this.obQuantity.value = curValue;[m
[31m-				calcPrice = {[m
[31m-					DISCOUNT_VALUE: this.currentBasisPrice.DISCOUNT_VALUE * curValue,[m
[31m-					VALUE: this.currentBasisPrice.VALUE * curValue,[m
[31m-					DISCOUNT_DIFF: this.currentBasisPrice.DISCOUNT_DIFF * curValue,[m
[31m-					DISCOUNT_DIFF_PERCENT: this.currentBasisPrice.DISCOUNT_DIFF_PERCENT,[m
[31m-					CURRENCY: this.currentBasisPrice.CURRENCY[m
[31m-				};[m
[31m-				this.setPrice(calcPrice);[m
[31m-			}[m
[31m-		}[m
[31m-	}[m
[31m-};[m
[31m-[m
[31m-window.JCCatalogElement.prototype.QuantityDown = function()[m
[31m-{[m
[31m-	var curValue = 0,[m
[31m-		boolSet = true,[m
[31m-		calcPrice;[m
[31m-[m
[31m-	if (0 === this.errorCode && this.config.showQuantity && this.canBuy)[m
[31m-	{[m
[31m-		curValue = (this.isDblQuantity ? parseFloat(this.obQuantity.value) : parseInt(this.obQuantity.value, 10));[m
[31m-		if (!isNaN(curValue))[m
[31m-		{[m
[31m-			curValue -= this.stepQuantity;[m
[31m-			if (curValue < this.stepQuantity)[m
[31m-			{[m
[31m-				boolSet = false;[m
[31m-			}[m
[31m-			if (boolSet)[m
[31m-			{[m
[31m-				if (this.isDblQuantity)[m
[31m-				{[m
[31m-					curValue = Math.round(curValue*this.precisionFactor)/this.precisionFactor;[m
[31m-				}[m
[31m-				this.obQuantity.value = curValue;[m
[31m-				calcPrice = {[m
[31m-					DISCOUNT_VALUE: this.currentBasisPrice.DISCOUNT_VALUE * curValue,[m
[31m-					VALUE: this.currentBasisPrice.VALUE * curValue,[m
[31m-					DISCOUNT_DIFF: this.currentBasisPrice.DISCOUNT_DIFF * curValue,[m
[31m-					DISCOUNT_DIFF_PERCENT: this.currentBasisPrice.DISCOUNT_DIFF_PERCENT,[m
[31m-					CURRENCY: this.currentBasisPrice.CURRENCY[m
[31m-				};[m
[31m-				this.setPrice(calcPrice);[m
[31m-			}[m
[31m-		}[m
[31m-	}[m
[31m-};[m
[31m-[m
[31m-window.JCCatalogElement.prototype.QuantityChange = function()[m
[31m-{[m
[31m-	var curValue = 0,[m
[31m-		calcPrice,[m
[31m-		intCount,[m
[31m-		count;[m
[31m-[m
[31m-	if (0 === this.errorCode && this.config.showQuantity)[m
[31m-	{[m
[31m-		if (this.canBuy)[m
[31m-		{[m
[31m-			curValue = (this.isDblQuantity ? parseFloat(this.obQuantity.value) : parseInt(this.obQuantity.value, 10));[m
[31m-			if (!isNaN(curValue))[m
[31m-			{[m
[31m-				if (this.checkQuantity)[m
[31m-				{[m
[31m-					if (curValue > this.maxQuantity)[m
[31m-					{[m
[31m-						curValue = this.maxQuantity;[m
[31m-					}[m
[31m-				}[m
[31m-				if (curValue < this.stepQuantity)[m
[31m-				{[m
[31m-					curValue = this.stepQuantity;[m
[31m-				}[m
[31m-				else[m
[31m-				{[m
[31m-					count = Math.round((curValue*this.precisionFactor)/this.stepQuantity)/this.precisionFactor;[m
[31m-					intCount = parseInt(count, 10);[m
[31m-					if (isNaN(intCount))[m
[31m-					{[m
[31m-						intCount = 1;[m
[31m-						count = 1.1;[m
[31m-					}[m
[31m-					if (count > intCount)[m
[31m-					{[m
[31m-						curValue = (intCount <= 1 ? this.stepQuantity : intCount*this.stepQuantity);[m
[31m-						curValue = Math.round(curValue*this.precisionFactor)/this.precisionFactor;[m
[31m-					}[m
[31m-				}[m
[31m-				this.obQuantity.value = curValue;[m
[31m-			}[m
[31m-			else[m
[31m-			{[m
[31m-				this.obQuantity.value = this.stepQuantity;[m
[31m-			}[m
[31m-		}[m
[31m-		else[m
[31m-		{[m
[31m-			this.obQuantity.value = this.stepQuantity;[m
[31m-		}[m
[31m-		calcPrice = {[m
[31m-			DISCOUNT_VALUE: this.currentBasisPrice.DISCOUNT_VALUE * this.obQuantity.value,[m
[31m-			VALUE: this.currentBasisPrice.VALUE * this.obQuantity.value,[m
[31m-			DISCOUNT_DIFF: this.currentBasisPrice.DISCOUNT_DIFF * this.obQuantity.value,[m
[31m-			DISCOUNT_DIFF_PERCENT: this.currentBasisPrice.DISCOUNT_DIFF_PERCENT,[m
[31m-			CURRENCY: this.currentBasisPrice.CURRENCY[m
[31m-		};[m
[31m-		this.setPrice(calcPrice);[m
[31m-	}[m
[31m-};[m
[31m-[m
[31m-window.JCCatalogElement.prototype.QuantitySet = function(index)[m
[31m-{[m
[31m-	var basisPrice = '',[m
[31m-		strLimit;[m
[31m-	if (this.errorCode === 0)[m
[31m-	{[m
[31m-		this.canBuy = this.offers[index].CAN_BUY;[m
[31m-		if (this.canBuy)[m
[31m-		{[m
[31m-			if (!!this.obBasketActions)[m
[31m-			{[m
[31m-				BX.style(this.obBasketActions, 'display', '');[m
[31m-			}[m
[31m-			if (!!this.obNotAvail)[m
[31m-			{[m
[31m-				BX.style(this.obNotAvail, 'display', 'none');[m
[31m-			}[m
[31m-		}[m
[31m-		else[m
[31m-		{[m
[31m-			if (!!this.obBasketActions)[m
[31m-			{[m
[31m-				BX.style(this.obBasketActions, 'display', 'none');[m
[31m-			}[m
[31m-			if (!!this.obNotAvail)[m
[31m-			{[m
[31m-				BX.style(this.obNotAvail, 'display', '');[m
[31m-			}[m
[31m-		}[m
[31m-		if (this.config.showQuantity)[m
[31m-		{[m
[31m-			this.isDblQuantity = this.offers[index].QUANTITY_FLOAT;[m
[31m-			this.checkQuantity = this.offers[index].CHECK_QUANTITY;[m
[31m-			if (this.isDblQuantity)[m
[31m-			{[m
[31m-				this.maxQuantity = parseFloat(this.offers[index].MAX_QUANTITY);[m
[31m-				this.stepQuantity = Math.round(parseFloat(this.offers[index].STEP_QUANTITY)*this.precisionFactor)/this.precisionFactor;[m
[31m-			}[m
[31m-			else[m
[31m-			{[m
[31m-				this.maxQuantity = parseInt(this.offers[index].MAX_QUANTITY, 10);[m
[31m-				this.stepQuantity = parseInt(this.offers[index].STEP_QUANTITY, 10);[m
[31m-			}[m
[31m-			this.obQuantity.value = this.stepQuantity;[m
[31m-			this.obQuantity.disabled = !this.canBuy;[m
[31m-			if (!!this.obMeasure)[m
[31m-			{[m
[31m-				if (!!this.offers[index].MEASURE)[m
[31m-				{[m
[31m-					BX.adjust(this.obMeasure, { html : this.offers[index].MEASURE});[m
[31m-				}[m
[31m-				else[m
[31m-				{[m
[31m-					BX.adjust(this.obMeasure, { html : ''});[m
[31m-				}[m
[31m-			}[m
[31m-			if (!!this.obQuantityLimit.all)[m
[31m-			{[m
[31m-				if (!this.checkQuantity)[m
[31m-				{[m
[31m-					BX.adjust(this.obQuantityLimit.value, { html: '' });[m
[31m-					BX.adjust(this.obQuantityLimit.all, { style: {display: 'none'} });[m
[31m-				}[m
[31m-				else[m
[31m-				{[m
[31m-					strLimit = this.offers[index].MAX_QUANTITY;[m
[31m-					if (!!this.offers[index].MEASURE)[m
[31m-					{[m
[31m-						strLimit += (' '+this.offers[index].MEASURE);[m
[31m-					}[m
[31m-					BX.adjust(this.obQuantityLimit.value, { html: strLimit});[m
[31m-					BX.adjust(this.obQuantityLimit.all, { style: {display: ''} });[m
[31m-				}[m
[31m-			}[m
[31m-			if (!!this.obBasisPrice)[m
[31m-			{[m
[31m-				if (!!this.offers[index].BASIS_PRICE)[m
[31m-				{[m
[31m-					basisPrice = BX.message('BASIS_PRICE_MESSAGE');[m
[31m-					basisPrice = basisPrice.replace([m
[31m-						'#PRICE#',[m
[31m-						BX.Currency.currencyFormat(this.offers[index].BASIS_PRICE.DISCOUNT_VALUE, this.offers[index].BASIS_PRICE.CURRENCY, true)[m
[31m-					);[m
[31m-					basisPrice = basisPrice.replace('#MEASURE#', this.offers[index].MEASURE);[m
[31m-					BX.adjust(this.obBasisPrice, { style: { display: '' }, html: basisPrice });[m
[31m-				}[m
[31m-				else[m
[31m-				{[m
[31m-					BX.adjust(this.obBasisPrice, { style: { display: 'none' }, html: '' });[m
[31m-				}[m
[31m-			}[m
[31m-		}[m
[31m-		this.currentBasisPrice = this.offers[index].BASIS_PRICE;[m
[31m-	}[m
[31m-};[m
[31m-[m
[31m-window.JCCatalogElement.prototype.SelectOfferProp = function()[m
[31m-{[m
[31m-	var i = 0,[m
[31m-		strTreeValue = '',[m
[31m-		arTreeItem = [],[m
[31m-		RowItems = null,[m
[31m-		target = BX.proxy_context;[m
[31m-[m
[31m-	if (!!target && target.hasAttribute('data-treevalue'))[m
[31m-	{[m
[31m-		if (typeof(document.activeElement) === 'object')[m
[31m-			document.activeElement.blur();[m
[31m-		strTreeValue = target.getAttribute('data-treevalue');[m
[31m-		arTreeItem = strTreeValue.split('_');[m
[31m-		this.SearchOfferPropIndex(arTreeItem[0], arTreeItem[1]);[m
[31m-		RowItems = BX.findChildren(target.parentNode, {tagName: 'li'}, false);[m
[31m-		if (!!RowItems && 0 < RowItems.length)[m
[31m-		{[m
[31m-			for (i = 0; i < RowItems.length; i++)[m
[31m-			{[m
[31m-				BX.removeClass(RowItems[i], 'bx_active');[m
[31m-			}[m
[31m-		}[m
[31m-		BX.addClass(target, 'bx_active');[m
[31m-	}[m
[31m-};[m
[31m-[m
[31m-window.JCCatalogElement.prototype.SearchOfferPropIndex = function(strPropID, strPropValue)[m
[31m-{[m
[31m-	var strName = '',[m
[31m-		arShowValues = false,[m
[31m-		arCanBuyValues = [],[m
[31m-		allValues = [],[m
[31m-		index = -1,[m
[31m-		i, j,[m
[31m-		arFilter = {},[m
[31m-		tmpFilter = [];[m
[31m-[m
[31m-	for (i = 0; i < this.treeProps.length; i++)[m
[31m-	{[m
[31m-		if (this.treeProps[i].ID === strPropID)[m
[31m-		{[m
[31m-			index = i;[m
[31m-			break;[m
[31m-		}[m
[31m-	}[m
[31m-[m
[31m-	if (-1 < index)[m
[31m-	{[m
[31m-		for (i = 0; i < index; i++)[m
[31m-		{[m
[31m-			strName = 'PROP_'+this.treeProps[i].ID;[m
[31m-			arFilter[strName] = this.selectedValues[strName];[m
[31m-		}[m
[31m-		strName = 'PROP_'+this.treeProps[index].ID;[m
[31m-		arFilter[strName] = strPropValue;[m
[31m-		for (i = index+1; i < this.treeProps.length; i++)[m
[31m-		{[m
[31m-			strName = 'PROP_'+this.treeProps[i].ID;[m
[31m-			arShowValues = this.GetRowValues(arFilter, strName);[m
[31m-			if (!arShowValues)[m
[31m-			{[m
[31m-				break;[m
[31m-			}[m
[31m-			allValues = [];[m
[31m-			if (this.config.showAbsent)[m
[31m-			{[m
[31m-				arCanBuyValues = [];[m
[31m-				tmpFilter = [];[m
[31m-				tmpFilter = BX.clone(arFilter, true);[m
[31m-				for (j = 0; j < arShowValues.length; j++)[m
[31m-				{[m
[31m-					tmpFilter[strName] = arShowValues[j];[m
[31m-					allValues[allValues.length] = arShowValues[j];[m
[31m-					if (this.GetCanBuy(tmpFilter))[m
[31m-						arCanBuyValues[arCanBuyValues.length] = arShowValues[j];[m
[31m-				}[m
[31m-			}[m
[31m-			else[m
[31m-			{[m
[31m-				arCanBuyValues = arShowValues;[m
[31m-			}[m
[31m-			if (!!this.selectedValues[strName] && BX.util.in_array(this.selectedValues[strName], arCanBuyValues))[m
[31m-			{[m
[31m-				arFilter[strName] = this.selectedValues[strName];[m
[31m-			}[m
[31m-			else[m
[31m-			{[m
[31m-				if (this.config.showAbsent)[m
[31m-					arFilter[strName] = (arCanBuyValues.length > 0 ? arCanBuyValues[0] : allValues[0]);[m
[31m-				else[m
[31m-					arFilter[strName] = arCanBuyValues[0];[m
[31m-			}[m
[31m-			this.UpdateRow(i, arFilter[strName], arShowValues, arCanBuyValues);[m
[31m-		}[m
[31m-		this.selectedValues = arFilter;[m
[31m-		this.ChangeInfo();[m
[31m-	}[m
[31m-};[m
[31m-[m
[31m-window.JCCatalogElement.prototype.RowLeft = function()[m
[31m-{[m
[31m-	var strTreeValue = '',[m
[31m-		index = -1,[m
[31m-		i,[m
[31m-		target = BX.proxy_context;[m
[31m-	if (!!target && target.hasAttribute('data-treevalue'))[m
[31m-	{[m
[31m-		strTreeValue = target.getAttribute('data-treevalue');[m
[31m-		for (i = 0; i < this.treeProps.length; i++)[m
[31m-		{[m
[31m-			if (this.treeProps[i].ID === strTreeValue)[m
[31m-			{[m
[31m-				index = i;[m
[31m-				break;[m
[31m-			}[m
[31m-		}[m
[31m-		if (-1 < index && this.treeRowShowSize < this.showCount[index])[m
[31m-		{[m
[31m-			if (0 > this.showStart[index])[m
[31m-			{[m
[31m-				this.showStart[index]++;[m
[31m-				BX.adjust(this.obTreeRows[index].LIST, { style: { marginLeft: this.showStart[index]*20+'%' }});[m
[31m-				BX.adjust(this.obTreeRows[index].RIGHT, { style: this.treeEnableArrow });[m
[31m-			}[m
[31m-[m
[31m-			if (0 <= this.showStart[index])[m
[31m-			{[m
[31m-				BX.adjust(this.obTreeRows[index].LEFT, { style: this.treeDisableArrow });[m
[31m-			}[m
[31m-		}[m
[31m-	}[m
[31m-};[m
[31m-[m
[31m-window.JCCatalogElement.prototype.RowRight = function()[m
[31m-{[m
[31m-	var strTreeValue = '',[m
[31m-		index = -1,[m
[31m-		i,[m
[31m-		target = BX.proxy_context;[m
[31m-	if (!!target && target.hasAttribute('data-treevalue'))[m
[31m-	{[m
[31m-		strTreeValue = target.getAttribute('data-treevalue');[m
[31m-		for (i = 0; i < this.treeProps.length; i++)[m
[31m-		{[m
[31m-			if (this.treeProps[i].ID === strTreeValue)[m
[31m-			{[m
[31m-				index = i;[m
[31m-				break;[m
[31m-			}[m
[31m-		}[m
[31m-		if (-1 < index && this.treeRowShowSize < this.showCount[index])[m
[31m-		{[m
[31m-			if ((this.treeRowShowSize - this.showStart[index]) < this.showCount[index])[m
[31m-			{[m
[31m-				this.showStart[index]--;[m
[31m-				BX.adjust(this.obTreeRows[index].LIST, { style: { marginLeft: this.showStart[index]*20+'%' }});[m
[31m-				BX.adjust(this.obTreeRows[index].LEFT, { style: this.treeEnableArrow });[m
[31m-			}[m
[31m-[m
[31m-			if ((this.treeRowShowSize - this.showStart[index]) >= this.showCount[index])[m
[31m-			{[m
[31m-				BX.adjust(this.obTreeRows[index].RIGHT, { style: this.treeDisableArrow });[m
[31m-			}[m
[31m-		}[m
[31m-	}[m
[31m-};[m
[31m-[m
[31m-window.JCCatalogElement.prototype.UpdateRow = function(intNumber, activeID, showID, canBuyID)[m
[31m-{[m
[31m-	var i = 0,[m
[31m-		showI = 0,[m
[31m-		value = '',[m
[31m-		countShow = 0,[m
[31m-		strNewLen = '',[m
[31m-		obData = {},[m
[31m-		RowItems = null,[m
[31m-		pictMode = false,[m
[31m-		extShowMode = false,[m
[31m-		isCurrent = false,[m
[31m-		selectIndex = 0,[m
[31m-		obLeft = this.treeEnableArrow,[m
[31m-		obRight = this.treeEnableArrow,[m
[31m-		currentShowStart = 0;[m
[31m-[m
[31m-	if (-1 < intNumber && intNumber < this.obTreeRows.length)[m
[31m-	{[m
[31m-		RowItems = BX.findChildren(this.obTreeRows[intNumber].LIST, {tagName: 'li'}, false);[m
[31m-		if (!!RowItems && 0 < RowItems.length)[m
[31m-		{[m
[31m-			pictMode = ('PICT' === this.treeProps[intNumber].SHOW_MODE);[m
[31m-			countShow = showID.length;[m
[31m-			extShowMode = this.treeRowShowSize < countShow;[m
[31m-			strNewLen = (this.treeRowShowSize < countShow ? (100/countShow)+'%' : '20%');[m
[31m-			obData = {[m
[31m-				props: { className: '' },[m
[31m-				style: {[m
[31m-					width: strNewLen[m
[31m-				}[m
[31m-			};[m
[31m-			if (pictMode)[m
[31m-			{[m
[31m-				obData.style.paddingTop = strNewLen;[m
[31m-			}[m
[31m-			for (i = 0; i < RowItems.length; i++)[m
[31m-			{[m
[31m-				value = RowItems[i].getAttribute('data-onevalue');[m
[31m-				isCurrent = (value === activeID);[m
[31m-				if (BX.util.in_array(value, canBuyID))[m
[31m-				{[m
[31m-					obData.props.className = (isCurrent ? 'bx_active' : '');[m
[31m-				}[m
[31m-				else[m
[31m-				{[m
[31m-					obData.props.className = (isCurrent ? 'bx_active bx_missing' : 'bx_missing');[m
[31m-				}[m
[31m-				obData.style.display = 'none';[m
[31m-				if (BX.util.in_array(value, showID))[m
[31m-				{[m
[31m-					obData.style.display = '';[m
[31m-					if (isCurrent)[m
[31m-					{[m
[31m-						selectIndex = showI;[m
[31m-					}[m
[31m-					showI++;[m
[31m-				}[m
[31m-				BX.adjust(RowItems[i], obData);[m
[31m-			}[m
[31m-[m
[31m-			obData = {[m
[31m-				style: {[m
[31m-					width: (extShowMode ? 20*countShow : 100)+'%',[m
[31m-					marginLeft: '0%'[m
[31m-				}[m
[31m-			};[m
[31m-[m
[31m-			if (pictMode)[m
[31m-			{[m
[31m-				BX.adjust(this.obTreeRows[intNumber].CONT, {props: {className: (extShowMode ? 'bx_item_detail_scu full' : 'bx_item_detail_scu')}});[m
[31m-			}[m
[31m-			else[m
[31m-			{[m
[31m-				BX.adjust(this.obTreeRows[intNumber].CONT, {props: {className: (extShowMode < countShow ? 'bx_item_detail_size full' : 'bx_item_detail_size')}});[m
[31m-			}[m
[31m-			if (extShowMode)[m
[31m-			{[m
[31m-				if (selectIndex +1 === countShow)[m
[31m-				{[m
[31m-					obRight = this.treeDisableArrow;[m
[31m-				}[m
[31m-				if (this.treeRowShowSize <= selectIndex)[m
[31m-				{[m
[31m-					currentShowStart = this.treeRowShowSize - selectIndex - 1;[m
[31m-					obData.style.marginLeft = currentShowStart*20+'%';[m
[31m-				}[m
[31m-				if (0 === currentShowStart)[m
[31m-				{[m
[31m-					obLeft = this.treeDisableArrow;[m
[31m-				}[m
[31m-				BX.adjust(this.obTreeRows[intNumber].LEFT, {style: obLeft });[m
[31m-				BX.adjust(this.obTreeRows[intNumber].RIGHT, {style: obRight });[m
[31m-			}[m
[31m-			else[m
[31m-			{[m
[31m-				BX.adjust(this.obTreeRows[intNumber].LEFT, {style: {display: 'none'}});[m
[31m-				BX.adjust(this.obTreeRows[intNumber].RIGHT, {style: {display: 'none'}});[m
[31m-			}[m
[31m-			BX.adjust(this.obTreeRows[intNumber].LIST, obData);[m
[31m-			this.showCount[intNumber] = countShow;[m
[31m-			this.showStart[intNumber] = currentShowStart;[m
[31m-		}[m
[31m-	}[m
[31m-};[m
[31m-[m
[31m-window.JCCatalogElement.prototype.GetRowValues = function(arFilter, index)[m
[31m-{[m
[31m-	var arValues = [],[m
[31m-		i = 0,[m
[31m-		j = 0,[m
[31m-		boolSearch = false,[m
[31m-		boolOneSearch = true;[m
[31m-[m
[31m-	if (0 === arFilter.length)[m
[31m-	{[m
[31m-		for (i = 0; i < this.offers.length; i++)[m
[31m-		{[m
[31m-			if (!BX.util.in_array(this.offers[i].TREE[index], arValues))[m
[31m-			{[m
[31m-				arValues[arValues.length] = this.offers[i].TREE[index];[m
[31m-			}[m
[31m-		}[m
[31m-		boolSearch = true;[m
[31m-	}[m
[31m-	else[m
[31m-	{[m
[31m-		for (i = 0; i < this.offers.length; i++)[m
[31m-		{[m
[31m-			boolOneSearch = true;[m
[31m-			for (j in arFilter)[m
[31m-			{[m
[31m-				if (arFilter[j] !== this.offers[i].TREE[j])[m
[31m-				{[m
[31m-					boolOneSearch = false;[m
[31m-					break;[m
[31m-				}[m
[31m-			}[m
[31m-			if (boolOneSearch)[m
[31m-			{[m
[31m-				if (!BX.util.in_array(this.offers[i].TREE[index], arValues))[m
[31m-				{[m
[31m-					arValues[arValues.length] = this.offers[i].TREE[index];[m
[31m-				}[m
[31m-				boolSearch = true;[m
[31m-			}[m
[31m-		}[m
[31m-	}[m
[31m-	return (boolSearch ? arValues : false);[m
[31m-};[m
[31m-[m
[31m-window.JCCatalogElement.prototype.GetCanBuy = function(arFilter)[m
[31m-{[m
[31m-	var i = 0,[m
[31m-		j = 0,[m
[31m-		boolOneSearch = true,[m
[31m-		boolSearch = false;[m
[31m-[m
[31m-	for (i = 0; i < this.offers.length; i++)[m
[31m-	{[m
[31m-		boolOneSearch = true;[m
[31m-		for (j in arFilter)[m
[31m-		{[m
[31m-			if (arFilter[j] !== this.offers[i].TREE[j])[m
[31m-			{[m
[31m-				boolOneSearch = false;[m
[31m-				break;[m
[31m-			}[m
[31m-		}[m
[31m-		if (boolOneSearch)[m
[31m-		{[m
[31m-			if (this.offers[i].CAN_BUY)[m
[31m-			{[m
[31m-				boolSearch = true;[m
[31m-				break;[m
[31m-			}[m
[31m-		}[m
[31m-	}[m
[31m-	return boolSearch;[m
[31m-};[m
[31m-[m
[31m-window.JCCatalogElement.prototype.SetCurrent = function()[m
[31m-{[m
[31m-	var i = 0,[m
[31m-		j = 0,[m
[31m-		strName = '',[m
[31m-		arShowValues = false,[m
[31m-		arCanBuyValues = [],[m
[31m-		arFilter = {},[m
[31m-		tmpFilter = [],[m
[31m-		current = this.offers[this.offerNum].TREE;[m
[31m-[m
[31m-	for (i = 0; i < this.treeProps.length; i++)[m
[31m-	{[m
[31m-		strName = 'PROP_'+this.treeProps[i].ID;[m
[31m-		arShowValues = this.GetRowValues(arFilter, strName);[m
[31m-		if (!arShowValues)[m
[31m-		{[m
[31m-			break;[m
[31m-		}[m
[31m-		if (BX.util.in_array(current[strName], arShowValues))[m
[31m-		{[m
[31m-			arFilter[strName] = current[strName];[m
[31m-		}[m
[31m-		else[m
[31m-		{[m
[31m-			arFilter[strName] = arShowValues[0];[m
[31m-			this.offerNum = 0;[m
[31m-		}[m
[31m-		if (this.config.showAbsent)[m
[31m-		{[m
[31m-			arCanBuyValues = [];[m
[31m-			tmpFilter = [];[m
[31m-			tmpFilter = BX.clone(arFilter, true);[m
[31m-			for (j = 0; j < arShowValues.length; j++)[m
[31m-			{[m
[31m-				tmpFilter[strName] = arShowValues[j];[m
[31m-				if (this.GetCanBuy(tmpFilter))[m
[31m-				{[m
[31m-					arCanBuyValues[arCanBuyValues.length] = arShowValues[j];[m
[31m-				}[m
[31m-			}[m
[31m-		}[m
[31m-		else[m
[31m-		{[m
[31m-			arCanBuyValues = arShowValues;[m
[31m-		}[m
[31m-		this.UpdateRow(i, arFilter[strName], arShowValues, arCanBuyValues);[m
[31m-	}[m
[31m-	this.selectedValues = arFilter;[m
[31m-	this.ChangeInfo();[m
[31m-};[m
[31m-[m
[31m-window.JCCatalogElement.prototype.ChangeInfo = function()[m
[31m-{[m
[31m-	var index = -1,[m
[31m-		i = 0,[m
[31m-		j = 0,[m
[31m-		boolOneSearch = true;[m
[31m-[m
[31m-	for (i = 0; i < this.offers.length; i++)[m
[31m-	{[m
[31m-		boolOneSearch = true;[m
[31m-		for (j in this.selectedValues)[m
[31m-		{[m
[31m-			if (this.selectedValues[j] !== this.offers[i].TREE[j])[m
[31m-			{[m
[31m-				boolOneSearch = false;[m
[31m-				break;[m
[31m-			}[m
[31m-		}[m
[31m-		if (boolOneSearch)[m
[31m-		{[m
[31m-			index = i;[m
[31m-			break;[m
[31m-		}[m
[31m-	}[m
[31m-	if (-1 < index)[m
[31m-	{[m
[31m-		this.setPrice(this.offers[index].PRICE);[m
[31m-		for (i = 0; i < this.offers.length; i++)[m
[31m-		{[m
[31m-			if (this.config.showOfferGroup && this.offers[i].OFFER_GROUP)[m
[31m-			{[m
[31m-				if (i !== index)[m
[31m-				{[m
[31m-					BX.adjust(BX(this.visual.OFFER_GROUP+this.offers[i].ID), { style: {display: 'none'} });[m
[31m-				}[m
[31m-			}[m
[31m-			if (!!this.sliders[i].ID)[m
[31m-			{[m
[31m-				if (i === index)[m
[31m-				{[m
[31m-					this.sliders[i].START = 0;[m
[31m-					BX.adjust(this.sliders[i].LIST, {style: { marginLeft: '0%' }});[m
[31m-					BX.adjust(this.sliders[i].CONT, {style: { display: ''}});[m
[31m-					BX.adjust(this.sliders[i].LEFT, { style: this.sliderDisableArrow } );[m
[31m-					BX.adjust(this.sliders[i].RIGHT, { style: this.sliderEnableArrow } );[m
[31m-				}[m
[31m-				else[m
[31m-				{[m
[31m-					BX.adjust(this.sliders[i].CONT, {style: { display: 'none'}});[m
[31m-				}[m
[31m-			}[m
[31m-		}[m
[31m-		if (this.config.showOfferGroup && this.offers[index].OFFER_GROUP)[m
[31m-		{[m
[31m-			BX.adjust(BX(this.visual.OFFER_GROUP+this.offers[index].ID), { style: {display: ''} });[m
[31m-		}[m
[31m-		if (0 < this.offers[index].SLIDER_COUNT)[m
[31m-		{[m
[31m-			this.SetMainPict(this.offers[index].ID, this.offers[index].SLIDER[0].ID);[m
[31m-		}[m
[31m-		else[m
[31m-		{[m
[31m-			this.SetMainPictFromItem(index);[m
[31m-		}[m
[31m-[m
[31m-		if (this.config.showSkuProps && !!this.obSkuProps)[m
[31m-		{[m
[31m-			if (!this.offers[index].DISPLAY_PROPERTIES || this.offers[index].DISPLAY_PROPERTIES.length === 0)[m
[31m-			{[m
[31m-				BX.adjust(this.obSkuProps, {style: {display: 'none'}, html: ''});[m
[31m-			}[m
[31m-			else[m
[31m-			{[m
[31m-				BX.adjust(this.obSkuProps, {style: {display: ''}, html: this.offers[index].DISPLAY_PROPERTIES});[m
[31m-			}[m
[31m-		}[m
[31m-		this.offerNum = index;[m
[31m-		this.QuantitySet(this.offerNum);[m
[31m-[m
[31m-		this.incViewedCounter();[m
[31m-		BX.onCustomEvent('onCatalogStoreProductChange', [this.offers[this.offerNum].ID]);[m
[31m-	}[m
[31m-};[m
[31m-[m
[31m-window.JCCatalogElement.prototype.setPrice = function(price)[m
[31m-{[m
[31m-	var economyInfo = '';[m
[31m-[m
[31m-	if (!!this.obPrice.price)[m
[31m-	{[m
[31m-		BX.adjust(this.obPrice.price, {html: BX.Currency.currencyFormat(price.DISCOUNT_VALUE, price.CURRENCY, true)});[m
[31m-		if (price.DISCOUNT_VALUE !== price.VALUE)[m
[31m-		{[m
[31m-			if (this.config.showOldPrice)[m
[31m-			{[m
[31m-				if (!!this.obPrice.full)[m
[31m-				{[m
[31m-					BX.adjust(this.obPrice.full, {style: {display: ''}, html: BX.Currency.currencyFormat(price.VALUE, price.CURRENCY, true)});[m
[31m-				}[m
[31m-				if (!!this.obPrice.discount)[m
[31m-				{[m
[31m-					economyInfo = BX.message('ECONOMY_INFO_MESSAGE');[m
[31m-					economyInfo = economyInfo.replace('#ECONOMY#', BX.Currency.currencyFormat(price.DISCOUNT_DIFF, price.CURRENCY, true));[m
[31m-					BX.adjust(this.obPrice.discount, {style: {display: ''}, html: economyInfo });[m
[31m-				}[m
[31m-			}[m
[31m-			if (this.config.showPercent)[m
[31m-			{[m
[31m-				if (!!this.obPrice.percent)[m
[31m-				{[m
[31m-					BX.adjust(this.obPrice.percent, {style: {display: ''}, html: price.DISCOUNT_DIFF_PERCENT+'%'});[m
[31m-				}[m
[31m-			}[m
[31m-		}[m
[31m-		else[m
[31m-		{[m
[31m-			if (this.config.showOldPrice)[m
[31m-			{[m
[31m-				if (!!this.obPrice.full)[m
[31m-				{[m
[31m-					BX.adjust(this.obPrice.full, {style: {display: 'none'}, html: ''});[m
[31m-				}[m
[31m-				if (!!this.obPrice.discount)[m
[31m-				{[m
[31m-					BX.adjust(this.obPrice.discount, {style: {display: 'none'}, html: ''});[m
[31m-				}[m
[31m-			}[m
[31m-			if (this.config.showPercent)[m
[31m-			{[m
[31m-				if (!!this.obPrice.percent)[m
[31m-				{[m
[31m-					BX.adjust(this.obPrice.percent, {style: {display: 'none'}, html: ''});[m
[31m-				}[m
[31m-			}[m
[31m-		}[m
[31m-	}[m
[31m-};[m
[31m-[m
[31m-window.JCCatalogElement.prototype.Compare = function()[m
[31m-{[m
[31m-	var compareParams, compareLink;[m
[31m-	if (!!this.compareData.compareUrl)[m
[31m-	{[m
[31m-		switch (this.productType)[m
[31m-		{[m
[31m-			case 0://no catalog[m
[31m-			case 1://product[m
[31m-			case 2://set[m
[31m-				compareLink = this.compareData.compareUrl.replace('#ID#', this.product.id.toString());[m
[31m-				break;[m
[31m-			case 3://sku[m
[31m-				compareLink = this.compareData.compareUrl.replace('#ID#', this.offers[this.offerNum].ID);[m
[31m-				break;[m
[31m-		}[m
[31m-		compareParams = {[m
[31m-			ajax_action: 'Y'[m
[31m-		};[m
[31m-		BX.ajax.loadJSON([m
[31m-			compareLink,[m
[31m-			compareParams,[m
[31m-			BX.proxy(this.CompareResult, this)[m
[31m-		);[m
[31m-	}[m
[31m-};[m
[31m-[m
[31m-window.JCCatalogElement.prototype.CompareResult = function(result)[m
[31m-{[m
[31m-	var popupContent, popupButtons, popupTitle;[m
[31m-	if (!!this.obPopupWin)[m
[31m-		this.obPopupWin.close();[m
[31m-[m
[31m-	if (typeof result !== 'object')[m
[31m-		return false;[m
[31m-[m
[31m-	this.InitPopupWindow();[m
[31m-	popupTitle = {[m
[31m-		content: BX.create('div', {[m
[31m-			style: { marginRight: '30px', whiteSpace: 'nowrap' },[m
[31m-			text: BX.message('COMPARE_TITLE')[m
[31m-		})[m
[31m-	};[m
[31m-	if (result.STATUS === 'OK')[m
[31m-	{[m
[31m-		BX.onCustomEvent('OnCompareChange');[m
[31m-		popupContent = '<div style="width: 96%; margin: 10px 2%; text-align: center;"><p>'+BX.message('COMPARE_MESSAGE_OK')+'</p></div>';[m
[31m-		if (this.config.showClosePopup)[m
[31m-		{[m
[31m-			popupButtons = [[m
[31m-				new BasketButton({[m
[31m-					ownerClass: this.obProduct.className,[m
[31m-					text: BX.message('BTN_MESSAGE_COMPARE_REDIRECT'),[m
[31m-					events: {[m
[31m-						click: BX.delegate(this.CompareRedirect, this)[m
[31m-					},[m
[31m-					style: {marginRight: '10px'}[m
[31m-				}),[m
[31m-				new BasketButton({[m
[31m-					ownerClass: this.obProduct.className,[m
[31m-					text: BX.message('BTN_MESSAGE_CLOSE_POPUP'),[m
[31m-					events: {[m
[31m-						click: BX.delegate(this.obPopupWin.close, this.obPopupWin)[m
[31m-					}[m
[31m-				})[m
